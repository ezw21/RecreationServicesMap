System.register(["jimu-core","jimu-ui","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/advanced/theme-components"],(function(e){var t,s,n,i,o;return{setters:[function(e){t=e},function(e){s=e},function(e){n=e},function(e){i=e},function(e){o=e}],execute:function(){e(function(e){var t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=108)}({0:function(e,s){e.exports=t},1:function(e,t){e.exports=s},108:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return m}));var n=s(0),i=s(2),o=s(1),a=s(23),r=s(3),c={chooseTheme:"Theme",customTheme:"Customize",resetTheme:"Reset",backToMainThemePanel:"Back",customPaletteTitle:"Customize palette colors",customFontsetTitle:"Customize font set",customAppElementsTitle:"App elements"},l=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(s[n[i]]=e[n[i]])}return s};class p extends n.React.PureComponent{constructor(e){super(e),this.state={currentStep:1}}render(){const e=this.props,{className:t}=e,s=l(e,["className"]),i=Object(n.classNames)("jimu-builder-stepper",t);return Object(n.jsx)("div",Object.assign({css:h},s,{className:i}))}}class u extends n.React.PureComponent{constructor(e){super(e)}render(){const e=this.props,{active:t,className:s,children:i}=e,o=l(e,["active","className","children"]),a=Object(n.classNames)("jimu-builder-stepper-pane",s,{active:t});return Object(n.jsx)("div",Object.assign({},o,{className:a}),t&&i)}}function h(){return n.css`

  `}var d=function(e,t,s,n){return new(s||(s=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function r(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class m extends n.React.PureComponent{constructor(e){super(e),this.loadThemeListInfo=()=>d(this,void 0,void 0,(function*(){const e=yield fetch(n.urlUtils.getAbsoluteRootUrl()+"themes/themes-info.json");return yield Promise.resolve(Object(n.Immutable)(yield e.json()))})),this.handleOnChange=e=>{e&&Object(i.getAppConfigAction)(this.props.appConfig).editTheme(e).exec()},this.handleOnUpdate=e=>{if(!e)return;const t=n.ThemeManager.getInAppInstance().addThemeCustomVariables(this.state.selectedTheme,e);t&&Object(i.getAppConfigAction)(this.props.appConfig).editCustomTheme(t).exec()},this.handleOnCustomize=()=>{this.setState({currentStep:2})},this.handleOnReset=()=>{const e=Object.assign({},n.themeUtils.getMappedShareThemeVariables());n.ThemeManager.getInAppInstance().updateThemeCustomVariables(this.state.selectedTheme,e),Object(i.getAppConfigAction)(this.props.appConfig).editCustomTheme(e).exec()},this.i18n=e=>{const t=this.props.intl;return t?t.formatMessage({id:e,defaultMessage:c[e]}):e},this.getStyle=e=>n.css`
      .jimu-builder-stepper-pane {
        display: none;
        height: 100%;
        &.active {
          display: flex;
          flex-direction: column;
        }
      }
      .panel-header {
        padding-top: 18px;
        font-weight: 500;
      }
      .widget-builder-themes--pane {
        height: 100%;
        flex: 1;
        overflow: auto;
        padding-top: 18px;
        .jimu-widget-setting--section-header h6 {
          color: ${e.colors.palette.dark[600]};
          font-weight: ${e.typography.weights.bold};
          font-size: 1rem;
        }
        .split-line {
          display: none;
        }
      }
    `,this.state={selectedTheme:null,currentStep:1,loadStatus:"init"},this.loadingStr=this.props.intl.formatMessage({id:"loading",defaultMessage:n.defaultMessages.loading}),this.titleStr=this.props.intl.formatMessage({id:"chooseTheme",defaultMessage:c.chooseTheme})}componentDidUpdate(e){var t,s,o,a;const r=null===(s=null===(t=this.props)||void 0===t?void 0:t.appConfig)||void 0===s?void 0:s.theme,c=null===(o=null==e?void 0:e.appConfig)||void 0===o?void 0:o.theme;if(r!==c){if(this.setState({loadStatus:"loading",selectedTheme:r}),c)if(r===n.CONSTANTS.SHARED_THEME){const e=Object.assign({sharedTheme:!0},n.themeUtils.getMappedShareThemeVariables(!0));n.ThemeManager.getInAppInstance().updateThemeCustomVariables(r,e),this.props.appConfig&&Object(i.getAppConfigAction)(this.props.appConfig).editCustomTheme(Object(n.Immutable)(e)).exec()}else this.props.appConfig&&Object(i.getAppConfigAction)(this.props.appConfig).editCustomTheme(Object(n.Immutable)({})).exec()}else r===c&&this.props.appTheme&&"loaded"!==this.state.loadStatus&&this.setState({loadStatus:"loaded"});(null===(a=this.props)||void 0===a?void 0:a.appId)!==(null==e?void 0:e.appId)&&e.appId&&(n.ThemeManager.getInAppInstance().clearAllThemeCustomVariables(),this.setState({loadStatus:"init"}))}componentDidMount(){this.loadThemeListInfo().then(e=>{this.themeInfos=e})}render(){const{appConfig:e,appTheme:t,theme:i,intl:c,isRTL:l}=this.props,h=(null==e?void 0:e.theme)&&t;return Object(n.jsx)(p,{className:"jimu-widget widget-builder-themes d-flex flex-column bg-light-300 w-100 h-100",css:this.getStyle(i)},"init"!==this.state.loadStatus&&Object(n.jsx)(n.React.Fragment,null,Object(n.jsx)(u,{active:1===this.state.currentStep},Object(n.jsx)(o.PanelHeader,{className:"px-3",title:this.titleStr,showClose:!1}),Object(n.jsx)(r.SettingSection,{className:"widget-builder-themes--pane border-bottom-0"},Object(n.jsx)(a.ThemeSelector,{theme:i,themeListInfo:this.themeInfos,selectedTheme:e?e.theme:void 0,onChange:this.handleOnChange,intl:c})),Object(n.jsx)(r.SettingSection,{className:"d-flex"},Object(n.jsx)(o.Button,{type:"primary",css:n.css`flex: 1; font-size: 1rem;`,className:"theme-setting--customize-btn text-truncate",onClick:this.handleOnCustomize,disabled:(null==e?void 0:e.theme)===n.CONSTANTS.SHARED_THEME},this.i18n("customTheme")))),h&&Object(n.jsx)(u,{active:2===this.state.currentStep},Object(n.jsx)("div",{className:"jimu-widget-setting--header px-1 pb-0"},Object(n.jsx)(o.Button,{css:{fontSize:"1rem",fontWeight:500},type:"tertiary",onClick:()=>this.setState({currentStep:1})},Object(n.jsx)(o.Icon,{css:n.css`${l&&"transform: scaleX(-1);"} position: relative; top: -2px;`,icon:s(20),autoFlip:!0}),this.i18n("backToMainThemePanel"))),Object(n.jsx)(a.ThemeQuickStyler,{className:"widget-builder-themes--pane",themeVariables:h,onChange:this.handleOnUpdate,onMoreColorConfigButtonClick:()=>this.setState({currentStep:3}),rtl:l}),Object(n.jsx)(r.SettingSection,{className:"d-flex"},Object(n.jsx)(o.Button,{type:"secondary",css:n.css`flex: 1;`,onClick:this.handleOnReset},this.i18n("resetTheme")))),h&&Object(n.jsx)(u,{active:3===this.state.currentStep},Object(n.jsx)("div",{className:"jimu-widget-setting--header px-1 pb-0"},Object(n.jsx)(o.Button,{css:{fontSize:"1rem",fontWeight:500},type:"tertiary",onClick:()=>this.setState({currentStep:2})},Object(n.jsx)(o.Icon,{css:n.css`${l&&"transform: scaleX(-1);"} position: relative; top: -2px;`,icon:s(20),autoFlip:!0}),this.i18n("backToMainThemePanel"))),Object(n.jsx)(r.SettingSection,{title:this.i18n("themeSettingThemeColors"),className:"widget-builder-themes--pane"},Object(n.jsx)("p",{className:"text-dark-400 text-break"},this.i18n("themeSettingThemeColorsDescription")),Object(n.jsx)(a.ThemeColorConfigurator,{className:"w-100 d-flex justify-content-between",themeVariables:h,onChange:this.handleOnUpdate,intl:c})),Object(n.jsx)(r.SettingSection,{className:"d-flex"},Object(n.jsx)(o.Button,{type:"secondary",css:n.css`flex: 1;`,onClick:this.handleOnReset},this.i18n("resetTheme"))))))}}m.mapExtraStateProps=e=>{var t;return{appConfig:e.appStateInBuilder&&e.appStateInBuilder.appConfig||null,sharedTheme:e.portalSelf&&e.portalSelf.portalProperties&&e.portalSelf.portalProperties.sharedTheme,queryObject:e.queryObject,isRTL:e.appContext.isRTL,appId:null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appId,appTheme:e.appStateInBuilder&&e.appStateInBuilder.theme}}},2:function(e,t){e.exports=n},20:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.305 7.294L10.693.215a.79.79 0 011.083 0c.299.287.299.751 0 1.038L4.736 8l7.04 6.747c.299.287.299.751 0 1.038a.79.79 0 01-1.083 0l-7.388-7.08a.968.968 0 010-1.41z" fill="#000"></path><path d="M0 0h16v16H0z"></path></g></svg>'},23:function(e,t){e.exports=o},3:function(e,t){e.exports=i}}))}}}));