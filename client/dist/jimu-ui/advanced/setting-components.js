System.register(["jimu-core","jimu-ui","jimu-layouts/layout-runtime","jimu-for-builder","jimu-for-builder/templates","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/expression-builder"],(function(e){var t,s,o,i,n,r,a;return{setters:[function(e){t=e},function(e){s=e},function(e){o=e},function(e){i=e},function(e){n=e},function(e){r=e},function(e){a=e}],execute:function(){e(function(e){var t={};function s(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(o,i,function(t){return e[t]}.bind(null,i));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=977)}({0:function(e,s){e.exports=t},1:function(e,t){e.exports=s},106:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 5.5v-5a.5.5 0 011 0v5h5a.5.5 0 010 1h-5v5a.5.5 0 01-1 0v-5h-5a.5.5 0 010-1h5z" fill="#000" fill-rule="nonzero"></path></svg>'},18:function(e,t){e.exports=o},27:function(e,t){e.exports=i},283:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 32"><path d="M2.333 4a3 3 0 116 0 3 3 0 01-6 0zm0 12a3 3 0 116 0 3 3 0 01-6 0zm0 12a3 3 0 116 0 3 3 0 01-6 0z"></path></svg>'},284:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2.646 8.854a.5.5 0 10.708-.708L1.707 6.5h8.586L8.646 8.146a.5.5 0 10.708.708l2.5-2.5a.5.5 0 000-.708l-2.5-2.5a.5.5 0 10-.708.708L10.293 5.5H1.707l1.647-1.646a.5.5 0 10-.708-.708l-2.5 2.5a.5.5 0 000 .708l2.5 2.5z" fill="#000"></path></svg>'},285:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M8.854 9.354a.5.5 0 10-.708-.708L6.5 10.293V1.707l1.646 1.647a.5.5 0 10.708-.708l-2.5-2.5a.5.5 0 00-.708 0l-2.5 2.5a.5.5 0 10.708.708L5.5 1.707v8.586L3.854 8.646a.5.5 0 10-.708.708l2.5 2.5a.5.5 0 00.708 0l2.5-2.5z" fill="#000"></path></g><defs><clipPath id="clip0"><path fill="#fff" d="M0 0h12v12H0z"></path></clipPath></defs></svg>'},31:function(e,t,s){"use strict";s.d(t,"b",(function(){return o})),s.d(t,"c",(function(){return i}));var o,i,n=s(0);s.d(t,"a",(function(){return n.LoadingType})),function(e){e.IMAGE="image",e.ICON="icon"}(o||(o={})),function(e){e.Info="INFO",e.Error="ERROR"}(i||(i={}))},38:function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M7.745 7l4.1 4.1a.527.527 0 01-.745.746L7 7.746l-4.1 4.1a.527.527 0 01-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 01.746-.746l4.1 4.1 4.1-4.1a.527.527 0 01.746.746L7.746 7z" fill="#000"></path><path d="M1 1h12v12H1z"></path></g></svg>'},39:function(e,t){e.exports=n},46:function(e,t){e.exports=r},51:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M4.586 8.657l6.01-6.01a.5.5 0 01.707.707l-6.01 6.01a1 1 0 01-1.414 0L.697 6.182a.5.5 0 01.707-.707l3.182 3.182z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},61:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M.146 3.146a.5.5 0 01.708 0L6 8.5l5.146-5.354a.5.5 0 01.708.708l-5.5 5.707a.5.5 0 01-.708 0l-5.5-5.707a.5.5 0 010-.708z" fill="#000"></path></g><defs><clipPath id="clip0"><path fill="#fff" d="M0 0h12v12H0z"></path></clipPath></defs></svg>'},66:function(e,t){e.exports=a},74:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var o=s(0);const i={left:"right",right:"left",top:"bottom",bottom:"top"};function n(e,t){return t&&("left"===e||"right"===e)?e:i[e]}function r(e,t){return t?"left"===e?"right":"right"===e?"left":e:e}function a(e){const t=Object(o.getAppStore)().getState().appContext.isRTL,{border:s,background:i,arrowSize:a=".75rem"}=e;return o.css`
    .jimu-popper--arrow {
      position: absolute;
      &::before,
      &::after {
        content: " ";
        display: block;
        width: 0;
        height: 0;
        border: ${a} solid transparent;
        position: absolute;
      }
    }
    &[data-popper-placement^="top"],
    &[data-popper-placement^="bottom"] {
      .jimu-popper--arrow {
        ${t?"right: 50%":"left: 50%"};
        &::before,
        &::after {
          transform: translateX(-50%);
        }
      }
    }
    &[data-popper-placement^="left"],
    &[data-popper-placement^="right"] {
      .jimu-popper--arrow {
        top: 50%;
        &::before,
        &::after {
          transform: translateY(-50%);
        }
      }
    }
    ${["left","right","top","bottom"].map(e=>{var l,c;return o.css`
      &[data-popper-placement^="${e}"] {
        .jimu-popper--arrow {
          ${n(e,t)}: -${a};
          &::before,
          &::after {
            border-${n(e,t)}-width: 0;
            border-${r(e,t)}-color: ${null!==(l=null==s?void 0:s.color)&&void 0!==l?l:"inherit"};
            ${n(e,t)}: 0;
          }
          &::after {
            border-${r(e,t)}-color: ${null!=i?i:"inherit"};
            ${n(e,t)}: ${null!==(c=null==s?void 0:s.width)&&void 0!==c?c:"1px"};
          }
        }
      }
    `})}
  `}},77:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M.304 6.016a1.028 1.028 0 011.466 0l4.398 4.451 8.062-8.16a1.028 1.028 0 011.466 0c.405.41.405 1.074 0 1.484l-8.795 8.902c-.405.41-1.062.41-1.466 0L.304 7.5a1.058 1.058 0 010-1.484z" fill="#000"></path><path d="M0 0h16v16H0z"></path></g></svg>'},79:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M9.521 5.47L3.981.162a.592.592 0 00-.813 0 .534.534 0 000 .779L8.448 6l-5.28 5.06a.534.534 0 000 .779.592.592 0 00.813 0l5.54-5.31a.726.726 0 000-1.058z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},85:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M4.103 7.873L16 19.25 27.897 7.873c.939-.898 2.46-.898 3.399 0s.939 2.353 0 3.251L17.7 24.127a2.481 2.481 0 01-3.399 0L.705 11.124c-.939-.898-.939-2.353 0-3.251s2.46-.898 3.399 0z"></path></svg>'},86:function(e,t){e.exports='<svg viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg"><path d="M1.521 5.693a.517.517 0 01-.708 0 .464.464 0 010-.677l2.833-2.71a.517.517 0 01.708 0l2.833 2.71a.464.464 0 010 .677.517.517 0 01-.708 0L4 3.323l-2.479 2.37z"></path><path d="M0 0h8v8H0z" fill="none"></path></svg>'},92:function(e,t){e.exports='<svg viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.5 13a.5.5 0 010-1h4a.5.5 0 010 1h-4zM0 8.5a.5.5 0 00.5.5h7a.5.5 0 000-1h-7a.5.5 0 00-.5.5zM.5 5a.5.5 0 010-1h11a.5.5 0 010 1H.5zM.5 1a.5.5 0 110-1h15a.5.5 0 010 1H.5z" fill="#000"></path></svg>'},93:function(e,t){e.exports='<svg viewBox="0 0 16 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M.5 0a.5.5 0 000 1h4a.5.5 0 000-1h-4zM0 4.5A.5.5 0 01.5 4h7a.5.5 0 010 1h-7a.5.5 0 01-.5-.5zM.5 8a.5.5 0 000 1h11a.5.5 0 000-1H.5zM.5 12a.5.5 0 000 1h15a.5.5 0 000-1H.5z" fill="#000"></path></svg>'},94:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M.146 9.56a.5.5 0 00.708 0L6 4.208l5.146 5.354a.5.5 0 00.708-.708l-5.5-5.707a.5.5 0 00-.708 0l-5.5 5.707a.5.5 0 000 .708z" fill="#000"></path></g><defs><clipPath id="clip0"><path fill="#fff" d="M0 0h12v12H0z"></path></clipPath></defs></svg>'},95:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.212 9.936L2 12.27l2.333-.212L13.27 3.12 11.149 1 2.212 9.936zm-.707-.707L10.441.293a1 1 0 011.415 0l2.12 2.121a1 1 0 010 1.414l-8.935 8.937a1 1 0 01-.617.289l-2.333.212a1 1 0 01-1.087-1.087l.212-2.333a1 1 0 01.289-.617zm7.434-6.497l2.829 2.829-.707.707-2.829-2.829.707-.707zM.5 15h15a.5.5 0 010 1H.5a.5.5 0 010-1z" fill="#000" fill-rule="nonzero"></path></svg>'},977:function(e,t,s){"use strict";s.r(t),s.d(t,"handelDialogInfos",(function(){return Et})),s.d(t,"changeCurrentPage",(function(){return $t})),s.d(t,"changeCurrentDialog",(function(){return zt})),s.d(t,"WidgetSelector",(function(){return T})),s.d(t,"JimuMapViewSelector",(function(){return D})),s.d(t,"JimuLayerViewSelector",(function(){return B})),s.d(t,"StylePicker",(function(){return H})),s.d(t,"RadioGroup",(function(){return _})),s.d(t,"ItemCardSelector",(function(){return Y})),s.d(t,"SettingSection",(function(){return k})),s.d(t,"SettingRow",(function(){return C})),s.d(t,"SettingCollapse",(function(){return N})),s.d(t,"UnControlledSettingCollapse",(function(){return L})),s.d(t,"SettingLayout",(function(){return i})),s.d(t,"LinkSetting",(function(){return fe})),s.d(t,"LinkSettingPopup",(function(){return ye})),s.d(t,"OpenTypes",(function(){return Q})),s.d(t,"proxySettingUtils",(function(){return n})),s.d(t,"ProxySetting",(function(){return Be})),s.d(t,"ProxySettingPopup",(function(){return Je})),s.d(t,"SidePopper",(function(){return we})),s.d(t,"WidgetListPopper",(function(){return Ze})),s.d(t,"PageTemplatePopper",(function(){return rt})),s.d(t,"DialogTemplatePopper",(function(){return dt})),s.d(t,"BlockTemplatePopper",(function(){return mt})),s.d(t,"ScreenTemplatePopper",(function(){return bt})),s.d(t,"ScreenGroupTemplatePopper",(function(){return wt})),s.d(t,"SortSetting",(function(){return yt})),s.d(t,"DirectionSelector",(function(){return Ct})),s.d(t,"SizeMode",(function(){return Pt})),s.d(t,"SizeModeSelector",(function(){return Nt})),s.d(t,"NavQuickStyleItem",(function(){return Lt})),s.d(t,"QuickStylePopper",(function(){return Tt}));var o={};s.r(o),s.d(o,"WidgetSelector",(function(){return a})),s.d(o,"SortSetting",(function(){return l})),s.d(o,"StylePicker",(function(){return c})),s.d(o,"SettingSection",(function(){return p})),s.d(o,"SettingRow",(function(){return d})),s.d(o,"SettingCollapse",(function(){return u})),s.d(o,"LinkSetting",(function(){return h})),s.d(o,"ProxySetting",(function(){return m})),s.d(o,"ProxySettingPopup",(function(){return g})),s.d(o,"RadioGroup",(function(){return f})),s.d(o,"ItemCardSelector",(function(){return b})),s.d(o,"SidePopper",(function(){return v})),s.d(o,"JimuLayerViewSelector",(function(){return x}));var i={};s.r(i),s.d(i,"SettingSection",(function(){return k})),s.d(i,"SettingRow",(function(){return C})),s.d(i,"SettingCollapse",(function(){return N})),s.d(i,"UnControlledSettingCollapse",(function(){return L}));var n={};s.r(n),s.d(n,"getNeedProxyDataSources",(function(){return Oe})),s.d(n,"traverseToGetNeedProxyDataSources",(function(){return Ce})),s.d(n,"getProxyJsonFromSourceUrl",(function(){return Pe})),s.d(n,"isSameProxy",(function(){return Ie})),s.d(n,"isRegisteredApp",(function(){return Me})),s.d(n,"needToConfigProxy",(function(){return Ne})),s.d(n,"deleteProxies",(function(){return Le})),s.d(n,"getProxyRootUrl",(function(){return Ae})),s.d(n,"getCreateProxyUrl",(function(){return Te})),s.d(n,"getDeleteProxyUrl",(function(){return Ee}));var r=s(0);const a=e=>{const t=e.theme;return r.css`
    .component-choose-widget-popup{
      .widget-card-active-btn{
        outline: none;
      }
    }
    div.component-choose-widget-popup-modal{
      width: 850px;
      max-width: 850px;
      height: 600px;
      background: ${t.colors.white};
      border-radius: 4px;
      position: absolute;
      margin: auto;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      .component-choose-widget-clear-border{
        border: 0;
        padding: 0;
      }
      .modal-content{
        border: 0;
        padding: 20px 10px 20px 40px;
        position: static;
      }
      .component-choose-widget-modal-header{
        .choose-widget-popup-close{
          width: 50px;
          height: 50px;
          display: inline-block;
          right: 28px;
          position: absolute;
          top: 10px;
          &:hover{
            cursor: pointer;
          }
        }
        .choose-widget-popup-close:after{
          content: '';
          display: inline-block;
          width: 16px;
          height: 16px;
          background-image: url(${"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAsElEQVQ4jaWSLQ7EIBhEv2LxnAzP1cBzAU6DhKCpZneaQHYpP2k6omreCzA9yjf0IgyfGCMZY+g8zy2ADrpgmsA5R977raTC6IJpAiklCSEopTSVVBgddME0AeeclFJTSQ+jCwY5fh9xVERm8E0wkiAzeCjoJcgMbm/wJjdBf4XdOmwF49irdf4Es6l2E7MVXLOSXAJr7XKqkQTMFcwYQiha65JzLruggy4YZPgfPMkHXzQME+F7oHYAAAAASUVORK5CYII="});
          position: relative;
          left: 18px;
          top: 12px;
        }
      }
      .component-choose-widget-modal-body{
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -ms-flex-wrap: wrap;
        flex-wrap: wrap;
        -webkit-box-pack: start;
        -ms-flex-pack: start;
        justify-content: flex-start;
        margin: 40px 0 10px 0;
        .widget-card-item{
          width: 70px;
          height: 120px;
          border: 0;
          margin: 0 30px 0 0;
          &:hover{
            cursor: pointer;
          }
          .widget-card-image{
            width: 70px;
            height: 70px;
            border: 1px solid #ccc;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            justify-content: center;
            >div{
              width: 30px;
              height: 30px;
              position: relative;
              &:after{
                display: none;
              }
            }
          }
          .widget-card-content{
            font-size: 12px;
            color: #000;
            letter-spacing: 0.33px;
            padding: 2px;
            text-align: center;
            line-height: 14px;
          }
        }
        .widget-card-selected{
          .widget-card-image{
            border: 2px solid #0C5CB6;
            >div:after{
              content: '';
              display: block;
              width: 16px;
              height: 16px;
              position: absolute;
              top: -20px;
              right: -20px;
              background-image: url(${"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA20lEQVQ4jWPkidn2n4ECwESJ5iFgABsLI8PBRiuGS732DKJ8bKQbwMHKzKAqyc0gK8zBIMDNilUNI6FYkBBgBxrExPDg9Xes8iy4NIZYSDJ4GYkx/Pj1j6F25Q2cFuD0wo2nXxi42ZkZYu1lGMItpUg34Mrjzwx//0HYT9//IN0AFiZGBjstIaAh/xkOXntLugHGyvwM/FysDBcefGT48PUP6QaI8ELinZ2FicFGQ4iBnRW7UmY2vegGbBIPXn1j+P//P8OXn38ZPn77zXDxwSesBhBMB4QAxXkBAMaDOywJrob4AAAAAElFTkSuQmCC"});
            }
          }
        }
      }
      .component-choose-widget-modal-footer{
        position: absolute;
        bottom: 20px;
        right: 40px;
        >button{
          font-size: 14px;
          letter-spacing: 0.39px;
          text-align: center;
          vertical-align: middle;
        }
        button:first-of-type {
          background-color: #0075D0;
          border: 1px solid  #0075D0;
          border-radius: 3px;
          color: #ffffff;
        }
        button:last-of-type{
          background-color: #ffffff;
          border: 1px solid #CCCCCC;
          border-radius: 3px;
          color: #000000;
        }
      }
    }
  `},l=e=>{const t=e.theme.colors;return r.css`
    width:100%;
    &.single-row-item {
        .select-con {
            padding: ${r.polished.rem(10)} ${r.polished.rem(0)};
            .option-name-con {
                margin-bottom: 0;
                .close-con>span {
                    margin-left: ${r.polished.rem(10)};
                }
            }
        }
    }
    .add-option-btn {
        & {
            color:${t.palette.primary[600]};
            margin-top:10px;
            cursor: pointer;
            font-size:13px;
            overflow: hidden;
        }
        .add-option-icon{
            margin-right: 4px;
        }
    }
    .no-sort-remind {
        margin: 70px auto 0;
        color: ${t.palette.light[800]};
        font-size: 13px;
        text-align: center;
    }
    .select-con {
        & {
            margin-top:17px;
            box-sizing:border-box;
            padding:${r.polished.rem(10)};
            padding-top:${r.polished.rem(8)};
            margin-bottom:10px;
            background:${t.palette.light[500]};
            box-shadow: 0 0 0 2px ${r.polished.rgba(t.white,.3)};
        }
        .option-name-con {
            & {
              display: flex;
              align-items: center;
              margin-bottom:${r.polished.rem(7)};
              width: 100%;
            }
            .option-name {
              font-size: 13px;
              line-height: 13px;
              color: ${t.palette.dark[800]};
              max-width: 87%;
              height: ${r.polished.rem(25)};
              line-height: ${r.polished.rem(25)};
              cursor: pointer;
            }
            .option-name input {
                display:inline-block;
                width: auto;
                max-width: 88%;
                height: 100%;
            }
            .option-name-icon {
                margin-left:5px;
                color: ${t.palette.dark[400]};
                cursor: pointer;
            }
            .option-name span {
                max-width: 88%;
                display: inline-block;
                text-overflow: ellipsis;
                overflow:hidden;
            }
            .close-con {
                flex-grow: 1;
            }
            .close-con>span {
                margin-right: ${r.polished.rem(10)};
                color: ${t.black};
                cursor: pointer;
            }
        }

        .select-down-con {
            & {
                display: flex;
                align-items: center;
                height: ${r.polished.rem(34)};
            }
            .sort-arrow-down-icon {
                margin-right: 0;
            }
            .select-input {
                flex-grow:1;
                color: ${t.dark};
            }
            .sort-button {
                margin-left: 5px;
                width:30px;
                cursor: pointer;
                border:none;
            }
            .sort-field-selector {
                & {
                    background:${t.palette.secondary[200]};
                    border-radius: 2px;
                    width: ${r.polished.rem(140)};
                    overflow: hidden;
                }


            }
        }
    }


  `},c=e=>{const t=e.theme;return r.css`
    .widget-setting--stylepicker {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-gap: 10px;
    }

    .widget-setting--stylepicker-item {
      height: 93px;
      border: 1px solid ${t.colors.palette.light[500]};
      background-color: ${t.colors.white};
      background-repeat: no-repeat;
      background-position: center;
      &:hover {
        border-color: ${t.colors.primary};
      }
      &.active {
        border: 2px solid ${t.colors.primary};
      }
      &.full-width {
        grid-column-start: 1;
        grid-column-end: 3;
      }
    }
  `},p=e=>{const t=e.theme;return r.css`
    padding: ${t.sizes[3]};
    border-bottom: 1px solid ${t.colors.palette.light[800]};

    &:last-child {
      border-bottom: 0 none;
    }

    .jimu-widget-setting--section-header {
      > h6 {
        color: ${t.colors.palette.dark[600]};
        font-weight: ${t.typography.weights.bold};
        margin-bottom: 0;
      }
      + * {
        margin-top: ${t.sizes[3]};
      }
    }

    .jimu-widget-setting--section-header {
      &.row {
        margin-left: 0;
        margin-right: 0;
      }
    }
  `},d=e=>{const t=e.theme,s=e.flow,o=e.action;return r.css`
    &.jimu-widget-setting--row {
      margin-bottom: 0;
      margin-left: 0;
      margin-right: 0;
      &:first-child  /* emotion-disable-server-rendering-unsafe-selector-warning-please-do-not-use-this-the-warning-exists-for-a-reason */{
        margin-top: 0;
      }
      + .jimu-widget-setting--row {
        margin-top: ${t.sizes[3]};
      }
    }
    &,
    .jimu-widget-setting--row-header {
      > .jimu-widget-setting--row-label {
        font-size: 0.8125rem;
        font-weight: 500;
        color: ${t.colors.palette.dark[400]};
      }
    }
    > .jimu-widget-setting--row-label {
      display: inline-block;
      margin-bottom: ${"wrap"===s?o?"0":t.sizes[2]:"0"};
      margin-right: 20px;
    }
    > input {
      &[type='number'] {
        width: 50px;
        flex-shrink: 0;
      }
    }
    input {
      &[type='number'] {
        &::-webkit-inner-spin-button,
        &::-webkit-outer-spin-button {
          -webkit-appearance: none;
          margin: 0;
        }
      }
    }
    .jimu-widget-setting--row-header {
      display: flex;
      width: 100%;
      align-items: center;
      margin-bottom: 0.75rem;
      > .btn {
        width: 100%;
        padding-left: 0;
        padding-right: 0;
      }
      .jimu-widget-setting--row-label {
        text-align: left;
        flex: 1;
        margin-bottom: 0;
      }
    }
    &.form-inline {
      flex-wrap: nowrap;
      .jimu-widget-setting--row-label {
        max-width: 80%;
        + * {
          flex-shrink: 0;
        }
      }
    }
  `},u=e=>{var t,s,o,i,n,a,l,c;const p=null==e?void 0:e.isOpen,d=null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"default",u=e.theme,h=null===(i=null===(o=null===(s=null==u?void 0:u.colors)||void 0===s?void 0:s.palette)||void 0===o?void 0:o.light)||void 0===i?void 0:i[500],m=null===(l=null===(a=null===(n=null==u?void 0:u.colors)||void 0===n?void 0:n.palette)||void 0===a?void 0:a.light)||void 0===l?void 0:l[800],g=null===(c=null==u?void 0:u.colors)||void 0===c?void 0:c.primary;return"primary"!==d?r.css`
    .dividing-line {
      background-color: ${m};
    }
    `:r.css`
    .handle {
      border-top: 2px solid ${p?g:h};
      background-color: ${h};
      .title {
        padding-left: 8px;
        padding-right: 8px;
      }
    }
    .dividing-line {
      background-color: ${m};
    }
    `};function h(e){const t=e.theme,s=t&&t.colors&&t.colors.palette&&t.colors.palette.light[500]||"#ccc",o=t&&t.colors&&t.colors.primary||"blue",i=r.polished.rgba(s,.5);return window.jimuConfig.isInBuilder?r.css`
    .widget-builder-linksetting {
      .option-name{
        font-size: ${r.polished.rem(13)};
        color: ${t.colors.palette.dark[400]};
        font-weight:
      }
      .linksetting-list {
        .view-border{
          border-width: 1px;
          border-style: solid;
        }
        .linksetting-list-item {
          height: ${r.polished.rem(30)};
          cursor: pointer;

          &:hover {
            background-color: ${i};
          }
        }

        .linksetting-list-select {
          background-color: ${i};
        }
      }

      select {
        padding-top: ${r.polished.rem(2)} !important;
      }

      .itemselected {
        background-color: ${o} !important;
      }

      .btn-primary {
        background-color: #00A6B6 !important;
        border-color: #00A6B6 !important;
        color: #ffffff !important;
      }

      .form-check-input {
        span {
          background: #00A6B6 !important;
        }
      }

      .form-check-input:hover {
        border-color: gray;
      }

      input[type='radio'].form-check-input {
        -webkit-appearance: none;
        -moz-appearance: none;
        background: transparent;
        border: 1px solid #000;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        transition: all 0.2s ease;
        &:before {
        content: '';
        display: block;
        position: absolute;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: #00A6B6 !important;
        margin: 8px;
        transition: all 0.2s ease-out;
        }
        &:hover {
        border-color: #00A6B6 !important;
        }
        &:checked {
        &:before {
            width: 8px;
            height: 8px;
            margin: 3px;
        }
        }
      }
      .link-setting-cursor-pointer{
        cursor: pointer;
      }
      .open-type-label{
        max-width: calc(100% - ${r.polished.rem(25)});
        display: inline-block;
      }
    }
    .url-error-container{
      *{
        color: ${t.colors.danger};
      }
      div{
        width: calc(100% - 20px);
        margin-left: 4px;
        overflow: hidden;
        text-overflow: ellipsis;
      }
    }
  `:r.css`
    .widget-builder-linksetting {
      .option-name{
        font-size: ${r.polished.rem(13)};
        color: ${t.colors.palette.dark[400]};
        font-weight: 500;
      }
      .mb-12{
        margin-bottom: ${r.polished.rem(12)};
      }
      .item-common{
        background: ${t.colors.white};
      }
      .view-border{
        border: 1px solid ${t.colors.palette.light[400]};
      }
      .linksetting-list {

        .linksetting-list-item {
          height: ${r.polished.rem(30)};
          cursor: pointer;

          &:hover {
            background-color: ${i};
          }
        }

        .linksetting-list-select {
          background-color: ${i};
        }
      }

      select {
        padding-top: ${r.polished.rem(2)} !important;
      }

      .itemselected {
        background-color: ${o} !important;
      }
      .link-setting-cursor-pointer{
        cursor: pointer;
      }
      .open-type-label{
        max-width: calc(100% - ${r.polished.rem(25)});
        display: inline-block;
      }
      .url-error-container{
        *{
          color: ${t.colors.danger};
        }
        div{
          width: calc(100% - 20px);
          margin-left: 4px;
          overflow: hidden;
          text-overflow: ellipsis;
        }
      }
    }
  `}function m(e){const t=e.theme;return r.css`
    color: ${t.colors.palette.dark[600]};
    .font-size-13{
      font-size: ${r.polished.rem(13)} !important;
    }
    .subscriber-warning{
      font-size: ${r.polished.rem(13)};
    }
    .secondary-title{
      font-size: ${r.polished.rem(14)};
    }
    .content-table{
      font-size: ${r.polished.rem(13)};
      color: ${t.colors.palette.dark[800]};
    }
    .content-table-header{
      height: ${r.polished.rem(32)};
      background-color: ${t.colors.palette.light[400]};
      display: block;
      line-height: ${r.polished.rem(30)};
    }
    .content-table-tr{
      height: ${r.polished.rem(39)};
      line-height: ${r.polished.rem(39)};
      border-bottom: 1px solid ${t.colors.palette.light[400]};
    }
    .col-4, .col-2{
      height: 100%;
    }
    .request-limit{
      margin-top: ${r.polished.rem(6)};
    }
    .request-interval{
      display: block;
      margin-top: ${r.polished.rem(-3)};
    }
  `}function g(e){const t=e.theme;return r.css`
    max-width: ${r.polished.rem(960)} !important;
    .header{
      font-size: ${r.polished.rem(16)};
      color: ${t.colors.palette.dark[600]};
    }
    .proxy-setting-container{
      width: ${r.polished.rem(960)};
      height: ${r.polished.rem(640)};
      border: 0;
      color: ${t.colors.palette.dark[600]};
    }
    .px-30{
      padding-right: ${r.polished.rem(30)};
      padding-left: ${r.polished.rem(30)};
    }
  `}const f=e=>{const t=e.theme,s=e.gutter;return r.css`
    margin-bottom: 0;
    label {
      display: inline-flex;
      align-items: center;
      margin-right: ${s||t.sizes[3]};
      .jimu-radio {
        margin-right: ${t.gutters[4]};
      }
    }
  `},b=e=>{const t=e.theme,s=e.gutter,o=e.size,i=e.vertical;return r.css`
    display: flex;
    > .setting--item-selector-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      > .btn {
        width: ${o&&o.width};
        height: ${o&&o.height};
        background: ${t.colors.palette.light[200]};
        border: 2px solid transparent;
        &:hover {
          border: 2px solid transparent;
        }
        &:not(:disabled):not(.disabled):active, 
        &:not(:disabled):not(.disabled).active {
          background: ${t.colors.palette.light[200]};
          border: 2px solid ${t.colors.palette.primary[700]};
        }
      }
      > label {
        margin-bottom: 0;
        margin-top: ${t.gutters[3]};
      }
      + .setting--item-selector-item {
        margin-left: ${s||t.sizes[3]};
      }
    }
    ${i&&r.css`
      flex-direction: column;
      > .setting--item-selector-item + .setting--item-selector-item {
        margin-left: 0;
        margin-top: ${s||t.sizes[3]};
      }
    `}
  `};function v(e){const t=e.theme;return r.css`
    width: ${r.polished.rem(260)};
    height: calc(100% - 70px);
    padding: 0;
    overflow: hidden;
    border-radius: 0;
    box-shadow: 0 0 0;
    border-left: 1px solid ${t.colors.palette.light[800]};
    border-right: 1px solid ${t.colors.palette.light[800]};
    border-top: 0;
    border-bottom: 0;
    margin: 0 !important;
  `}const x=e=>{const t=e.theme;return r.css`
    .dropdown-menu--inner {
      background-color: ${t.colors.palette.secondary[200]};
      padding: 0;
    }

    .dropdown-toggle-content {
      width: 100%;
    }

    .layerviewselector-input {
      width: 100%;
      height: 30px !important;
      background-color: ${t.colors.palette.secondary[200]};
      flex-direction: unset !important;
    }

    .layerviewselector-input-text {
      max-width: calc(100% - 13px);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .layerviewselector-bg {
      max-height: 270px;
      overflow-y: auto;
      background-color: ${t.colors.palette.secondary[200]};
    }

    .layerviewselector-item-bg {
      cursor: pointer;
    }

    .layerviewselector-item-bg:hover {
      background-color: ${t.colors.primary};
    }

    .layerviewselector-ds-item {
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      width: 100%;
    }

    .layerviewselector-ds-item:hover {
      background-color: ${t.colors.primary};
    }

    .layerviewselector-ds-item-selected {
      background-color: ${t.colors.primary};
    }
  `};var w=s(27),j=s(1);class y extends r.React.PureComponent{render(){return r.React.createElement(j.Container,{className:Object(r.classNames)(this.props.className,"jimu-widget-setting--section"),style:this.props.style},this.props.title&&r.React.createElement(j.Row,{className:"jimu-widget-setting--section-header"},r.React.createElement("h6",{className:"w-100 text-truncate setting-text-level-1"},this.props.title)),this.props.children)}}const k=r.themeUtils.withStyles(y,"SettingSection"),S=e=>r.React.createElement("div",{className:"jimu-widget-setting--row-header mb-3"},e.children);class O extends r.React.PureComponent{constructor(){super(...arguments),this.onActionClick=e=>{"drilldown"===e&&this.props&&this.props.onDrillDown&&this.props.onDrillDown()}}render(){const{action:e,flow:t,truncateLabel:o,label:i,indented:n,className:a,level:l=3}=this.props,c=Object(r.classNames)(a,"jimu-widget-setting--row","form-group","align-items-center",{"form-inline":"wrap"!==t,"pl-4":n}),p=e?"span":"label",d=i&&r.React.createElement(p,{className:Object(r.classNames)("jimu-widget-setting--row-label justify-content-start flex-grow-1 text-break setting-text-level-"+l,{"w-100 mr-0":"wrap"===t,"text-truncate":o})},i);return r.React.createElement(j.Row,{className:c},"wrap"===t&&e?r.React.createElement(S,null,"drilldown"===e?r.React.createElement(j.Button,{size:"sm",type:"tertiary",onClick:()=>this.onActionClick("drilldown")},d,r.React.createElement(j.Icon,{className:"right-icon",icon:s(79)})):void 0):d,this.props.children)}}const C=r.themeUtils.withStyles(O,"SettingRow");var P=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const I=s(94),M=s(61),N=r.themeUtils.withStyles(e=>{const{type:t="default",className:s,leftIcon:o,label:i,bottomLine:n=!1,isOpen:a,onRequestOpen:l,onRequestClose:c,children:p,rightIcon:d=M,rightActiveIcon:u=I,level:h=0}=e,m=P(e,["type","className","leftIcon","label","bottomLine","isOpen","onRequestOpen","onRequestClose","children","rightIcon","rightActiveIcon","level"]),g=a?u:d;return r.React.createElement("div",{className:Object(r.classNames)("setting-collapse w-100",s)},r.React.createElement("div",{className:"handle w-100 d-flex justify-content-between"},r.React.createElement("div",{title:i,className:"title py-1 d-flex align-items-center flex-grow-1",style:{maxWidth:"85%"}},o&&r.React.createElement(j.Icon,{className:"mr-2",size:12,icon:o}),r.React.createElement("div",{className:"text-truncate setting-text-level-"+h,style:{maxWidth:"80%"}}," ",i)),r.React.createElement(j.Button,{size:"sm",type:"tertiary",icon:!0,onClick:()=>{a?null==c||c():null==l||l()}},r.React.createElement(j.Icon,{size:12,icon:g}))),r.React.createElement(j.Collapse,Object.assign({},m,{isOpen:a}),r.React.createElement(r.React.Fragment,null,p,n&&r.React.createElement("div",{className:"dividing-line mt-3",style:{width:"100%",height:"1px"}}))))},"SettingCollapse"),L=e=>{const{defaultIsOpen:t=!1,label:s}=e,o=P(e,["defaultIsOpen","label"]),[i,n]=r.React.useState(t);return r.React.createElement(N,Object.assign({label:s,isOpen:i},o,{onRequestOpen:()=>n(!0),onRequestClose:()=>n(!1)}))};var R=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(e){n(e)}}function a(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))};class A extends r.React.PureComponent{constructor(e){super(e),this.onSelectWidget=e=>{this.setState({currentWidget:e})},this.getListItemJSX=e=>Object(r.jsx)(j.Card,{className:Object(r.classNames)("widget-card-item",{"widget-card-selected":this.state.currentWidget&&0===this.state.currentWidget.indexOf(e.uri)}),key:e.title,onClick:()=>this.onSelectWidget(e.uri)},Object(r.jsx)("div",{className:"widget-card-image bg-light-300"},Object(r.jsx)("div",null,Object(r.jsx)(j.CardImg,{top:!0,width:"100%",src:e.image.src,alt:e.image.alt}))),Object(r.jsx)(j.CardBody,{className:"widget-card-content"},Object(r.jsx)("span",{className:"text-capitalize",title:e.title},e.title))),this.state={currentWidget:null,listInfo:[]}}componentDidMount(){this.getListInfo().then(e=>{this.setState({listInfo:e.listInfo})})}getListInfo(){return R(this,void 0,void 0,(function*(){return yield fetch(r.urlUtils.getAbsoluteRootUrl()+"widgets/widgets-info.json").then(e=>R(this,void 0,void 0,(function*(){return yield e.json()}))).then(e=>({listInfo:e.map(e=>{const t={title:"",uri:"",image:{src:""}};return t.title=e.label,t.uri=e.path,t.image.src="../"+e.icon,t})}))}))}render(){return Object(r.jsx)("div",{className:Object(r.classNames)("w-100 h-100",{[this.props.className]:!!this.props.className})},Object(r.jsx)("div",{className:"component-choose-widget-popup"},Object(r.jsx)(j.Modal,{isOpen:!0,className:"component-choose-widget-popup-modal"},Object(r.jsx)(j.ModalHeader,{className:"component-choose-widget-clear-border component-choose-widget-modal-header"},this.props.title,Object(r.jsx)("span",{className:"choose-widget-popup-close",onClick:this.props.onCancel})),Object(r.jsx)(j.ModalBody,{className:"component-choose-widget-clear-border component-choose-widget-modal-body"},this.state.listInfo.length>0?this.state.listInfo.map(e=>this.getListItemJSX(e)):"Loading..."),Object(r.jsx)(j.ModalFooter,{className:"component-choose-widget-clear-border component-choose-widget-modal-footer"},Object(r.jsx)(j.Button,{onClick:()=>this.props.onOK(this.state.currentWidget)},"OK"),Object(r.jsx)(j.Button,{onClick:this.props.onCancel},"Cancel")))))}}const T=r.themeUtils.withStyles(A,"WidgetSelector");class E extends r.React.PureComponent{constructor(e){super(e),this.noneMapWidget=Object(r.Immutable)({id:"none",label:this.props.intl.formatMessage({id:"none",defaultMessage:j.defaultMessages.none})}),this.getStyle=e=>r.css`
      .component-map-selector{
        width: 100%;
      }

    `,this.onSelect=e=>{const t=e.target.value,s=t===this.noneMapWidget.id?[]:[t];this.props.onSelect&&this.props.onSelect(s)},this.getSelectedMapWidget=()=>{if(!this.props.useMapWidgetIds)return null;const e=this.props.useMapWidgetIds[0];return this.props.mapWidgetJsons.find(t=>t.id===e)||null}}render(){const e=this.props.mapWidgetJsons,t=this.getSelectedMapWidget();return Object(r.jsx)("div",{css:this.getStyle(this.props.theme),className:"w-100"},Object(r.jsx)("div",{className:"component-map-selector"},Object(r.jsx)(j.Select,{size:"sm",value:t?t.id:this.noneMapWidget.id,onChange:this.onSelect,className:""},e.concat(this.noneMapWidget).map((e,t)=>Object(r.jsx)("option",{key:t,value:e.id},e.label)))))}}const D=r.ReactRedux.connect((e,t)=>{const s=window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder&&e.appStateInBuilder.appConfig:e.appConfig,o=s&&s.widgets;return{mapWidgetJsons:o?Object.keys(o).filter(e=>o[e]&&o[e].manifest&&o[e].manifest.properties&&o[e].manifest.properties.canCreateMapView).map(e=>o[e]):[]}})(Object(r.injectIntl)(r.themeUtils.withTheme(E)));class $ extends r.React.PureComponent{constructor(e){super(e)}getContent(){const e=[];for(let t=0;t<this.props.fromRootDsIds.length;t++)e.push(this.props.fromRootDsIds[t]);return r.React.createElement("div",{className:"w-100"},e.map((e,t)=>{const s=r.DataSourceManager.getInstance().getDataSource(e),o=s.getLabel(),i=s.getChildDataSources();return r.React.createElement("div",{key:t},r.React.createElement("div",{className:"text-dark-600 pl-2 pr-2",style:{fontSize:"14px"}},o),i.map((t,s)=>r.React.createElement("div",{key:s,className:"mt-1 mb-1"},r.React.createElement("div",{className:Object(r.classNames)("layerviewselector-ds-item pl-2 pr-2",{"layerviewselector-ds-item-selected":this.props.selectedDsIds&&this.props.selectedDsIds.includes(t.id)}),title:t.getLabel(),onClick:()=>{this.props.onSelect&&this.props.onSelect({rootDataSourceId:e,dataSourceId:t.id})}},t.getLabel()))))}))}render(){return this.props.fromRootDsIds&&0!=this.props.fromRootDsIds.length?r.React.createElement("div",{className:"w-100"},this.getContent()):null}}const z=s(85);class U extends r.React.PureComponent{constructor(e){super(e),this.toggleList=e=>{this.setState({listOpen:!this.state.listOpen})},this.onResize=e=>{this.setState({width:e})},this.handleChooseLayer=e=>{if(this.props.onSelect)if(e){const t=r.DataSourceManager.getInstance().getDataSource(e.rootDataSourceId),s=r.DataSourceManager.getInstance().getDataSource(e.dataSourceId).id,o=t.getJimuChildId(s)[0];this.props.onSelect(Object(r.Immutable)({jimuMapViewId:`${this.props.useMapWidgetIds[0]}-${e.rootDataSourceId}`,jimuLayerId:o,dataSourceId:e&&e.dataSourceId,rootDataSourceId:e&&e.rootDataSourceId}))}else this.props.onSelect(Object(r.Immutable)({}));this.setState({listOpen:!1})},this.handleClickNone=()=>{this.props.onSelect&&this.props.onSelect(Object(r.Immutable)({})),this.setState({listOpen:!1})},this.getTitle=()=>this.props.jimuLayerViewInfo&&this.props.useMapWidgetIds&&this.props.useMapWidgetIds[0]&&this.props.jimuLayerViewInfo.dataSourceId?Object(r.jsx)(r.DataSourceComponent,{useDataSource:Object(r.Immutable)({dataSourceId:this.props.jimuLayerViewInfo.dataSourceId,mainDataSourceId:this.props.jimuLayerViewInfo.dataSourceId,rootDataSourceId:this.props.jimuLayerViewInfo.rootDataSourceId})},(e,t,s)=>e.getLabel()):"None",this.getContent=()=>{const e=this.props.useMapWidgetIds&&this.props.useMapWidgetIds[0],t=Object(r.getAppStore)().getState().appStateInBuilder.appConfig.widgets[e];return t&&t.useDataSources&&t.useDataSources[0]?Object(r.jsx)("div",{className:"w-100 mt-1 mb-2"},Object(r.jsx)("div",{onClick:()=>{this.handleClickNone()}},Object(r.jsx)("div",{className:"layerviewselector-ds-item pl-2 pr-2"},"None")),Object(r.jsx)("div",{className:"w-100 mt-1 mb-1"},Object(r.jsx)("div",{className:"w-100 border border-bottom-0 border-right-0 border-left-0"})),Object(r.jsx)(r.MultipleDataSourceComponent,{useDataSources:t.useDataSources},(e,t)=>{const s=Object(r.Immutable)(Object.keys(e)),o=[];return this.props.jimuLayerViewInfo&&this.props.jimuLayerViewInfo.dataSourceId&&o.push(this.props.jimuLayerViewInfo.dataSourceId),Object(r.jsx)($,{fromRootDsIds:s,onSelect:e=>{this.handleChooseLayer(e)},selectedDsIds:Object(r.Immutable)(o)})})):this.getEmptyContent()},this.getEmptyContent=()=>Object(r.jsx)("div",{className:"w-100 mt-1 mb-2"},Object(r.jsx)("div",{className:"layerviewselector-ds-item pl-2 pr-2",onClick:()=>{this.handleClickNone()}},"None")),this.state={listOpen:!1,width:0}}render(){return Object(r.jsx)("div",{className:Object(r.classNames)("w-100",{[this.props.className]:!!this.props.className})},Object(r.jsx)(j.Dropdown,{size:"sm",toggle:e=>{this.toggleList(e)},isOpen:this.state.listOpen,className:"w-100"},Object(r.jsx)(j.DropdownToggle,{size:"sm",type:"tertiary",className:Object(r.classNames)("h-100 p-0 m-0 d-flex flex-column align-items-center toollist-item h-100","justify-content-between toollist-item-click h-100 border-0 layerviewselector-input")},Object(r.jsx)("div",{className:"w-100 d-flex justify-content-between align-items-center"},Object(r.jsx)("div",{className:"layerviewselector-input-text ml-2"},this.getTitle()),Object(r.jsx)(j.Icon,{size:8,icon:z}))),Object(r.jsx)(j.DropdownMenu,{className:Object(r.classNames)("ml-0 mr-0 mb-0 mt-1 p-0",{[this.props.className]:!!this.props.className})},Object(r.jsx)("div",{className:"w-100 h-100 layerviewselector-bg"},Object(r.jsx)("div",{style:{width:this.state.width+"px"}},this.getContent())))),Object(r.jsx)(r.ReactResizeDetector,{handleWidth:!0,onResize:this.onResize}))}}const B=r.themeUtils.withStyles(U,"JimuLayerViewSelector");class W extends r.React.PureComponent{constructor(e){super(e),this.onStyleClick=e=>{this.state.selectedValue!==e&&(this.setState({selectedValue:e}),this.props.onChange&&this.props.onChange(e))},this.state={selectedValue:this.props.value}}componentDidUpdate(e,t){e.value!==this.props.value&&this.setState({selectedValue:this.props.value})}render(){const e=this.props.styles;return r.React.createElement("div",{className:Object(r.classNames)("widget-setting--stylepicker w-100",{small:"small"===this.props.size})},Object.keys(e).map((t,s)=>r.React.createElement("div",{key:t,role:"button",className:Object(r.classNames)("widget-setting--stylepicker-item",{active:t===this.state.selectedValue,"full-width":"full"===e[t].size}),style:{backgroundImage:`url(${e[t].thumbnail})`},onClick:()=>this.onStyleClick(t)})))}}const H=r.themeUtils.withStyles(W,"StylePicker");var F=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};class V extends r.React.PureComponent{constructor(e){super(e),this.state={value:this.props.value},this.onRadioButtonChange=e=>{const t=e.target.value;this.state.value!==t&&(this.setState({value:t}),this.props.onChange&&this.props.onChange(t))},V.count++,this.inputName="setting-radiogroup-"+V.count}render(){const e=this.props,{options:t,className:s}=e,o=F(e,["options","className"]);return r.React.createElement(j.FormGroup,Object.assign({},o,{onChange:this.onRadioButtonChange,className:"setting--button-group "+s}),t.map(e=>r.React.createElement(j.Label,{key:e.value},r.React.createElement(j.Radio,{value:e.value,name:this.inputName,checked:this.state.value===e.value}),e.content)))}}V.count=0;const _=r.themeUtils.withStyles(V,"RadioGroup");var J=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const q=s(51);class G extends r.React.PureComponent{constructor(e){super(e),this.state={value:this.props.value,size:"default"},this.onRadioButtonClick=e=>{this.setState({value:e})},G.count++,this.inputName="setting-radiogroup-"+G.count}componentDidUpdate(e,t){this.props.value!==e.value&&this.setState({value:this.props.value}),this.state.value!==t.value&&this.props&&this.props.onChange&&this.props.onChange(this.state.value)}render(){const e=this.props,{options:t,className:s,vertical:o}=e,i=J(e,["options","className","vertical"]),n=Object(r.classNames)("setting--item-selector",s,{vertical:o});return r.React.createElement("div",Object.assign({},i,{className:n}),t.map((e,t)=>r.React.createElement("div",{className:`setting--item-selector-item ${this.state.value===e.value?"active":""} `,key:e.value.toString()+t},this.state.value===e.value&&r.React.createElement("span",{className:"check-ribbon"},r.React.createElement(j.Icon,{icon:q})),r.React.createElement(j.Button,{className:"p-0",onClick:()=>{this.onRadioButtonClick(e.value)},active:this.state.value===e.value},e.content),r.React.createElement("label",{className:"text-break"},e.label))))}}G.count=0;const Y=r.themeUtils.withStyles(G,"ItemCardSelector");var Q;!function(e){e.CurrentWindow="_self",e.TopWindow="_top",e.NewWindow="_blank"}(Q||(Q={}));class X extends r.React.PureComponent{constructor(e){super(e),this.itemOnClick=e=>{this.props.onClick(e),this.setState({selectedItemName:e.name})}}getListContent(){return this.props.datas.map((e,t)=>r.React.createElement("div",{onClick:()=>this.itemOnClick(e),key:t,className:Object(r.classNames)("linksetting-list-item btn w-100 border text-left border-bottom-0 rounded-0 text-truncate",{itemselected:this.props.linkParam.value===e.id})},e.name))}render(){const e=this.props.datas.find(e=>this.props.linkParam.value===e.id),t=e&&e.id;return r.React.createElement("div",{className:"linksetting-list w-100"},r.React.createElement(j.Select,{value:t,className:"w-100",onChange:e=>this.itemOnClick(this.props.datas.find(t=>t.id===e.target.value))},this.props.datas.map((e,t)=>r.React.createElement("option",{key:t,value:e.id},e.name))))}}class K extends r.React.PureComponent{constructor(e){super(e),this.currentPage={id:r.CONSTANTS.CURRENT_PAGE,name:this.props.intl.formatMessage({id:"currentPage",defaultMessage:j.defaultMessages.currentPage})},this.getInitLinkParam=()=>{const e=this.props.appConfig.pageStructure;if(!e||e.length<1)return Object(r.Immutable)({value:""});if(this.props.originLinkParam.linkType!==r.LinkType.Page){const e=this.getPageData();return Object(r.Immutable)({linkType:r.LinkType.Page,value:e&&e.some(e=>"default"===e.id)?"default":e&&e[0]&&e[0].id,openType:Q.CurrentWindow})}return this.props.originLinkParam},this.getPageData=()=>{const e=this.props.appConfig&&this.props.appConfig.pages,t=e&&Object.keys(e).filter(t=>e[t].type===r.PageType.Normal);let s=[this.currentPage];return t&&(s=s.concat(t.map(t=>({id:t,name:e[t].label})))),s},this.setLinkParam=e=>{let t=this.props.linkParam;t=t.set("value",e.id),this.props.onLinkParamChange(t)}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}render(){const e=this.getPageData();return r.React.createElement("div",{className:"w-100"},r.React.createElement("div",{className:"mb-12 option-name"},this.props.intl.formatMessage({id:"chooseAPage",defaultMessage:j.defaultMessages.chooseAPage})),r.React.createElement("div",{style:{maxHeight:this.props.selectAreaMaxHeight?this.props.selectAreaMaxHeight:"",overflowY:this.props.selectAreaMaxHeight?"auto":""}},r.React.createElement(X,{linkParam:this.props.linkParam,datas:e,onClick:this.setLinkParam})))}}class Z extends r.React.PureComponent{constructor(e){super(e),this.getInitLinkParam=()=>{const e=this.props.appConfig.dialogs;if(!e||Object.keys(e).length<1)return Object(r.Immutable)({linkType:r.LinkType.Dialog,value:""});if(this.props.originLinkParam.linkType!==r.LinkType.Dialog){const e=this.getDialogData();return Object(r.Immutable)({linkType:r.LinkType.Dialog,value:e&&e.some(e=>"default"===e.id)?"default":e&&e[0]&&e[0].id})}return this.props.originLinkParam},this.getDialogData=()=>{var e,t;const s=this.props.appConfig&&this.props.appConfig.dialogs,o=(null===(e=s&&Object.values(s).filter(e=>(null==e?void 0:e.mode)===r.DialogMode.Fixed))||void 0===e?void 0:e.sort((e,t)=>e.index-t.index))||[],i=(null===(t=s&&Object.values(s).filter(e=>(null==e?void 0:e.mode)===r.DialogMode.Anchored))||void 0===t?void 0:t.sort((e,t)=>e.index-t.index))||[],n=o.concat(i).map(e=>e.id);return n&&n.filter(e=>!s[e].isSplash).map(e=>({id:e,name:s[e].label}))},this.setLinkParam=e=>{let t=this.props.linkParam;t=t.set("value",e.id),this.props.onLinkParamChange(t)}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}componentDidUpdate(e){if(e.appConfig!==this.props.appConfig){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}}render(){const e=this.getDialogData();return r.React.createElement("div",{className:"w-100"},r.React.createElement("div",{className:"mb-12 option-name"},this.props.intl.formatMessage({id:"chooseADialog",defaultMessage:j.defaultMessages.chooseADialog})),r.React.createElement("div",{style:{maxHeight:this.props.selectAreaMaxHeight?this.props.selectAreaMaxHeight:"",overflowY:this.props.selectAreaMaxHeight?"auto":""}},e&&e.length>0&&r.React.createElement(X,{linkParam:this.props.linkParam,datas:e,onClick:this.setLinkParam})))}}var ee=s(18);class te extends r.React.PureComponent{constructor(e){super(e),this.getInitLinkParam=()=>{const e=ee.searchUtils.getBlockAnchorPointsInPage(ee.utils.getAppConfig(),ee.utils.getCurrentPageId(),ee.utils.getCurrentSizeMode());if(!e||e.length<1)return Object(r.Immutable)({linkType:r.LinkType.Block,value:""});if(this.props.originLinkParam.linkType!==r.LinkType.Block){const e=this.getBlockData();return Object(r.Immutable)({linkType:r.LinkType.Block,value:e&&e.some(e=>"default"===e.id)?"default":e&&e[0]&&e[0].id})}return this.props.originLinkParam},this.getBlockData=()=>ee.searchUtils.getBlockAnchorPointsInPage(ee.utils.getAppConfig(),ee.utils.getCurrentPageId(),ee.utils.getCurrentSizeMode()).map(e=>({id:e.id,name:e.label})),this.setLinkParam=e=>{let t=this.props.linkParam;t=t.set("value",e.id),this.props.onLinkParamChange(t)}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}render(){const e=this.getBlockData();return r.React.createElement("div",{className:"w-100"},r.React.createElement("div",{className:"mb-12 option-name"},this.props.intl.formatMessage({id:"jumpTo",defaultMessage:j.defaultMessages.jumpTo})),r.React.createElement("div",{style:{maxHeight:this.props.selectAreaMaxHeight?this.props.selectAreaMaxHeight:"",overflowY:this.props.selectAreaMaxHeight?"auto":""}},e&&e.length>0&&r.React.createElement(X,{linkParam:this.props.linkParam,datas:e,onClick:this.setLinkParam})))}}class se extends r.React.PureComponent{constructor(e){super(e),this.screenGroupLabelStyle={marginLeft:"-20px"},this.getInitLinkParam=()=>{const e=this.getScreenData();return!e||e.length<1?Object(r.Immutable)({linkType:r.LinkType.Screen,value:""}):this.props.originLinkParam.linkType!==r.LinkType.Screen?Object(r.Immutable)({linkType:r.LinkType.Screen,value:e[0].screens[0].id}):this.props.originLinkParam},this.getScreenData=()=>ee.searchUtils.getScreenAnchorPointsInPage(ee.utils.getAppConfig(),ee.utils.getCurrentPageId(),ee.utils.getCurrentSizeMode()),this.setLinkParam=e=>{let t=this.props.linkParam;t=t.set("value",e.target.value),this.props.onLinkParamChange(t)}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}render(){var e;const t=this.getScreenData(),s=[];return t.forEach(e=>{s.push(r.React.createElement("option",{value:e.id,key:e.id,disabled:!0,style:this.screenGroupLabelStyle},e.label)),e.screens.forEach((t,o)=>s.push(r.React.createElement("option",{value:t.id,key:`${e.id}-${o}`},t.label)))}),r.React.createElement("div",{className:"w-100"},r.React.createElement("div",{className:"mb-12 option-name"},this.props.intl.formatMessage({id:"jumpTo",defaultMessage:j.defaultMessages.jumpTo})),r.React.createElement("div",{style:{maxHeight:this.props.selectAreaMaxHeight?this.props.selectAreaMaxHeight:"",overflowY:this.props.selectAreaMaxHeight?"auto":""}},t.length>0&&r.React.createElement(j.Select,{value:null===(e=this.props.linkParam)||void 0===e?void 0:e.value,className:"w-100",onChange:this.setLinkParam},s)))}}const oe=s(85),ie=s(86);class ne extends r.React.PureComponent{constructor(e){super(e)}componentWillMount(){this.setState({collapse:this.props.isOpen})}render(){return r.React.createElement("div",{className:Object(r.classNames)("w-100",this.props.className)},r.React.createElement("div",{style:{overflow:"hidden"},className:"w-100 btn pb-2 pr-2 d-flex justify-content-between",onClick:e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.setState({collapse:!this.state.collapse})}},r.React.createElement("div",null,this.props.title),r.React.createElement(j.Icon,{icon:this.state.collapse?oe:ie,size:"12"})),r.React.createElement(j.Collapse,{isOpen:this.state.collapse},this.props.children))}}function re(e,t){const s=t&&t.pages;return s&&s[e]&&s[e].type===r.PageType.Normal&&ee.searchUtils.getContentsInPageBody(t,e,r.LayoutItemType.Section,ee.utils.getCurrentSizeMode())||[]}function ae(e,t){if(!e)return[];const s=le(e,t);if(s&&s.length>0){let e=[],o=[];return s.forEach(s=>{e=e.concat(ce(s,t).map(e=>e.id))}),e.length>0&&e.forEach(e=>{o=o.concat(ae(e,t))}),e.concat(o)}return[]}function le(e,t){return ee.searchUtils.getContentsInView(t,e,r.LayoutItemType.Section,ee.utils.getCurrentSizeMode())||[]}function ce(e,t){const s=t.sections[e].views,o=[];for(let e=0;e<s.length;e++)o.push({id:s[e],label:t.views[s[e]].label});return o}class pe extends r.React.PureComponent{constructor(e){super(e),this.noScroll="Do not scroll",this.getInitLinkParam=()=>this.props.originLinkParam.linkType===r.LinkType.View?this.props.originLinkParam:Object(r.Immutable)({linkType:r.LinkType.View,openType:Q.CurrentWindow,value:""}),this.pageChange=e=>{let t=this.props.linkParam;t=t.set("value",e.target.value),this.props.onLinkParamChange(t)},this.viewChange=(e,t)=>{let s=[];s=Object.assign(s,this.state.viewLinkParamArr),s[0]||(s[0]=this.getDefaultPageId());const o=this.props.appConfig.sections[t].views;let i=s.filter(t=>o.some(e=>e===t)&&t!==e),n=[];const r=s.indexOf(e);if(r>-1?i=i.concat(s[r]):n=n.concat(e),i&&i.length>0){let e=[];i.forEach(t=>{e=e.concat(ae(t,this.props.appConfig))}),i=i.concat(e)}s=s.filter(e=>!i.some(t=>t===e)),s=s.concat(n);let a=this.props.linkParam;a=a.set("value",s.join(",")),this.props.onLinkParamChange(a)},this.viewRemove=e=>{let t=[];t=Object.assign(t,this.state.viewLinkParamArr),t[0]||(t[0]=this.getDefaultPageId());const s=ae(e,this.props.appConfig).concat(e);t=t.slice(0,1).concat(t.slice(1).filter(e=>!s.some(t=>t===e)));let o=this.props.linkParam;o=o.set("value",t.join(",")),this.props.onLinkParamChange(o,!0)},this.onScrollToViewChange=e=>{this.setState({scrollToViewId:e})},this.getDefaultPageId=()=>{const e=this.props.appConfig&&this.props.appConfig.pages,t=e&&Object.keys(e).filter(e=>re(e,this.props.appConfig).length>0);return t&&t.find(t=>e[t].isDefault)||t&&t[0]},this.getSelectedVeiwIds=()=>this.state.viewLinkParamArr.slice(1),this.state={viewLinkParamArr:[],scrollToViewId:this.noScroll}}componentDidMount(){const e=this.getInitLinkParam(),{value:t,linkType:s}=e;t&&s===r.LinkType.View?this.setState({viewLinkParamArr:t.split(",")}):this.setState({viewLinkParamArr:[]}),this.props.onLinkParamChange(e)}static getDerivedStateFromProps(e,t){const{value:s,linkType:o}=e.linkParam;return s&&o===r.LinkType.View?Object.assign(Object.assign({},t),{viewLinkParamArr:s.split(",")}):Object.assign(Object.assign({},t),{viewLinkParamArr:[]})}render(){var e,t;if(!this.props.appConfig)return null;const s={};Object.keys(this.props.appConfig.pages).forEach(e=>{this.props.appConfig.pages[e]&&this.props.appConfig.pages[e].type===r.PageType.Normal&&(s[e]=Object.assign({},this.props.appConfig.pages[e]))});const o=this.state.viewLinkParamArr[0]||this.getDefaultPageId();return s[o]?r.React.createElement("div",{className:"w-100"},r.React.createElement("div",{className:"mb-12 option-name"},this.props.intl.formatMessage({id:"chooseViews",defaultMessage:j.defaultMessages.chooseViews})),r.React.createElement("div",{style:{maxHeight:this.props.selectAreaMaxHeight?this.props.selectAreaMaxHeight:"",overflowY:this.props.selectAreaMaxHeight?"auto":""}},r.React.createElement(j.Select,{value:o,onChange:this.pageChange,className:"w-100 mb-3"},Object.keys(s).filter(e=>re(e,this.props.appConfig).length>0).map((e,t)=>r.React.createElement("option",{key:t,value:s[e].id},s[e].label))),r.React.createElement("div",{className:Object(r.classNames)("choose-view",{"mb-3":(null===(e=re(o,this.props.appConfig))||void 0===e?void 0:e.length)>0})},re(o,this.props.appConfig).map(e=>r.React.createElement(de,{sections:this.props.appConfig.sections,sectionId:e,viewsInfo:ce(e,this.props.appConfig),viewLinkParamArr:this.state.viewLinkParamArr,viewChange:this.viewChange,viewRemove:this.viewRemove,key:e}))),r.React.createElement("div",{className:Object(r.classNames)("choose-view",{"mb-3":(null===(t=this.getSelectedVeiwIds())||void 0===t?void 0:t.length)>0})},this.getSelectedVeiwIds().map(e=>le(e,this.props.appConfig).map(e=>r.React.createElement(de,{sections:this.props.appConfig.sections,sectionId:e,viewsInfo:ce(e,this.props.appConfig),viewLinkParamArr:this.state.viewLinkParamArr,viewChange:this.viewChange,viewRemove:this.viewRemove,key:e})))))):null}}class de extends r.React.PureComponent{constructor(e){super(e),this.onViewChange=e=>{this.setState({viewId:e}),this.props.viewChange(e,this.props.sectionId)},this.state={viewId:null}}componentWillUnmount(){this.props.viewRemove(this.state.viewId)}render(){return r.React.createElement(ne,{className:"mb-3 choose-view",title:this.props.sections[this.props.sectionId]&&this.props.sections[this.props.sectionId].label,isOpen:!0,key:this.props.sectionId},r.React.createElement("div",{className:"linksetting-list w-100 view-border border-top-0 border-left-0 border-right-0 rounded-0"},this.props.viewsInfo.map((e,t)=>r.React.createElement("div",{onClick:()=>this.onViewChange(e.id),key:t,className:Object(r.classNames)("linksetting-list-item btn w-100 view-border px-2 pt-1 text-left border-bottom-0 rounded-0 text-truncate",{"item-common":!this.props.viewLinkParamArr.includes(e.id)},{itemselected:this.props.viewLinkParamArr.includes(e.id)}),title:e.label},e.label))))}}var ue=s(66);const he=Object(r.Immutable)([ue.ExpressionInputType.Static,ue.ExpressionInputType.Attribute,ue.ExpressionInputType.Expression]);class me extends r.React.PureComponent{constructor(e){super(e),this.getInitLinkParam=()=>this.props.originLinkParam.linkType===r.LinkType.WebAddress?this.props.originLinkParam:Object(r.Immutable)({linkType:r.LinkType.WebAddress,openType:Q.NewWindow,value:""}),this.webAddressInputChange=e=>{const t=e;let s=this.props.linkParam;s=s.set("value",t).set("expression",null),this.props.onLinkParamChange(s)},this.webAddressExpressionChange=e=>{let t=this.props.linkParam;t=t.set("expression",e).set("value",""),this.props.onLinkParamChange(t),this.closeExpPopup()},this.openExpPopup=()=>this.setState({isExpPopupOpen:!0}),this.closeExpPopup=()=>this.setState({isExpPopupOpen:!1}),this.getDefaultExp=()=>({name:"Expression",parts:[{type:r.ExpressionPartType.String,exp:'"https://"'}]}),this.state={isExpPopupOpen:!1,showUrlError:!1,urlError:""}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}render(){return r.React.createElement("div",{className:"w-100"},r.React.createElement("div",{className:"mb-12 option-name"},this.props.intl.formatMessage({id:"url",defaultMessage:j.defaultMessages.url})),r.React.createElement("div",null,this.props.useDataSources&&this.props.useDataSources.length>0?r.React.createElement(ue.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.webAddressExpressionChange,expression:this.props.linkParam&&this.props.linkParam.expression||this.getDefaultExp(),closeExpPopup:this.closeExpPopup,openExpPopup:this.openExpPopup,isExpPopupOpen:this.state.isExpPopupOpen,types:he,widgetId:this.props.widgetId}):r.React.createElement(j.TextInput,{type:"url",value:this.props.linkParam.value?this.props.linkParam.value:"",className:"w-100",placeholder:this.props.intl.formatMessage({id:"websitePlaceholder",defaultMessage:j.defaultMessages.websitePlaceholder}),spellCheck:!1,onAcceptValue:this.webAddressInputChange})))}}class ge extends r.React.PureComponent{constructor(e){if(super(e),this.getLinkTypeContent=()=>{if(this.props.isLinkPageSetting)return Object(r.jsx)(j.Select,{value:this.state.linkParam.linkType,onChange:this.linkTypeChange,className:"w-100"},Object(r.jsx)("option",{value:r.LinkType.WebAddress},this.props.intl.formatMessage({id:"url",defaultMessage:j.defaultMessages.url})));{const e=this.getHiddenLinks();return Object(r.jsx)(j.Select,{value:this.state.linkParam.linkType,onChange:this.linkTypeChange,className:"w-100"},!e.some(e=>e===r.LinkType.None)&&Object(r.jsx)("option",{value:r.LinkType.None},this.props.intl.formatMessage({id:"none",defaultMessage:j.defaultMessages.none})),!e.some(e=>e===r.LinkType.Page)&&Object(r.jsx)("option",{value:r.LinkType.Page},this.props.intl.formatMessage({id:"page",defaultMessage:r.defaultMessages.page})),!e.some(e=>e===r.LinkType.View)&&Object(r.jsx)("option",{value:r.LinkType.View},this.props.intl.formatMessage({id:"view",defaultMessage:r.defaultMessages.view})),!e.some(e=>e===r.LinkType.Dialog)&&Object(r.jsx)("option",{value:r.LinkType.Dialog},this.props.intl.formatMessage({id:"dialog",defaultMessage:r.defaultMessages.dialog})),!e.some(e=>e===r.LinkType.WebAddress)&&Object(r.jsx)("option",{value:r.LinkType.WebAddress},this.props.intl.formatMessage({id:"url",defaultMessage:j.defaultMessages.url})),!e.some(e=>e===r.LinkType.Block)&&Object(r.jsx)("option",{value:r.LinkType.Block},this.props.intl.formatMessage({id:"block",defaultMessage:r.defaultMessages.block})),!e.some(e=>e===r.LinkType.PageTop)&&Object(r.jsx)("option",{value:r.LinkType.PageTop},this.props.intl.formatMessage({id:"pageTop",defaultMessage:j.defaultMessages.pageTop})))}},this.getHiddenLinks=()=>{var e;let t=this.props.hiddenLinks||Object(r.Immutable)([]);const s=ee.utils.getCurrentPageId(),o=ee.utils.getAppConfig(),i=null===(e=o.pages)||void 0===e?void 0:e[s],n=ee.searchUtils.findLayoutId(null==i?void 0:i.layout,ee.utils.getCurrentSizeMode(),o.mainSizeMode),a=o.layouts[n];return(null==a?void 0:a.type)===r.LayoutType.FixedLayout&&(t=t.concat([r.LinkType.Block,r.LinkType.Screen,r.LinkType.PageTop])),t},this.getLinkContent=e=>{switch(e){case r.LinkType.None:return null;case r.LinkType.Page:return Object(r.jsx)(K,{selectAreaMaxHeight:this.props.selectAreaMaxHeight,originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,appConfig:this.props.appConfig,onLinkParamChange:this.linkParamChange,intl:this.props.intl});case r.LinkType.Dialog:return Object(r.jsx)(Z,{selectAreaMaxHeight:this.props.selectAreaMaxHeight,originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,appConfig:this.props.appConfig,onLinkParamChange:this.linkParamChange,intl:this.props.intl});case r.LinkType.Block:return Object(r.jsx)(te,{selectAreaMaxHeight:this.props.selectAreaMaxHeight,originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,onLinkParamChange:this.linkParamChange,intl:this.props.intl});case r.LinkType.Screen:return Object(r.jsx)(se,{selectAreaMaxHeight:this.props.selectAreaMaxHeight,originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,onLinkParamChange:this.linkParamChange,intl:this.props.intl});case r.LinkType.View:return Object(r.jsx)(pe,{selectAreaMaxHeight:this.props.selectAreaMaxHeight,intl:this.props.intl,originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,appConfig:this.props.appConfig,onLinkParamChange:this.linkParamChange,browserSizeMode:this.props.browserSizeMode});case r.LinkType.WebAddress:return Object(r.jsx)(me,{selectAreaMaxHeight:this.props.selectAreaMaxHeight,intl:this.props.intl,originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,onLinkParamChange:this.linkParamChange,useDataSources:this.props.useDataSources,widgetId:this.props.widgetId});default:return null}},this.linkTypeChange=e=>{let t=Object(r.Immutable)(this.state.linkParam);const s=e.target.value;s===r.LinkType.PageTop&&(t=Object(r.Immutable)({})),this.setState({linkParam:t.set("linkType",s)})},this.radioOpenTypeChange=e=>{let t=Object(r.Immutable)(this.state.linkParam);t=t.set("openType",e),this.setState({linkParam:t})},this.linkParamChange=(e,t)=>{t?e&&this.state.linkParam&&e.linkType===this.state.linkParam.linkType&&this.setState({linkParam:e}):this.setState({linkParam:e})},this.settingConfirm=()=>{const e=Object(r.Immutable)(this.state.linkParam);this.setState({originLinkParam:e}),this.props.onSettingConfirm(e)},this.isLinkParamOk=e=>{if(!e||!e.linkType)return!1;if(e.linkType===r.LinkType.View){const t=e.value&&e.value.split(",")[0]||null,s=e.value&&e.value.split(",").slice(1)||[];return!!(t&&"string"==typeof t&&s.length>0)}if(e.linkType===r.LinkType.WebAddress){if(this.props.useDataSources&&this.props.useDataSources.length>0){const t=e.expression&&e.expression.parts;let s=!1;return t&&t.length>0&&(s=1!==t.length||!!t[0].exp&&'""'!==t[0].exp),s}{const t=j.utils.getHttpErrorType(e.value);return e.value&&!t}}return e.linkType===r.LinkType.PageTop||e.linkType===r.LinkType.None||!(!e.value||"string"!=typeof e.value)},this.props.linkParam&&this.props.linkParam.linkType)this.state={linkParam:Object(r.Immutable)(this.props.linkParam),originLinkParam:Object(r.Immutable)(this.props.linkParam)};else{const e={linkType:r.LinkType.None,openType:"_self"};this.state={linkParam:Object(r.Immutable)(e),originLinkParam:Object(r.Immutable)(e)}}}needOpenIn(e){if(!e)return!0;return![r.LinkType.Dialog,r.LinkType.Block,r.LinkType.Screen,r.LinkType.PageTop].some(t=>t===e.linkType)}render(){if(this.props.appConfig){const e=this.getLinkTypeContent(),t=this.getLinkContent(this.state.linkParam.linkType);return Object(r.jsx)("div",{className:Object(r.classNames)(this.props.className,"w-100 h-100")},Object(r.jsx)("div",{className:"widget-builder-linksetting w-100 h-100"},Object(r.jsx)("div",{style:{position:"relative"},className:"w-100 h-100"},Object(r.jsx)(j.Container,null,Object(r.jsx)(j.Row,{className:"mb-12 option-name"},this.props.intl.formatMessage({id:"linkTo",defaultMessage:j.defaultMessages.linkTo})),Object(r.jsx)(j.Row,{className:"mb-3"},e),this.state.linkParam.linkType!==r.LinkType.None?Object(r.jsx)("div",null,Object(r.jsx)(j.Row,{className:"mb-3"},t),this.needOpenIn(this.state.linkParam)&&Object(r.jsx)("div",null,Object(r.jsx)(j.Row,{className:"mb-12 option-name"},this.props.intl.formatMessage({id:"openIn",defaultMessage:j.defaultMessages.openIn})),Object(r.jsx)(j.Container,{className:"p-0"},Object(r.jsx)(j.Row,{className:"mb-3"},Object(r.jsx)(j.Radio,{onChange:()=>this.radioOpenTypeChange(Q.CurrentWindow),id:"link-setting-app-window",checked:this.state.linkParam.openType===Q.CurrentWindow}),Object(r.jsx)(j.Label,{for:"link-setting-app-window",className:"ml-2 link-setting-cursor-pointer open-type-label text-truncate"},this.props.intl.formatMessage({id:"appWindow",defaultMessage:j.defaultMessages.appWindow}))),Object(r.jsx)(j.Row,{className:"mb-3"},Object(r.jsx)(j.Radio,{onChange:()=>this.radioOpenTypeChange(Q.TopWindow),id:"link-setting-top-window",checked:this.state.linkParam.openType===Q.TopWindow}),Object(r.jsx)(j.Label,{for:"link-setting-top-window",className:"ml-2 link-setting-cursor-pointer open-type-label text-truncate"},this.props.intl.formatMessage({id:"topWindow",defaultMessage:j.defaultMessages.topWindow}))),Object(r.jsx)(j.Row,{className:"mb-3"},Object(r.jsx)(j.Radio,{onChange:()=>this.radioOpenTypeChange(Q.NewWindow),id:"link-setting-new-window",checked:this.state.linkParam.openType===Q.NewWindow}),Object(r.jsx)(j.Label,{for:"link-setting-new-window",className:"ml-2 link-setting-cursor-pointer open-type-label text-truncate"},this.props.intl.formatMessage({id:"newWindow",defaultMessage:j.defaultMessages.newWindow})))))):null),Object(r.jsx)("div",{className:"w-100",style:{position:"absolute"}},Object(r.jsx)(j.Button,{className:"w-100 text-dark link-setting-ok-btn",type:"primary",onClick:this.settingConfirm,disabled:!this.isLinkParamOk(this.state.linkParam)},Object(r.jsx)("div",{className:"text-truncate"},this.props.intl.formatMessage({id:"ok",defaultMessage:r.defaultMessages.ok})))))))}return null}componentDidMount(){this.props.isLinkPageSetting&&this.linkTypeChange({target:{value:r.LinkType.WebAddress}})}}const fe=r.ReactRedux.connect(e=>({appConfig:window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder.appConfig:e.appConfig,browserSizeMode:window&&window.jimuConfig&&window.jimuConfig.isBuilder?e.appStateInBuilder.browserSizeMode:e.browserSizeMode}))(Object(r.injectIntl)(r.themeUtils.withStyles(ge,"LinkSetting")));var be=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const ve=[{name:"preventOverflow",options:{boundariesElement:"viewport"}}];class xe extends r.React.PureComponent{constructor(){super(...arguments),this.handleDocumentMousedown=e=>{if(this.props.isOpen){const t=e.target;(!this.props.trigger||Object(j.isOutBoundary)(t,this.props.trigger))&&this.props.toggle()}}}componentDidMount(){var e;null===(e=this.getReference(this.props.position))||void 0===e||e.addEventListener("mousedown",this.handleDocumentMousedown,!1)}componentDidUpdate(e){("left"===this.props.position&&e.leftSidebarCollapse&&!this.props.leftSidebarCollapse||"right"===this.props.position&&e.rightSidebarCollapse&&!this.props.rightSidebarCollapse)&&this.props.isOpen&&this.props.toggle()}componentWillUnmount(){var e;null===(e=this.getReference(this.props.position))||void 0===e||e.removeEventListener("mousedown",this.handleDocumentMousedown,!1)}getReference(e){return"left"===e?document&&document.querySelector('[data-layoutid="left-sidebar-left-layout"]'):document&&document.querySelector('[data-layoutid="right-sidebar-right-layout"]')}getPlacement(e){return"left"===e?"right-start":"left-start"}render(){const e=this.props,{isOpen:t,position:s,className:o,dispatch:i,leftSidebarCollapse:n,rightSidebarCollapse:a,trigger:l}=e,c=be(e,["isOpen","position","className","dispatch","leftSidebarCollapse","rightSidebarCollapse","trigger"]);return r.React.createElement(j.Popper,Object.assign({reference:this.getReference(s),placement:this.getPlacement(s),open:t,className:Object(r.classNames)("bg-light-300",o),modifiers:ve},c,{toggle:null}),this.props.children)}}const we=r.ReactRedux.connect((e,t)=>{var s,o,i,n;return{leftSidebarCollapse:null===(o=null===(s=e.widgetsState)||void 0===s?void 0:s["left-sidebar"])||void 0===o?void 0:o.collapse,rightSidebarCollapse:null===(n=null===(i=e.widgetsState)||void 0===i?void 0:i["right-sidebar"])||void 0===n?void 0:n.collapse}})(r.themeUtils.withStyles(xe,"SidePopper"));class je extends r.React.PureComponent{constructor(e){super(e),this.close=()=>{this.props.onSettingCancel()},this.getIsOpen=()=>this.props.isOpen||this.props.showDialog}render(){const e=this.props.pisition||"right",{title:t}=this.props;return r.React.createElement(we,{isOpen:this.getIsOpen(),position:e,toggle:this.close,trigger:this.props.trigger},r.React.createElement("div",{className:"bg-light-300 w-100 h-100"},r.React.createElement("div",{className:"w-100 d-flex align-items-center justify-content-between"},r.React.createElement(j.PanelHeader,{level:1,className:"p-3",showClose:!!this.close,onClose:this.close,title:this.props.intl.formatMessage({id:t?"setLinkForTitle":"setLink",defaultMessage:t?j.defaultMessages.setLinkForTitle:j.defaultMessages.setLink},{title:t})})),r.React.createElement("div",{className:"w-100 h-100 px-3",style:{overflowY:"auto"}},r.React.createElement("div",null,r.React.createElement(fe,{isLinkPageSetting:this.props.isLinkPageSetting,linkParam:this.props.linkParam,onSettingConfirm:this.props.onSettingConfirm,useDataSources:this.props.useDataSources,selectAreaMaxHeight:"500px",widgetId:this.props.widgetId,hiddenLinks:this.props.hiddenLinks}),r.React.createElement("div",{style:{height:"100px"}})))))}}const ye=Object(r.injectIntl)(r.themeUtils.withTheme(je));var ke=s(46),Se=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(e){n(e)}}function a(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))};function Oe(){var e,t,s,o;return Se(this,void 0,void 0,(function*(){const i=null===(o=null===(s=null===(t=null===(e=Object(r.getAppStore)())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===s?void 0:s.appConfig)||void 0===o?void 0:o.dataSources,n=[];return i&&Object.keys(i).forEach(e=>{const t=r.DataSourceManager.getInstance().getDataSource(e);n.push(Ce(t))}),Promise.allSettled(n).then(e=>{let t={};return e.filter(e=>"fulfilled"===e.status).map(e=>e.value).forEach(e=>{e&&Object.keys(e).forEach(s=>{t[s]?t[s].dataSources=t[s].dataSources.concat(e[s].dataSources):t=Object.assign(Object.assign({},t),e)})}),t})}))}function Ce(e,t=!1){var s,o,i,n,a,l,c,p,d,u;return Se(this,void 0,void 0,(function*(){const h={};if(!e)return h;const m=null===(n=null===(i=null===(o=null===(s=Object(r.getAppStore)())||void 0===s?void 0:s.getState())||void 0===o?void 0:o.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===n?void 0:n.widgets,g=(null===(a=e.getMainDataSource())||void 0===a?void 0:a.id)==e.id,f=ke.dataComponentsUtils.getWidgetsUsingDsOrItsViews(e.id,m,!1).length>0,b=r.dataSourceUtils.getFullServiceUrl(null===(l=e.getDataSourceJson())||void 0===l?void 0:l.url,!1);if(g&&b&&(t||f)){const t=(null===(c=e.getDataSourceJson())||void 0===c?void 0:c.portalUrl)&&(null===(p=e.getDataSourceJson())||void 0===p?void 0:p.itemId)?yield function(e,t){return Se(this,void 0,void 0,(function*(){const s=function(e,t){return`${r.SessionManager.getInstance().getSessionKeyFromUrl(t)}-${e}`}(e,t);return De[s]||(De[s]=r.requestUtils.requestWrapper(t,s=>Se(this,void 0,void 0,(function*(){return yield r.esri.restPortal.getItem(e,{portal:r.portalUrlUtils.getPortalRestUrl(t),authentication:s})})))),yield De[s]}))}(null===(d=e.getDataSourceJson())||void 0===d?void 0:d.itemId,null===(u=e.getDataSourceJson())||void 0===u?void 0:u.portalUrl):null,s=r.dataSourceUtils.isOriginDataPremium(t,b),o=r.dataSourceUtils.isOriginDataSubscriber(t,b);(s||o)&&(h[b]={dataSources:[e],isPremium:s,isSubscriber:o})}const v=[];if(g&&e.isDataSourceSet){const s=(e.type===ke.AllDataSourceTypes.WebMap||e.type===ke.AllDataSourceTypes.WebScene)&&f||t;e.getChildDataSources().forEach(e=>{v.push(Ce(e,s))})}return Promise.allSettled(v).then(e=>{let t=h;return e.filter(e=>"fulfilled"===e.status).map(e=>e.value).forEach(e=>{e&&Object.keys(e).forEach(s=>{t[s]?t[s].dataSources=t[s].dataSources.concat(e[s].dataSources):t=Object.assign(Object.assign({},t),e)})}),t})}))}function Pe(e,t){var s;if(!e||!t)return null;let o=null;for(const i in t)if((null===(s=t[i])||void 0===s?void 0:s.sourceUrl)===e){o=t[i];break}return o}function Ie(e,t,s,o){if(!e||!t)return!1;if(!(e.sourceUrl===t))return!1;if(!(!e.hitsPerInterval&&!s||e.hitsPerInterval===s))return!1;return!((e.intervalSeconds||o)&&e.intervalSeconds!==o)}function Me(){var e,t;const s=null===(e=Object(r.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder.appInfo;return null===(t=null==s?void 0:s.typeKeywords)||void 0===t?void 0:t.includes("Registered App")}function Ne(){var e,t,s,o,i,n,a,l,c,p;return Se(this,void 0,void 0,(function*(){if(!(!(null===(s=null===(t=null===(e=Object(r.getAppStore)().getState())||void 0===e?void 0:e.appContext)||void 0===t?void 0:t.jimuConfig)||void 0===s?void 0:s.isInPortal)&&!(null===(n=null===(i=null===(o=Object(r.getAppStore)().getState())||void 0===o?void 0:o.appContext)||void 0===i?void 0:i.jimuConfig)||void 0===n?void 0:n.isDevEdition)))return yield Promise.resolve(!1);const d=Me();let u=!1;if(!d){const e=null===(a=Object(r.getAppStore)().getState())||void 0===a?void 0:a.appStateInBuilder.appInfo,t=null===(p=null===(c=null===(l=Object(r.getAppStore)().getState())||void 0===l?void 0:l.appStateInBuilder)||void 0===c?void 0:c.user)||void 0===p?void 0:p.username;u=(null==e?void 0:e.owner)===t}if(!(d||u))return yield Promise.resolve(!1);const h=yield Oe(),m=Object.keys(h).map(e=>Se(this,void 0,void 0,(function*(){return yield r.ServiceManager.getInstance().fetchServiceInfo(e).then(e=>e.isHostedInSamePortal)})));return Promise.all(m).then(e=>(null==e?void 0:e.length)>0&&(null==e?void 0:e.some(e=>e)))}))}function Le(e,t){return Se(this,void 0,void 0,(function*(){if(!e||0===e.length||!t)return yield Promise.resolve();const s=Ee();return yield r.esri.restRequest.request(s,{authentication:r.SessionManager.getInstance().getSessionByUrl(Object(r.getAppStore)().getState().portalUrl),httpMethod:"POST",params:{proxies:e.join()}}).then(e=>Se(this,void 0,void 0,(function*(){var s;return e.results&&Object.values(e.results).forEach(e=>{e.success&&Re(e.proxyId,t)}),null==t||t.exec(),(null===(s=e.results)||void 0===s?void 0:s.every(e=>!0===e.success))?Promise.resolve():Promise.reject("Deleting existing proxy failed: "+JSON.stringify(e))}))).catch(s=>Se(this,void 0,void 0,(function*(){return e.forEach(e=>{Re(e,t)}),null==t||t.exec(),Promise.reject("Deleting existing proxy failed: "+JSON.stringify(s))})))}))}function Re(e,t){var s,o,i;const n=null===(i=null===(o=null===(s=Object(r.getAppStore)().getState())||void 0===s?void 0:s.appStateInBuilder)||void 0===o?void 0:o.appConfig)||void 0===i?void 0:i.appProxies,a=n&&Object.values(n).find(t=>t.proxyId===e);a&&(null==t||t.removeAppProxy(a.id))}function Ae(){var e,t,s,o,i,n,a;const l=null===(t=null===(e=Object(r.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.portalUrl,c=null===(o=null===(s=Object(r.getAppStore)().getState())||void 0===s?void 0:s.appStateInBuilder)||void 0===o?void 0:o.appId;return`${l}/sharing/rest/content/users/${null===(a=null===(n=null===(i=Object(r.getAppStore)().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===n?void 0:n.appInfo)||void 0===a?void 0:a.owner}/items/${c}`}function Te(){return Ae()+"/createProxies"}function Ee(){return Ae()+"/deleteProxies"}const De={};const $e=s(51);class ze extends r.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.interval={none:this.props.intl.formatMessage({id:"intervalNone",defaultMessage:j.defaultMessages.intervalNone}),second:this.props.intl.formatMessage({id:"intervalSecond",defaultMessage:j.defaultMessages.intervalSecond}),minute:this.props.intl.formatMessage({id:"intervalMinute",defaultMessage:j.defaultMessages.intervalMinute}),hour:this.props.intl.formatMessage({id:"intervalHour",defaultMessage:j.defaultMessages.intervalHour}),day:this.props.intl.formatMessage({id:"intervalDay",defaultMessage:j.defaultMessages.intervalDay})},this.setIsHostedInSamePortal=()=>{this.props.sourceUrl&&r.ServiceManager.getInstance().fetchServiceInfo(this.props.sourceUrl).then(e=>{this.__unmount||this.setState({isHostedInSamePortal:e.isHostedInSamePortal})})},this.onToggleProxy=()=>{let e;e=this.props.proxyConfig?null:Object(r.Immutable)({sourceUrl:this.props.sourceUrl}),this.props.onChange(this.props.sourceUrl,e)},this.onHitsPerInervalChange=e=>{const t=e,s=Object(r.Immutable)({sourceUrl:this.props.sourceUrl,hitsPerInterval:t}),o=this.props.proxyConfig?this.props.proxyConfig.merge(s):s;this.props.onChange(this.props.sourceUrl,o)},this.onIntervalUnitChange=e=>{const t=e.target.value,s=this.getIntervalSeconds(t),o=Object(r.Immutable)({sourceUrl:this.props.sourceUrl,intervalSeconds:s}),i=this.props.proxyConfig?this.props.proxyConfig.merge(o):o;this.props.onChange(this.props.sourceUrl,i)},this.state={isHostedInSamePortal:!0}}componentDidMount(){this.__unmount=!1,this.setIsHostedInSamePortal()}componentDidUpdate(e){this.__unmount=!1,e.sourceUrl!==this.props.sourceUrl&&this.setIsHostedInSamePortal()}componentWillUnmount(){this.__unmount=!0}getIntervalUnit(e){if(!e)return"none";switch(e){case 1:return"second";case 60:return"minute";case 3600:return"hour";case 86400:return"day";default:return"none"}}getIntervalSeconds(e){if(!e)return null;switch(e){case"second":return 1;case"minute":return 60;case"hour":return 3600;case"day":return 86400;default:return null}}render(){var e,t;if(!this.props.sourceUrl)return null;const s=this.props.label,o=!!this.props.proxyConfig,i=this.getIntervalUnit(null===(e=this.props.proxyConfig)||void 0===e?void 0:e.intervalSeconds),n=r.SessionManager.getInstance().getMainSession(),a=`${this.props.sourceUrl}?token=${n.token}`;return r.React.createElement("tr",{className:"row m-0 content-table-tr"},r.React.createElement("td",{className:"col-2",title:this.state.isHostedInSamePortal?null:this.props.intl.formatMessage({id:"disabledProxyTooltip",defaultMessage:j.defaultMessages.disabledProxyTooltip})},r.React.createElement(j.Switch,{onChange:this.onToggleProxy,checked:o,className:"mr-2",disabled:!this.state.isHostedInSamePortal})),r.React.createElement("td",{className:"col-4",title:s},r.React.createElement(j.Link,{to:a,target:"_blank",className:"font-size-13 px-0 text-truncate d-block text-left"},s)),r.React.createElement("td",{className:"col-2"},this.props.isPremium&&r.React.createElement(j.Icon,{icon:$e,size:16})),r.React.createElement("td",{className:"col-2"},o&&r.React.createElement(j.NumericInput,{size:"sm",value:null===(t=this.props.proxyConfig)||void 0===t?void 0:t.hitsPerInterval,onChange:this.onHitsPerInervalChange,precision:0,min:1,className:"request-limit"})),r.React.createElement("td",{className:"col-2"},o&&r.React.createElement(j.Select,{value:i,onChange:this.onIntervalUnitChange,size:"sm",className:"request-interval"},Object.keys(this.interval).map((e,t)=>r.React.createElement("option",{value:e,key:t,selected:e===i},this.interval[e])))))}}class Ue extends r.React.PureComponent{constructor(){super(...arguments),this.columnName={authorized:this.props.intl.formatMessage({id:"authorized",defaultMessage:j.defaultMessages.authorized}),subscriberContent:this.props.intl.formatMessage({id:"subscriberContent",defaultMessage:j.defaultMessages.subscriberContent}),credits:this.props.intl.formatMessage({id:"credits",defaultMessage:j.defaultMessages.credits}),requestLimit:this.props.intl.formatMessage({id:"requestLimit",defaultMessage:j.defaultMessages.requestLimit}),requestInterval:this.props.intl.formatMessage({id:"requestInterval",defaultMessage:j.defaultMessages.requestInterval})},this.onProxyChange=(e,t)=>{let s;const o=this.props.proxyConfigs||Object(r.Immutable)({}),i=r.dataSourceUtils.getDsTypeFromWholeServiceUrl(e)===r.DataSourceTypes.SceneService;if(t){if(s=o.set(e,t),i){const o=e.replace("/SceneServer","/FeatureServer"),i=t.set("sourceUrl",o);s=s.set(o,i)}}else if(s=o.without(e),i){const t=e.replace("/SceneServer","/FeatureServer");s=s.without(t)}this.props.onChange(s)}}render(){const e=this.props.needProxyDataSources,t=this.props.proxyConfigs;return r.React.createElement("div",{className:Object(r.classNames)("h-100 w-100 bg-light-300",{[this.props.className]:!!this.props.className})},r.React.createElement("div",{className:"subscriber-warning"},this.props.intl.formatMessage({id:"subscriberWarning",defaultMessage:j.defaultMessages.subscriberWarning})),r.React.createElement("div",{className:"secondary-title mt-4 mb-3"},this.props.intl.formatMessage({id:"data",defaultMessage:j.defaultMessages.data})),r.React.createElement("table",{className:"content-table w-100"},r.React.createElement("thead",{className:"content-table-header container"},r.React.createElement("tr",{className:"row"},Object.keys(this.columnName).map((e,t)=>r.React.createElement("th",{key:t,className:Object(r.classNames)("text-truncate",{"col-4":"subscriberContent"===e,"col-2":"subscriberContent"!==e}),title:this.columnName[e]},this.columnName[e])))),r.React.createElement("tbody",{className:"container"},e&&Object.keys(e).map((s,o)=>{var i,n;const a=e[s],l=a.dataSources[0],c=(null===(i=l)||void 0===i?void 0:i.getLayerDefinition)?null===(n=l)||void 0===n?void 0:n.getLayerDefinition():l.getServiceDefinition?l.getServiceDefinition():null;return r.React.createElement(ze,{isPremium:a.isPremium,isSubscriber:a.isSubscriber,sourceUrl:s,intl:this.props.intl,key:o,onChange:this.onProxyChange,label:(null==c?void 0:c.name)||r.dataSourceUtils.getServiceLabelFromUrl(s),icon:ke.dataComponentsUtils.getDsIcon(l.getDataSourceJson()),proxyConfig:null==t?void 0:t[s]})}))))}}const Be=Object(r.injectIntl)(r.themeUtils.withStyles(Ue,"ProxySetting"));var We=s(31),He=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function r(e){try{l(o.next(e))}catch(e){n(e)}}function a(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))};const Fe={};class Ve extends r.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.getProxyConfigFromAppProxyJsons=()=>He(this,void 0,void 0,(function*(){var e,t;const s=yield Oe(),o={},i=null===(t=null===(e=Object(r.getAppStore)().getState().appStateInBuilder)||void 0===e?void 0:e.appConfig)||void 0===t?void 0:t.appProxies;return Object.keys(s).forEach(e=>{const t=Pe(e,i);t&&(o[e]=t.without("id").without("proxyId").without("proxyUrl"))}),{proxyConfigs:Object(r.Immutable)(o),needProxyDataSources:s}})),this.registerApp=()=>He(this,void 0,void 0,(function*(){var e,t,s,o;const i=null===(t=null===(e=Object(r.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appId;if(Fe[i])return yield Fe[i];const n=(null===(o=null===(s=Object(r.getAppStore)().getState())||void 0===s?void 0:s.appStateInBuilder)||void 0===o?void 0:o.portalUrl)+"/sharing/rest/oauth2/registerApp";return Fe[i]=r.esri.restRequest.request(n,{authentication:r.SessionManager.getInstance().getSessionByUrl(Object(r.getAppStore)().getState().portalUrl),httpMethod:"POST",params:{itemId:i,appType:"browser",redirect_uris:JSON.stringify([this.getAppRootUrl()])}}),yield Fe[i]})),this.createProxies=e=>He(this,void 0,void 0,(function*(){var t,s,o;if(!e)return yield Promise.resolve(null);const i=null===(o=null===(s=null===(t=Object(r.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===s?void 0:s.appConfig)||void 0===o?void 0:o.appProxies,n={};let a=[];if(Object.keys(e).forEach(t=>{const s=e[t];if(!s)return;const o=s.hitsPerInterval,r=s.intervalSeconds,l=Pe(t,i);Ie(l,t,o,r)?n[l.id]=l:a=a.concat({sourceUrl:t,hitsPerInterval:o,intervalSeconds:r})}),0===a.length)return Object(r.Immutable)(n);Me()||(yield this.registerApp());const l={referrers:[this.getAppUrl()]},c=Te();return r.esri.restRequest.request(c,{authentication:r.SessionManager.getInstance().getSessionByUrl(Object(r.getAppStore)().getState().portalUrl),httpMethod:"POST",params:{serviceProxyParams:l,proxies:a}}).then(e=>{var t,s;const o=(null==e?void 0:e.appProxies)||[],i=n,a=null===(s=null===(t=Object(r.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===s?void 0:s.appConfig,l=null==a?void 0:a.appProxies;return o.forEach(e=>{const t=Pe(e.sourceUrl,l),s=(null==t?void 0:t.id)||r.appConfigUtils.getUniqueId(a.set("appProxies",l?l.merge(i):i),"appProxy");i[s]=Object.assign(Object.assign({},e),{id:s})}),Object(r.Immutable)(i)})})),this.getAppRootUrl=()=>{var e;return null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.origin},this.getAppUrl=()=>{var e,t,s,o,i,n;const a=null===(t=null===(e=Object(r.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appId,l=null===(o=null===(s=Object(r.getAppStore)().getState())||void 0===s?void 0:s.appStateInBuilder)||void 0===o?void 0:o.appInfo,c="Web Experience Template"===(null==l?void 0:l.type),p=null===(i=r.urlUtils.getAppUrl({appId:a,isTemplate:c}))||void 0===i?void 0:i.replace(/^\//,"");return`${null===(n=this.getAppRootUrl())||void 0===n?void 0:n.replace(/\/$/,"")}/${p}`},this.onProxyConfigChange=e=>{this.setState({proxyConfigs:e})},this.onFinish=()=>{var e,t,s,o;this.setState({isLoading:!0});const i=this.state.proxyConfigs||Object(r.Immutable)({}),n=null===(s=null===(t=null===(e=Object(r.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===s?void 0:s.appProxies,a=n&&Object.values(n).filter(e=>{var t;let s=i[null==e?void 0:e.sourceUrl];if(r.dataSourceUtils.getDsTypeFromWholeServiceUrl(null==e?void 0:e.sourceUrl)===r.DataSourceTypes.FeatureService){const o=null===(t=null==e?void 0:e.sourceUrl)||void 0===t?void 0:t.replace("/FeatureServer","/SceneServer"),n=i[o];s=s||(null==n?void 0:n.set("sourceUrl",null==e?void 0:e.sourceUrl))}return!s||!Ie(e,s.sourceUrl,s.hitsPerInterval,s.intervalSeconds)});Le(null==a?void 0:a.map(e=>e.proxyId),null===(o=this.state)||void 0===o?void 0:o.getAppConfigAction()).then(()=>He(this,void 0,void 0,(function*(){return yield this.createProxies(i).then(e=>{var t;if(!this.__unmount){if(e){const s=null===(t=this.state)||void 0===t?void 0:t.getAppConfigAction();Object.keys(e).forEach(t=>{null==s||s.editAppProxy(e[t])}),null==s||s.exec()}this.props.onFinish().then(()=>{this.__unmount||setTimeout(()=>{this.setState({isLoading:!1},()=>{this.props.onToggle()})},3e3)},()=>{this.__unmount||setTimeout(()=>{this.setState({isLoading:!1},()=>{this.props.onToggle()})},3e3)})}})}))).catch(e=>{console.error("Creating proxy failed: ",e),this.setState({isLoading:!1,isError:!0},()=>{setTimeout(()=>{this.setState({isError:!1})},5500)})})},this.getTostStyle=()=>{var e,t,s,o,i,n,a,l,c,p,d;return r.css`
      & {
        height:  ${r.polished.rem(40)};
        top: ${r.polished.rem(60)};
      }
      .jimu-toast-info {
        background: ${null===(o=null===(s=null===(t=null===(e=this.props)||void 0===e?void 0:e.theme)||void 0===t?void 0:t.colors)||void 0===s?void 0:s.palette)||void 0===o?void 0:o.secondary[300]};
        line-height: ${r.polished.rem(40)};
        color: ${null===(l=null===(a=null===(n=null===(i=this.props)||void 0===i?void 0:i.theme)||void 0===n?void 0:n.colors)||void 0===a?void 0:a.palette)||void 0===l?void 0:l.dark[800]};
        font-weight: 300;
        padding: 0 ${r.polished.rem(16)};
        box-shadow: 0 0 ${r.polished.rem(10)} ${r.polished.rem(2)} ${r.polished.rgba(null===(d=null===(p=null===(c=this.props)||void 0===c?void 0:c.theme)||void 0===p?void 0:p.colors)||void 0===d?void 0:d.white,.2)};
      }
    `},this.state={getAppConfigAction:null,isLoading:!1,isError:!1,proxyConfigs:null,needProxyDataSources:null}}componentDidMount(){this.__unmount=!1,r.moduleLoader.loadModule("jimu-for-builder").then(e=>{this.__unmount||this.setState({getAppConfigAction:e.getAppConfigAction})}),this.setState({isLoading:!0}),this.getProxyConfigFromAppProxyJsons().then(e=>{this.__unmount||this.setState({proxyConfigs:e.proxyConfigs,needProxyDataSources:e.needProxyDataSources,isLoading:!1})},e=>{this.__unmount||this.setState({isLoading:!1}),console.error("Getting proxy config error",e)})}componentDidUpdate(e){(!e.isOpen&&this.props.isOpen||e.appProxies!==this.props.appProxies)&&(this.setState({isLoading:!0}),this.getProxyConfigFromAppProxyJsons().then(e=>{this.__unmount||this.setState({proxyConfigs:e.proxyConfigs,needProxyDataSources:e.needProxyDataSources,isLoading:!1})},e=>{this.__unmount||this.setState({isLoading:!1}),console.error("Getting proxy config error",e)}))}componentWillUnmount(){this.__unmount=!0}render(){const e=this.state.proxyConfigs,t=this.state.needProxyDataSources;return Object(r.jsx)(j.Modal,{isOpen:this.props.isOpen,centered:!0,className:Object(r.classNames)({[this.props.className]:!!this.props.className}),returnfocusafterclose:"true",contentClassName:"proxy-setting-container",backdrop:"static"},Object(r.jsx)(j.ModalHeader,{className:"d-flex justify-content-between header px-30",toggle:this.props.onToggle},Object(r.jsx)("div",{className:"flex-grow-1 text-truncate"},this.props.intl.formatMessage({id:"subscriberContents",defaultMessage:j.defaultMessages.subscriberContents}))),Object(r.jsx)(j.ModalBody,{className:"d-flex px-30"},Object(r.jsx)(Be,{onChange:this.onProxyConfigChange,proxyConfigs:e,needProxyDataSources:t})),Object(r.jsx)(j.ModalFooter,{className:"px-30"},Object(r.jsx)(j.Button,{className:"mr-2",type:"primary",onClick:this.onFinish},this.props.intl.formatMessage({id:"publish",defaultMessage:r.defaultMessages.publish})),Object(r.jsx)(j.Button,{type:"default",onClick:this.props.onCancel},this.props.intl.formatMessage({id:"cancel",defaultMessage:r.defaultMessages.cancel}))),this.state.isLoading&&Object(r.jsx)(j.Loading,{type:We.a.Secondary}),this.state.isError&&Object(r.jsx)(j.Toast,{open:this.state.isError,type:We.c.Info,css:this.getTostStyle(),text:this.props.intl.formatMessage({id:"creatProxyToPublishAppError",defaultMessage:j.defaultMessages.creatProxyToPublishAppError})}))}}const _e=Object(r.injectIntl)(r.themeUtils.withStyles(r.themeUtils.withTheme(Ve),"ProxySettingPopup")),Je=r.ReactRedux.connect((e,t)=>{var s,o;return{appProxies:null===(o=null===(s=null==e?void 0:e.appStateInBuilder)||void 0===s?void 0:s.appConfig)||void 0===o?void 0:o.appProxies}})(_e);var qe=s(74),Ge=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};class Ye extends r.React.PureComponent{componentDidUpdate(e){this.props.pageId===e.pageId&&this.props.sizemode===e.sizemode||this.props.toggle()}getStyle(){const{theme:e}=this.props;return e&&r.css`
      background-color: ${e.colors.palette.light[300]};
      ${Object(qe.a)({background:e.colors.palette.light[300],border:{color:e.colors.palette.light[600],width:"1px"}})}
      > * {
        ::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }

        ::-webkit-scrollbar-track {
          background: transparent;
        }

        ::-webkit-scrollbar-thumb {
          background: ${e.colors.palette.light[500]};
          border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
          background: ${e.colors.palette.light[800]};
        }
      }
    `}render(){const e=this.props,{pageId:t,sizemode:s,dispatch:o}=e,i=Ge(e,["pageId","sizemode","dispatch"]);return Object(r.jsx)(j.Popper,Object.assign({css:this.getStyle()},i))}}var Qe=r.ReactRedux.connect((function(e){return{pageId:e.appRuntimeInfo.currentPageId,sizemode:e.browserSizeMode}}))(Ye);const Xe=[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0,options:{boundariesElement:"viewport",padding:10}}];class Ke extends r.React.PureComponent{constructor(e){super(e),this.togglePopper=()=>{this.state.open&&this.props.onClose&&this.props.onClose(),this.setState({open:!this.state.open})},this.state={widgetInfoList:null,open:!0,generation:0}}componentDidMount(){this.loadWidgetInfos()}loadWidgetInfos(){r.WidgetManager.getInstance().getWidgetListInfo().then(e=>{const t=e.filter(e=>this.props.isItemAccepted(e,this.props.isPlaceholder));this.setState({generation:this.state.generation+1,widgetInfoList:t})})}createWidgetCard(e){var t,s;return Object(r.jsx)("div",{className:"d-flex align-items-start justify-content-center widget-card col-4",key:e.name,onClick:()=>this.props.onItemSelect(e)},Object(r.jsx)("div",{className:"d-flex flex-column w-100 h-100 widget-card--content pt-2"},Object(r.jsx)("div",{className:"d-flex justify-content-center"},Object(r.jsx)("div",{className:"widget-card-image mb-1"},Object(r.jsx)(j.Icon,{className:"w-100",autoFlip:null===(s=null===(t=e.manifest)||void 0===t?void 0:t.properties)||void 0===s?void 0:s.flipIcon,icon:"string"==typeof e.icon?e.icon:e.icon&&e.icon.svg,color:this.props.builderTheme.colors.dark}))),Object(r.jsx)("div",{className:"flex-grow-1 d-flex align-items-center"},Object(r.jsx)("div",{className:"widget-card-name w-100 text-center text-capitalize text-truncate",css:r.css`
                line-height: 1rem;
                max-height: 2.2rem;
                white-space: normal;
              `,title:e.label},e.label))))}formatMessage(e){return this.props.intl.formatMessage({id:e,defaultMessage:j.defaultMessages[e]})}getStyle(){const{builderTheme:e}=this.props;return r.css`
      background-color: ${e.colors.palette.light[300]};

      .content {
        max-height: 350px;
        height: auto;
        width: 380px;
        overflow-x: hidden;
        padding: 10px;
      }

      .widget-card {
        height: 80px;
        padding: 4px;

        .widget-card--content {
          cursor: pointer;
          background-color: ${e.colors.palette.light[500]};
          &:hover {
            background-color: ${e.colors.palette.light[600]};
          }
        }

        .widget-card-image {
          width: 20px;
          height: 20px;
          &:after {
            display: none;
          }
          img {
            width: 20px;
            height: 20px;
          }
        }

        .widget-card-name {
          line-height: 1rem;
          max-height: 2rem;
          white-space: normal;
          color: ${e.colors.palette.dark[800]};
          padding: 0 10px;
          font-size: 13px;
        }
      }

      .widget-type-label {
        color: ${e.colors.palette.dark[800]};
        font-size: 14px;
        margin: 0 4px 4px;
      }
    `}render(){if(!this.state.open)return null;const{widgetInfoList:e}=this.state,t=[],s=[];return e&&e.length>0&&e.forEach(e=>{e.manifest.widgetType===r.WidgetType.Layout?s.push(e):t.push(e)}),Object(r.jsx)(Qe,{theme:this.props.builderTheme,placement:"bottom",toggle:this.togglePopper,css:this.getStyle(),version:this.state.generation,modifiers:Xe,reference:this.props.referenceElement,open:!0},Object(r.jsx)("div",{className:"shadow-lg content",ref:e=>this.contentRef=e},!this.state.widgetInfoList&&Object(r.jsx)(j.Loading,null),t.length>0&&Object(r.jsx)("div",{className:"widget-type-label"},this.formatMessage("basic")),t.length>0&&Object(r.jsx)("div",{className:"w-100 h-100 row m-0"},t.map(e=>this.createWidgetCard(e))),s.length>0&&Object(r.jsx)("div",{className:"widget-type-label"},this.formatMessage("layout")),s.length>0&&Object(r.jsx)("div",{className:"w-100 h-100 row m-0"},s.map(e=>this.createWidgetCard(e)))))}}Ke.defaultProps={isPlaceholder:!1,isItemAccepted:()=>!0};const Ze=Object(r.injectIntl)(Ke);var et=s(39);class tt extends r.React.PureComponent{constructor(e){super(e),this.onTemplateSelected=e=>{this.setState({selectedIndex:e}),this.props.onItemSelect(this.templates[e])},this.templates=this.props.pageMode===r.PageMode.FitWindow?Object(et.getFullScreenPageTemplates)():Object(et.getAutoScrollPageTemplates)(),Object(et.addLabelAndDescription)(this.templates),this.state={selectedIndex:-1}}formatMessage(e){return this.props.intl.formatMessage({id:e,defaultMessage:j.defaultMessages[e]})}createTemplateCard(e,t){return Object(r.jsx)("div",{className:"page-item d-flex flex-column col-6",key:t,title:e.description},Object(r.jsx)("div",{className:Object(r.classNames)("img-container d-flex align-items-center justify-content-center",{active:this.state.selectedIndex===t}),onClick:()=>this.onTemplateSelected(t)},Object(r.jsx)(j.Icon,{autoFlip:!0,className:"thumbnail",icon:e.icon,width:160,height:120,options:{currentColor:!1}})),Object(r.jsx)("div",{className:"name w-100 text-center"},e.label))}getStyle(){const{theme:e}=this.props;return r.css`
      height: 100%;
      overflow: auto;
      .page-item {
        width: 160px;
        margin-bottom: 18px;
        user-select: none;
        .img-container {
          height: 110px;
          width: 162px;
          cursor: pointer;
          &:hover {
            outline: 2px solid ${e.colors.palette.primary[600]};
          }
        }

        .name {
          margin-top: 5px;
          font-size: 14px;
          color: ${e.colors.palette.dark[300]};
        }
      }
    `}render(){return Object(r.jsx)("div",{className:"container pt-4 px-4",css:this.getStyle()},Object(r.jsx)("div",{className:"row"},this.templates.map((e,t)=>this.createTemplateCard(e,t))))}}const st=Object(r.injectIntl)(tt);class ot extends r.React.PureComponent{render(){const{theme:e}=this.props;return Object(r.jsx)("div",{className:"w-100 h-100"},Object(r.jsx)("h3",{className:"pt-3 px-4 mb-3 text-dark-600 text-truncate",title:this.props.formatMessage("addPage")},this.props.formatMessage("addPage")),Object(r.jsx)(j.Tabs,{defaultValue:"fullScreenApp",fill:!0,type:"underline",css:r.css`
          position: absolute;
          bottom: 0;
          top: 3.5rem;
          width: 100%;
          .tab-content {
            position: absolute;
            top: 2rem;
            bottom: 0;
          }
          .jimu-nav {
            padding-left: ${e&&e.sizes[4]};
            padding-right: ${e&&e.sizes[4]};
          }
          .nav-item {
            width: 50%;
          }
        `},Object(r.jsx)(j.Tab,{id:"fullScreenApp",title:this.props.formatMessage("fullScreenApp")},Object(r.jsx)(st,{theme:e,pageMode:r.PageMode.FitWindow,onItemSelect:this.props.onItemSelect})),Object(r.jsx)(j.Tab,{id:"scrollingPage",title:this.props.formatMessage("scrollingPage")},Object(r.jsx)(st,{theme:e,pageMode:r.PageMode.AutoScroll,onItemSelect:this.props.onItemSelect}))))}}class it extends r.React.PureComponent{getStyle(){const{theme:e}=this.props;return r.css`
      background-color: ${e.colors.palette.light[300]};

      .block-item {
        display: flex;
        justify-content: space-around;
        align-items: center;
        cursor: pointer;
        width: 200px;
        padding: 1px;
        margin-bottom: 10px;

        .block-item--icon {
          background: ${e.colors.palette.light[400]};
        }
        .block-item--icon:hover {
          outline: 2px solid ${e.colors.palette.primary[500]};
        }
      }

      .size-mode-SMALL .block-item{
        .block-item {
          width: 140px;
        }
      }
    `}createBlock(e,t){return Object(r.jsx)("div",{key:t,className:"col-6 block-item",onClick:()=>this.props.onItemSelect(e)},Object(r.jsx)("div",{className:"block-item--icon"},Object(r.jsx)(j.Icon,{icon:e.icon,width:"100%",height:"auto",options:{currentColor:!1},autoFlip:!0})))}render(){let e;return this.props.isHeader?e=Object(et.getHeaderTemplates)():this.props.isFooter&&(e=Object(et.getFooterTemplates)()),e?Object(r.jsx)("div",{className:"w-100 container p-4",css:this.getStyle()},Object(r.jsx)("div",{className:"row"},e.map((e,t)=>this.createBlock(e,t)))):null}}const nt=[{name:"flip",enabled:!0}];class rt extends r.React.PureComponent{constructor(e){super(e),this.togglePopper=()=>{this.state.open&&this.props.onClose&&this.props.onClose(),this.setState({open:!this.state.open})},this.onItemSelect=e=>{this.props.onClose(),this.props.onItemSelect(e)},this.state={open:!0}}render(){if(!this.state.open)return null;const{referenceElement:e,theme:t,pageMode:s,isHeader:o,isFooter:i}=this.props,n=o||i;return Object(r.jsx)(Qe,{placement:"bottom",theme:this.props.theme,reference:e,offset:[0,10],open:!0,toggle:this.togglePopper,showArrow:!0,modifiers:nt},Object(r.jsx)("div",{ref:e=>this.contentRef=e,style:{width:400}},Object(r.jsx)("div",{className:"w-100",css:r.css`
          max-height: 640px;
          height: ${n?"auto":"calc(100vh - 150px)"};
          overflow: auto;
        `},n&&Object(r.jsx)(it,{isHeader:o,isFooter:i,theme:t,onItemSelect:this.onItemSelect}),!n&&s&&Object(r.jsx)(st,{theme:t,pageMode:s,onItemSelect:this.onItemSelect}),!n&&!s&&Object(r.jsx)(ot,{theme:t,formatMessage:this.props.formatMessage,onItemSelect:this.onItemSelect}))))}}class at extends r.React.PureComponent{constructor(e){super(e),this.onTemplateSelected=e=>{this.setState({selectedIndex:e}),this.props.onItemSelect(this.templates[e])},this.templates=Object(et.getDialogTemplates)(),this.state={selectedIndex:-1}}formatMessage(e){return this.props.intl.formatMessage({id:e,defaultMessage:j.defaultMessages[e]})}createTemplateCard(e,t){return Object(r.jsx)("div",{className:"dialog-item d-flex flex-column col-6",key:t},Object(r.jsx)("div",{className:Object(r.classNames)("img-container d-flex align-items-center justify-content-center",{active:this.state.selectedIndex===t}),onClick:()=>this.onTemplateSelected(t)},Object(r.jsx)(j.Icon,{autoFlip:!0,className:"thumbnail",icon:e.icon,width:166,height:140,options:{currentColor:!1}})),Object(r.jsx)("div",{className:"name w-100 text-center"},this.formatMessage(e.name)))}getStyle(){const{theme:e}=this.props;return r.css`
      .dialog-item {
        margin-bottom: 18px;
        user-select: none;
        .img-container {
          cursor: pointer;
          background: ${e.colors.palette.light[200]};
          &:hover {
            outline: 2px solid ${e.colors.palette.primary[500]};
          }
        }

        .name {
          margin-top: 5px;
          font-size: 14px;
          color: ${e.colors.palette.dark[300]};
        }
      }
    `}render(){return Object(r.jsx)("div",{className:"container pt-4 pl-4 pr-4",css:this.getStyle()},Object(r.jsx)("div",{className:"row h-100"},this.templates.map((e,t)=>this.createTemplateCard(e,t))))}}const lt=Object(r.injectIntl)(at);class ct extends r.React.PureComponent{render(){const{theme:e}=this.props;return Object(r.jsx)("div",{className:"w-100 h-100"},Object(r.jsx)("h3",{className:"pt-4 px-4 mb-3 text-dark-600 text-truncate",title:this.props.formatMessage("addDialog")},this.props.formatMessage("addDialog")),Object(r.jsx)("div",{className:"overflow-auto",style:{height:"calc(100% - 70px)"}},Object(r.jsx)(lt,{theme:e,onItemSelect:this.props.onItemSelect})))}}const pt=[{name:"flip",enabled:!0}];class dt extends r.React.PureComponent{constructor(e){super(e),this.togglePopper=()=>{this.state.open&&this.props.onClose&&this.props.onClose(),this.setState({open:!this.state.open})},this.onItemSelect=e=>{this.props.onClose(),this.props.onItemSelect(e)},this.state={open:!0}}render(){if(!this.state.open)return null;const{referenceElement:e,theme:t,showList:s}=this.props;return Object(r.jsx)(Qe,{placement:"bottom",theme:this.props.theme,reference:e,offset:[0,10],open:!0,toggle:this.togglePopper,showArrow:!0,modifiers:pt},Object(r.jsx)("div",{ref:e=>this.contentRef=e,style:{width:400}},Object(r.jsx)("div",{className:"w-100",css:r.css`
          max-height: ${s?"638px":"385px"} ;
          height: calc(100vh - 150px);
          overflow: auto;
        `},s?Object(r.jsx)(ct,{theme:t,onItemSelect:this.onItemSelect,formatMessage:this.props.formatMessage}):Object(r.jsx)(lt,{theme:t,onItemSelect:this.props.onItemSelect}))))}}class ut extends r.React.PureComponent{getStyle(){const{theme:e}=this.props;return r.css`
      background-color: ${e.colors.palette.light[300]};

      .block-item {
        display: flex;
        justify-content: space-around;
        align-items: center;
        cursor: pointer;
        width: 200px;
        height: 62px;
        padding: 1px;
        margin-bottom: 10px;

        .block-item--icon {
          background: ${e.colors.palette.light[400]};
          height: 60px;
        }
        .block-item--icon:hover {
          outline: 2px solid ${e.colors.palette.primary[600]};
        }
      }

      .size-mode-SMALL .block-item{
        .block-item {
          width: 140px;
          height: 44px;

          .block-item--icon {
            height: 42px;
          }
        }
      }
    `}createBlock(e,t){return Object(r.jsx)("div",{key:t,className:"col-6 block-item",onClick:()=>this.props.onItemSelect(e)},Object(r.jsx)("div",{className:"block-item--icon"},Object(r.jsx)(j.Icon,{icon:e.icon,width:"100%",height:"100%",options:{currentColor:!1}})))}render(){return Object(r.jsx)("div",{className:"w-100 container",css:this.getStyle()},Object(r.jsx)("div",{className:"row"},Object(et.getBlockTemplates)().map((e,t)=>this.createBlock(e,t))))}}const ht=[{name:"flip",enabled:!0}];class mt extends r.React.PureComponent{constructor(e){super(e),this.togglePopper=()=>{this.state.open&&this.props.onClose&&this.props.onClose(),this.setState({open:!this.state.open})},this.state={open:!0}}getStyle(){const{theme:e}=this.props;return r.css`
      .title {
        font-size: 14px;
        color: ${e.colors.palette.dark[100]};
        padding: 0 5px 5px 5px;
      }
      .template-content {
        height: auto;
        max-height: 600px;
        width: 450px;
        border: 1px solid ${e.colors.palette.light[600]};
        box-shadow: 0 4px 20px 4px rgba(0,0,0,0.50);
        overflow: auto;
        padding: 10px 15px;
      }

      .size-mode-SMALL & .template-content {
        max-height: 600px;
        width: 320px;
      }
    `}render(){if(!this.state.open)return null;const{referenceElement:e,theme:t}=this.props;return Object(r.jsx)(Qe,{placement:"bottom",theme:this.props.theme,css:this.getStyle(),reference:e,offset:[0,10],toggle:this.togglePopper,open:!0,showArrow:!0,modifiers:ht},Object(r.jsx)("div",{ref:e=>this.contentRef=e,className:"template-content"},Object(r.jsx)(ut,{referenceElement:e,theme:t,onItemSelect:this.props.onItemSelect})))}}class gt extends r.React.PureComponent{constructor(e){super(e),this.state={templates:null}}componentDidMount(){const e=Object(et.getScreenTemplates)();this.setState({templates:e})}getStyle(){const{theme:e}=this.props;return r.css`
      display: grid;
      background-color: ${e.colors.palette.light[300]};
      grid-template-columns: 1fr 1fr;
      grid-row-gap: 10px;
      grid-column-gap: 10px;

      .block-item {
        display: flex;
        justify-content: space-around;
        align-items: center;
        cursor: pointer;
        width: 164px;
        height: 100px;

        .block-item--icon {
          background: ${e.colors.palette.light[200]};
        }
        .block-item--icon:hover {
          outline: 2px solid ${e.colors.palette.primary[600]};
        }
      }

      .size-mode-SMALL .block-item{
        .block-item {
          width: 140px;
          height: 44px;

          .block-item--icon {
            height: 42px;
          }
        }
      }
    `}createBlock(e,t){return Object(r.jsx)("div",{key:t,className:"block-item",onClick:()=>this.props.onItemSelect(e)},Object(r.jsx)("div",{className:"block-item--icon"},Object(r.jsx)(j.Icon,{icon:e.icon,width:"100%",height:"100%",options:{currentColor:!1}})))}render(){return this.state.templates?Object(r.jsx)("div",{className:"w-100",css:this.getStyle()},this.state.templates.map((e,t)=>this.createBlock(e,t))):Object(r.jsx)(j.Loading,null)}}const ft=[{name:"flip",enabled:!0}];class bt extends r.React.PureComponent{constructor(e){super(e),this.togglePopper=()=>{this.state.open&&this.props.onClose&&this.props.onClose(),this.setState({open:!this.state.open})},this.state={open:!0}}getStyle(){const{theme:e}=this.props;return r.css`
      .title {
        font-size: 14px;
        color: ${e.colors.palette.dark[100]};
        padding: 0 5px 5px 5px;
      }
      .template-content {
        height: auto;
        max-height: 600px;
        width: 400px;
        border: 1px solid ${e.colors.palette.light[600]};
        box-shadow: 0 4px 20px 4px rgba(0,0,0,0.50);
        overflow: auto;
        padding: 16px;
      }

      .size-mode-SMALL & .template-content {
        max-height: 600px;
        width: 320px;
      }
    `}render(){if(!this.state.open)return null;const{referenceElement:e,theme:t}=this.props;return Object(r.jsx)(Qe,{placement:"bottom",theme:this.props.theme,css:this.getStyle(),reference:e,offset:[0,10],toggle:this.togglePopper,open:!0,showArrow:!0,modifiers:ft},Object(r.jsx)("div",{ref:e=>this.contentRef=e,className:"template-content"},Object(r.jsx)(gt,{referenceElement:e,theme:t,onItemSelect:this.props.onItemSelect})))}}class vt extends r.React.PureComponent{constructor(e){super(e),this.state={templates:null}}componentDidMount(){const e=Object(et.getScreenGroupTemplates)();this.setState({templates:e})}getStyle(){const{theme:e}=this.props;return r.css`
      background-color: ${e.colors.palette.light[300]};
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-row-gap: 10px;
      grid-column-gap: 10px;

      .block-item {
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        align-items: center;
        cursor: pointer;
        width: 180px;
        height: 125px;
        padding: 1px;

        .block-item--icon {
          background: ${e.colors.palette.light[200]};
          height: 108px;
          width: 100%;
          position: relative;

          .screen-group-icon {
            position: absolute;
            width: 100%;
            height: 100%;
          }

          .default-icon {
            opacity: 1;
          }
          .gif-icon {
            opacity: 0;
          }
        }
        .block-item--icon:hover {
          outline: 2px solid ${e.colors.palette.primary[600]};
          .default-icon {
            opacity: 0;
          }
          .gif-icon {
            opacity: 1;
          }
        }

        .block-item-label {
          color: ${e.colors.palette.dark[400]};
        }
      }

      .size-mode-SMALL & .block-item{
        .block-item {
          width: 140px;
          height: 44px;

          .block-item--icon {
            height: 42px;
          }
          .block-item-label {
            display: none;
          }
        }
      }
    `}createBlock(e,t){return Object(r.jsx)("div",{key:t,className:"block-item",onClick:()=>this.props.onItemSelect(e)},Object(r.jsx)("div",{className:"block-item--icon"},Object(r.jsx)(j.Icon,{className:"default-icon screen-group-icon",icon:e.icon,width:"100%",height:"100%"}),Object(r.jsx)("img",{className:"gif-icon screen-group-icon",src:r.urlUtils.isAbsoluteUrl(e.gifIcon)?e.gifIcon:`${r.urlUtils.getFixedRootPath()}${e.gifIcon}`,width:"100%",height:"100%"})),Object(r.jsx)("span",{className:"block-item-label"},e.label))}render(){return this.state.templates?Object(r.jsx)("div",{className:"w-100",css:this.getStyle()},this.state.templates.map((e,t)=>this.createBlock(e,t))):Object(r.jsx)(j.Loading,null)}}const xt=[{name:"flip",options:{fallbackPlacements:["top","right"]}}];class wt extends r.React.PureComponent{constructor(e){super(e),this.togglePopper=()=>{this.state.open&&this.props.onClose&&this.props.onClose(),this.setState({open:!this.state.open})},this.state={open:!0}}getStyle(){const{theme:e}=this.props;return r.css`
      .title {
        font-size: 14px;
        color: ${e.colors.palette.dark[100]};
        padding: 0 5px 5px 5px;
      }
      .template-content {
        height: auto;
        max-height: 600px;
        width: 400px;
        border: 1px solid ${e.colors.palette.light[600]};
        box-shadow: 0 4px 20px 4px rgba(0,0,0,0.50);
        overflow: auto;
        padding: 10px 15px;
      }

      .size-mode-SMALL & .template-content {
        max-height: 600px;
        width: 320px;
      }
    `}render(){if(!this.state.open)return null;const{referenceElement:e,theme:t}=this.props;return Object(r.jsx)(Qe,{placement:"bottom",theme:this.props.theme,css:this.getStyle(),reference:e,offset:[0,10],toggle:this.togglePopper,open:!0,showArrow:!0,modifiers:xt},Object(r.jsx)("div",{ref:e=>this.contentRef=e,className:"template-content"},Object(r.jsx)(vt,{referenceElement:e,theme:t,onItemSelect:this.props.onItemSelect})))}}class jt extends r.React.PureComponent{constructor(e){super(e),this.initData=()=>{if(Array.isArray(this.props.value)&&this.props.value.length)return!1;const e=this.deepClone(this.state.option);e.ruleOptionName=this.props.intl.formatMessage({id:"option",defaultMessage:j.defaultMessages.option})+0;const t=[e];this.props.onChange(t)},this.onOptionChange=(e,t,s,o)=>{const i=this.deepClone(this.props.value);i[t].rule[e][s]=o,this.props.onChange(i,t)},this.onSelectChange=(e,t,s)=>{const o=e[0];if(!o)return;const i=this.deepClone(this.props.value),n=o.name;i[s].rule[t].jimuFieldName=n,this.props.onChange(i,s)},this.addOption=()=>{const e=Array.isArray(this.props.value),t=e?this.props.value.length:0,s=this.createOptionText(t),o=this.deepClone(this.state.option);o.ruleOptionName=s;const i=e?this.deepClone(this.props.value):[];i.push(o),this.props.onChange(i)},this.createOptionText=e=>{const t=this.props.intl.formatMessage({id:"option",defaultMessage:j.defaultMessages.option})+e;if(!this.isOptionNameRepeat(t))return t;const s=e+1;return this.createOptionText(s)},this.deleteOption=e=>{const t=this.deepClone(this.props.value);t.splice(e,1),this.props.onChange(t)},this.deleteAll=()=>{this.props.onChange([])},this.toggleOptionNameDisplay=(e,t)=>{const s=this.deepClone(this.props.value);let o=s[e].isEditOptionName;if(o=!!o,s[e].isEditOptionName=!o,t){const o=t.target.value;!this.isOptionNameRepeat(o)&&o&&(s[e].ruleOptionName=o)}this.props.onChange(s)},this.isOptionNameRepeat=e=>{if(!Array.isArray(this.props.value))return!1;let t=!1;return this.props.value.forEach(s=>{s.ruleOptionName==e&&(t=!0)}),t},this.deepClone=e=>{const t=Array.isArray(e)?[]:{};for(const s in e){const o=("object"==typeof e[s]||"function"==typeof e[s])&&null!==e[s];t[s]=o?this.deepClone(e[s]):e[s]}return t},this.setInputRef=e=>{e&&(e.select(),e.focus())},this.createRuleOptionElement=(e,t,o,i)=>{const n=t.jimuFieldName?Object(r.Immutable)([t.jimuFieldName]):Object(r.Immutable)([]);return Object(r.jsx)("div",{className:"select-down-con",key:t.jimuFieldName||o},this.props.useDataSource&&Object(r.jsx)("div",{className:"sort-field-selector"},Object(r.jsx)(ke.FieldSelector,{useDataSources:e,onChange:(e,t)=>{this.onSelectChange(e,o,i)},selectedFields:n,isSearchInputHidden:!0,isDataSourceDropDownHidden:!0,useDropdown:!0})),[{getTitle:()=>this.nls("ascending"),order:r.OrderRule.Asc,getIcon:()=>s(93)},{getTitle:()=>this.nls("decending"),order:r.OrderRule.Desc,getIcon:()=>s(92)}].map((e,s,n)=>Object(r.jsx)(j.Button,{key:s,title:e.getTitle(),type:t.order==e.order?"primary":"secondary",className:"sort-button "+(this.props.singleRowItemOnly&&t.order!=e.order?"collapse":""),onClick:()=>{this.onOptionChange(o,i,"order",this.props.singleRowItemOnly?[...n,n[0]][s+1].order:e.order)}},Object(r.jsx)(j.Icon,{size:"12",icon:e.getIcon(),className:"sort-arrow-down-icon"}))))},this.createOptionNameElement=(e,t)=>{const o=e.ruleOptionName,i=this.props.intl.formatMessage({id:"optionNamePlaceholder",defaultMessage:j.defaultMessages.optionNamePlaceholder}),n=Object(r.jsx)(j.TextInput,{type:"text",value:o,onBlur:e=>{this.toggleOptionNameDisplay(t,e)},ref:e=>{this.setInputRef(e)},placeholder:i});return Object(r.jsx)("div",{className:"option-name d-flex"},e.isEditOptionName?n:Object(r.jsx)("span",{title:o,onDoubleClick:()=>{this.toggleOptionNameDisplay(t)}},o),Object(r.jsx)("span",{title:this.nls("edit"),onClick:()=>{this.toggleOptionNameDisplay(t)}},Object(r.jsx)(j.Icon,{size:"12",icon:s(95),className:"option-name-icon"})))},this.createOptionElement=(e,t,o)=>{let i;i=Object(r.jsx)("div",{className:"close-con text-right"},Object(r.jsx)("span",{title:this.nls("deleteOption"),onClick:()=>{this.deleteOption(o)}},Object(r.jsx)(j.Icon,{size:this.props.singleRowItemOnly?14:12,icon:s(38),className:"sort-arrow-down-icon"})));const n=()=>t.rule.map((t,s)=>this.createRuleOptionElement(e,t,s,o));return Object(r.jsx)("div",{className:"select-con",key:o},this.props.singleRowItemOnly&&Object(r.jsx)(r.React.Fragment,null,Object(r.jsx)("div",{className:"option-name-con"},Object(r.jsx)(j.Icon,{size:14,icon:s(283)}),n(),i))||Object(r.jsx)(r.React.Fragment,null,Object(r.jsx)("div",{className:"option-name-con"},(()=>this.createOptionNameElement(t,o))(),i),n()))},this.nls=e=>this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:j.defaultMessages[e]}):e,this.onDataSourceCreated=e=>{},this.state={option:{ruleOptionName:"",isEditOptionName:!1,rule:[{jimuFieldName:"",order:r.OrderRule.Asc}]}}}componentDidMount(){this.initData()}componentDidUpdate(e,t){var s,o,i;(null===(s=null==e?void 0:e.useDataSource)||void 0===s?void 0:s.dataSourceId)!==(null===(i=null===(o=this.props)||void 0===o?void 0:o.useDataSource)||void 0===i?void 0:i.dataSourceId)&&Promise.resolve(!0).then(()=>{this.initData()})}render(){const{value:e}=this.props,t=this.props.intl.formatMessage({id:"invalidExpression",defaultMessage:j.defaultMessages.invalidExpression});return Object(r.jsx)("div",{className:Object(r.classNames)("sort-con",this.props.singleRowItemOnly&&"single-row-item",{[this.props.className]:!!this.props.className})},Object(r.jsx)("div",null,Object(r.jsx)("div",{className:"add-option-btn"},Object(r.jsx)(j.Icon,{size:"12",icon:s(106),className:"add-option-icon"}),Object(r.jsx)("span",{onClick:this.addOption},this.props.intl.formatMessage({id:"addOption",defaultMessage:j.defaultMessages.addOption}))),Object(r.jsx)(r.DataSourceComponent,{useDataSource:this.props.useDataSource,onDataSourceCreated:this.onDataSourceCreated},s=>{if(!Array.isArray(e))return t;return(this.props.optionRenderFunction||(()=>e.map((e,t)=>{var s;return this.createOptionElement(Object(r.Immutable)([null===(s=this.props.useDataSource)||void 0===s?void 0:s.asMutable({deep:!0})]),e,t)})))(this.props,this.createOptionElement)}),Array.isArray(e)&&0==e.length&&Object(r.jsx)("div",{className:"no-sort-remind"},Object(r.jsx)("div",null,this.props.intl.formatMessage({id:"noOptionRemindText",defaultMessage:j.defaultMessages.noOptionRemindText})),Object(r.jsx)("div",null,this.props.intl.formatMessage({id:"pleaceAddOne",defaultMessage:j.defaultMessages.pleaceAddOne})))))}}const yt=r.themeUtils.withStyles(Object(r.injectIntl)(jt),"SortSetting");var kt=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const St=s(284),Ot=s(285),Ct=e=>{const t=j.hooks.useTranslate(),{vertical:s=!1,onChange:o,autoFlip:i=!0,className:n,size:a="sm"}=e,l=kt(e,["vertical","onChange","autoFlip","className","size"]),c="sm"===a?12:16;return r.React.createElement(j.ButtonGroup,Object.assign({size:a,className:Object(r.classNames)("setting--direction-selector",n)},l),r.React.createElement(j.Button,{size:a,title:t("horizontal"),type:"default",icon:!0,active:!s,onClick:()=>o(!1)},r.React.createElement(j.Icon,{size:c,icon:St,autoFlip:i})),r.React.createElement(j.Button,{size:a,title:t("vertical"),type:"default",icon:!0,active:s,onClick:()=>o(!0)},r.React.createElement(j.Icon,{size:c,icon:Ot})))};var Pt;!function(e){e.Auto="AUTO",e.Custom="CUSTOM"}(Pt||(Pt={}));const It=s(77);class Mt extends r.React.PureComponent{constructor(e){super(e),this.toggleDropdown=()=>{this.setState(e=>({dropdownOpen:!e.dropdownOpen}))},this.state={dropdownOpen:!1},this._onAutoSelected=this.onSelect.bind(this,Pt.Auto),this._onCustomSelected=this.onSelect.bind(this,Pt.Custom)}onSelect(e){this.props.mode!==e&&this.props.onChange(e)}getStyle(){return r.css`
      .auto-dropdown.jimu-dropdown {
        width: 26px;
        height: 26px;

        .btn {
          padding: 0 !important;
        }
      }

      & > .jimu-dropdown .jimu-dropdown-button,
      & > .jimu-dropdown .jimu-dropdown-button:hover {
        height: 26px;
        padding: 0 0.375rem;
      }
    `}autoInput(){return Object(r.jsx)(j.Input,{style:{width:"110px"},css:r.css`
          background-color: var(--light-600);
          border-color: var(--light-600);
          color: var(--black);
          height: 1.625rem;
          border-width: 0;
          padding: 0 0.25rem;
        `,disabled:!0,value:this.props.intl.formatMessage({id:"auto"})})}render(){const{mode:e,intl:t}=this.props,s=t.formatMessage({id:"auto"}),o=t.formatMessage({id:"custom"});return Object(r.jsx)("div",{className:"d-flex",css:this.getStyle()},Object(r.jsx)(j.Dropdown,{className:"auto-dropdown",isOpen:this.state.dropdownOpen,toggle:this.toggleDropdown},Object(r.jsx)(j.DropdownButton,{icon:!0}),Object(r.jsx)(j.DropdownMenu,null,Object(r.jsx)(j.DropdownItem,{onClick:this._onAutoSelected},Object(r.jsx)("span",{css:r.css`width: 1rem;`},e===Pt.Auto&&Object(r.jsx)(j.Icon,{icon:It,size:12})),s),Object(r.jsx)(j.DropdownItem,{onClick:this._onCustomSelected},Object(r.jsx)("span",{css:r.css`width: 1rem;`},e===Pt.Custom&&Object(r.jsx)(j.Icon,{icon:It,size:12})),o))),e===Pt.Auto&&this.autoInput(),e===Pt.Custom&&this.props.children)}}const Nt=Object(r.injectIntl)(Mt),Lt=e=>{const{title:t,children:s,selected:o,onClick:i}=e,n=(()=>{var e,t,s;const o=r.React.useContext(r.ThemeContext),i=null===(e=null==o?void 0:o.colors)||void 0===e?void 0:e.palette.primary[600],n=null===(t=null==o?void 0:o.colors)||void 0===t?void 0:t.palette.light[200],a=null===(s=null==o?void 0:o.colors)||void 0===s?void 0:s.black;return r.React.useMemo(()=>r.css`
      width: 100%;
      height:  ${r.polished.rem(50)};
      padding: ${r.polished.rem(8)}  ${r.polished.rem(12)};
      display: flex;
      align-items: center;
      justify-content: center;
      color: ${a};
      background-color: ${n};
      position: relative;
      &.selected {
        outline: 3px solid ${i};
      }
      >.overlay {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
      }
  `,[i,n,a])})();return Object(r.jsx)("div",{css:n,title:t,className:Object(r.classNames)("quick-style-item",{selected:o}),onClick:i},Object(r.jsx)("div",{className:"overlay"}),s)};var Rt=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const At=[{name:"preventOverflow",options:{altAxis:!0}},{name:"flip",options:{fallbackPlacements:["bottom-end","top-end"]}}],Tt=e=>{const{a11yVersion:t,open:s,reference:o,onClose:i,placement:n="right-start",children:a}=e,l=Rt(e,["a11yVersion","open","reference","onClose","placement","children"]),c=(()=>{var e,t,s,o;const i=r.themeUtils.getBuilderThemeVariables(),n=null===(e=null==i?void 0:i.colors)||void 0===e?void 0:e.palette.dark[600],a=null===(t=null==i?void 0:i.colors)||void 0===t?void 0:t.palette.dark[800],l=null===(s=null==i?void 0:i.colors)||void 0===s?void 0:s.palette.light[300],c=null===(o=null==i?void 0:i.colors)||void 0===o?void 0:o.palette.light[600];return r.React.useMemo(()=>r.css`
      background-color: ${l};
      color: ${n};
      border: 1px solid ${c};
      > .popper-box {
        > .panel-header {
          color: ${n};
          .action-btn {
            color: ${n};
            &:hover {
              color: ${a};
            }
          }
        }
      }
    `,[n,a,l,c])})(),p=j.hooks.useTranslate(j.defaultMessages);return Object(r.jsx)(j.Popper,Object.assign({css:c,open:s,className:"shadow-2",reference:o,modifiers:At,placement:n,a11yVersion:t},l),Object(r.jsx)(j.PanelHeader,{className:"px-3 py-2",title:p("quickStyle"),onClose:i}),a)};function Et(e){var t,s;const o=Object(r.getAppStore)().getState().appStateInBuilder,i=o.appRuntimeInfo.currentPageId,n=o.appRuntimeInfo.currentDialogId;let a=o.appRuntimeInfo.dialogInfos||Object(r.Immutable)({});const l=o.appConfig.dialogs,c=o.appConfig.pages,p={canClose:!0,checked:!0,isClosed:!0};return n&&((null===(t=l[n])||void 0===t?void 0:t.isSplash)&&(a=a.set(n,p)),c[i].autoOpenDialogId&&(a=a.set(i+"-"+c[i].autoOpenDialogId,p)),e&&Object.keys(c).map(e=>{c[e].autoOpenDialogId===n&&(a=a.set(e+"-"+n,p))})),(null===(s=l[n])||void 0===s?void 0:s.isSplash)||Object.keys(l).some(e=>{l[e].isSplash&&(a=a.set(e,p))}),e&&a&&Object.keys(a).map(t=>{t!==e&&t!==i+"-"+e||(a=a.set(t,{canClose:Dt(e),checked:!1,isClosed:!1}))}),a}function Dt(e){const t=Object(r.getAppStore)().getState().appStateInBuilder.appConfig.dialogs[e];return!t.interactionType||!t.confirmBeforeClose}function $t(e){const t=Object(r.getAppStore)().getState().appStateInBuilder,s=t.appRuntimeInfo.currentPageId,o=t.appRuntimeInfo.currentDialogId;if(w.builderAppSync.publishChangeSelectionToApp(null),o){const e=Et();w.builderAppSync.publishDialogInfosChangeToApp(e),w.builderAppSync.publishDialogChangeToApp(null)}s!==e&&w.builderAppSync.publishPageChangeToApp(e),w.builderAppSync.publichActivePagePartChangeToApp(r.PagePart.Body)}function zt(e){w.builderAppSync.publishChangeSelectionToApp(null);if(e!==Object(r.getAppStore)().getState().appStateInBuilder.appRuntimeInfo.currentDialogId){w.builderAppSync.publishDialogChangeToApp(e);const t=Et(e);w.builderAppSync.publishDialogInfosChangeToApp(t),w.builderAppSync.publichActivePagePartChangeToApp(null)}}r.ThemeManager.getInstance().registerJimuThemeStyleModule("jimu-ui/advanced/setting-components/",{componentStyles:o})}}))}}}));