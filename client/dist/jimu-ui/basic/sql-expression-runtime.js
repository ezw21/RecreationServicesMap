System.register(["jimu-core","jimu-ui","jimu-ui/basic/list-tree"],(function(e){var t,s,a;return{setters:[function(e){t=e},function(e){s=e},function(e){a=e}],execute:function(){e(function(e){var t={};function s(a){if(t[a])return t[a].exports;var l=t[a]={i:a,l:!1,exports:{}};return e[a].call(l.exports,l,l.exports,s),l.l=!0,l.exports}return s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)s.d(a,l,function(t){return e[t]}.bind(null,l));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=983)}({0:function(e,s){e.exports=t},1:function(e,t){e.exports=s},218:function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M1.1 3H.5a.5.5 0 010-1H3V1a1 1 0 011-1h4a1 1 0 011 1v1h2.5a.5.5 0 010 1h-.6l-.81 8.1a1 1 0 01-.995.9h-6.19a1 1 0 01-.995-.9L1.1 3zm1.005 0l.8 8h6.19l.8-8h-7.79zM4 2h4V1H4v1zm.5 2a.5.5 0 01.5.5v5a.5.5 0 01-1 0v-5a.5.5 0 01.5-.5zm3 0a.5.5 0 01.5.5v5a.5.5 0 01-1 0v-5a.5.5 0 01.5-.5z" fill-rule="evenodd"></path></svg>'},36:function(e,t){e.exports=a},60:function(e,t){e.exports='<svg viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg"><path d="M1.521 2.307L4 4.677l2.479-2.37a.517.517 0 01.708 0 .464.464 0 010 .677l-2.833 2.71a.517.517 0 01-.708 0L.813 2.983a.464.464 0 010-.677.517.517 0 01.708 0z"></path><path d="M0 0h8v8H0z" fill="none"></path></svg>'},61:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path fill-rule="evenodd" clip-rule="evenodd" d="M.146 3.146a.5.5 0 01.708 0L6 8.5l5.146-5.354a.5.5 0 01.708.708l-5.5 5.707a.5.5 0 01-.708 0l-5.5-5.707a.5.5 0 010-.708z" fill="#000"></path></g><defs><clipPath id="clip0"><path fill="#fff" d="M0 0h12v12H0z"></path></clipPath></defs></svg>'},67:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 32"><path d="M16.492 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zm0 21.333a2 2 0 11.001 3.999 2 2 0 01-.001-3.999zm0-2.666a2 2 0 01-2-2v-8a2 2 0 114 0v8a2 2 0 01-2 2z"></path></svg>'},88:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a.75.75 0 01.75.75v6.5h6.5a.75.75 0 110 1.5h-6.5v6.5a.75.75 0 11-1.5 0v-6.5H.75a.75.75 0 110-1.5h6.5V.75A.75.75 0 018 0z" fill="#000" fill-rule="evenodd"></path></svg>'},983:function(e,t,s){"use strict";s.r(t),s.d(t,"SqlExpressionSizeMode",(function(){return l})),s.d(t,"ClauseInputEditor",(function(){return r})),s.d(t,"ClauseRelationship",(function(){return T})),s.d(t,"getOperatorsByShortType",(function(){return x})),s.d(t,"getClauseArrayByChange",(function(){return V})),s.d(t,"getCamelCase",(function(){return D})),s.d(t,"getJimuFieldNamesBySqlExpression",(function(){return N})),s.d(t,"isSqlExpressionValid",(function(){return M})),s.d(t,"getShownClauseNumberByExpression",(function(){return U})),s.d(t,"getTotalClauseNumberByExpression",(function(){return k})),s.d(t,"getClauseLabel",(function(){return w})),s.d(t,"getClauseDefaultLabel",(function(){return P})),s.d(t,"updateSQLExpressionByVersion",(function(){return A})),s.d(t,"getInputEditor",(function(){return xe})),s.d(t,"getCodedValuesFromDs",(function(){return je})),s.d(t,"getDefaultClauseValObj",(function(){return Ve})),s.d(t,"getDefaultSingleClause",(function(){return De})),s.d(t,"getDefaultClauseSet",(function(){return Fe})),s.d(t,"isCaseSensitiveSupportedByOperatorAndSourceType",(function(){return Ne})),s.d(t,"isAskForValueSupportedByOperatorAndSourceType",(function(){return Me})),s.d(t,"getCodedValueInputEditorsByOperatorAndSourceType",(function(){return Ue})),s.d(t,"getClauseValObjByOperator",(function(){return ke})),s.d(t,"getDisplayTypes",(function(){return we})),s.d(t,"getInputEditorListByOperatorAndSourceType",(function(){return Pe})),s.d(t,"getJimuFieldTypeByEsriType",(function(){return Ae})),s.d(t,"getOperatorsByEsriType",(function(){return Re})),s.d(t,"SqlExpressionRuntime",(function(){return Ke})),s.d(t,"InputEditorRender",(function(){return Be}));var a={};s.r(a),s.d(a,"SqlExpressionClauseRuntime",(function(){return o})),s.d(a,"VIDoubleDateTimePicker",(function(){return n})),s.d(a,"VIDoubleNumberSelector",(function(){return n})),s.d(a,"VIPillSelector",(function(){return u})),s.d(a,"VIPredefinedSelector",(function(){return p}));var l,r,i=s(0);function o(e){const t=e.theme;return i.css`
    margin: 10px 0;

    .sql-expression-label, .sql-expression-displaylabel{
      width: 100%;
      font-size: ${i.polished.rem(13)};
      color: ${t.colors.black};
    }
    .sql-expression-input{
      width: 100%;
      
    }
    .sql-expression-hint{
      margin-top: 4px;
      font-size: ${i.polished.rem(12)};
      color: ${t.colors.palette.dark[300]};
      font-style: italic;
    }

    .clause-inline{
      display: flex;
      justify-content: space-between;
      align-items: center;

      .sql-expression-label{
        width: calc(40% - 8px);
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
      .sql-expression-label, .sql-expression-displaylabel{
        line-height: 32px;
      }
      .sql-expression-input{
        width: calc(60% - 8px);
      }
    }

  `}function n(e){return i.css`
    justify-content: space-between;
    .double-input-connector{
      margin-top: 0.15rem;
      margin-bottom: 0.15rem;
      text-align: center;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
    }
  `}function u(e){const t=e.theme;return i.css`
    /** setting */
    .pill-selector-button{
      justify-content: space-between;
      display: flex;
      align-items: center;

      .pill-display-label{
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
        width: calc(100% - 20px);
      }
    }

    .pill-selector-popper{
      padding: 12px;
      max-width: 320px;
      max-height: 320px;
      overflow-y: auto;

      .jimu-btn{
        margin: 4px;
        max-width: 100%;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
    }

    /** runtime */
    .pill-runtime-container{
      /* width: calc(100% + 10px); */
      width: 100%;
      .pill-btn-container{
        display: flex;
        flex-wrap: wrap;
        margin-left: -5px;
        margin-top: -5px;

        .pill-btn{
          margin: 5px;
          max-width: calc(100% - 10px);
          white-space: nowrap;
          text-overflow: ellipsis;
          overflow: hidden;
          /* &:first-of-type{
            margin-left: 0;
          }
          &:last-of-type{
            margin-right: 0;
          } */

          &.pill-dash-btn{
            border: 1px dashed ${t.colors.white}; /*TODO*/
          }
        }
      }
      &.block-pills .pill-btn{
        display: block;
        margin-top: 10px;
      }
    }
  `}function p(e){const t=e.theme;return i.css`
    .predefined-list{
      min-height: 150px;

      .predefined-list-header{
        border-bottom: 1px solid ${t.colors.palette.dark[200]};
        line-height: 30px;

        .dragIcon{
          width: 26px;
        }
      }

      .predefined-list-content{
        .jimu-tree-item_template-typical .jimu-tree-item__body{
          background-color: #3d3d3d;
        }

        .predefined-item{
          display: flex;
          flex-grow: 1;
          padding: 5px 0px;
          margin-bottom: 2px;
        }
      }

      .predefined-value, .predefined-label{
        width: 160px;
        &.value-input-isValid{
          outline: 1px solid ${t.colors.palette.danger[700]};

          button:focus, input:focus, .dropdown-button[aria-expanded="true"] {
            border: none !important;
          }
        }
      }
      .predefined-label {
        margin-left: 1.5rem;
      }

      .predefined-cbx{
        display: flex;
        width: 150px;
        justify-content: center;
        align-items: center;
      }

      .predefined-delete{
        width:100px;
        text-align: right;
      }

    }

    .invalide-label{
      color: ${t.colors.palette.danger[700]};
      font-size: 12px;
      margin-top: '-32px';
      margin-bottom: '8px'
    }
  `}function c(e,t=!1){const s="calc(100% - 8px)",a={inputEditorWidth:`calc(${s} * 0.44)`,connectorWidth:`calc(${s} * 0.12)`,dropDownWidth:`calc(${s} * 0.32)`};return e&&(t?(a.inputEditorWidth="calc(calc(100% - 4px) * 0.6)",a.dropDownWidth="calc(calc(100% - 4px) * 0.4)"):a.inputEditorWidth="100%"),a}!function(e){e.Small="SMALL",e.Medium="MEDIUM",e.Large="LARGE"}(l||(l={})),function(e){e.DoubleNumberSelector="DOUBLE_NUMBER_SELECTOR",e.TextInput="TEXT_BOX",e.UniquePredefinedSelector="UNIQUE_PREDEFINED_SELECTOR",e.MultiplePredefinedSelector="MULTIPLE_PREDEFINED_SELECTOR",e.FieldSelector="FIELD_SELECTOR",e.SimpleSelect="SIMPLE_SELECT",e.UniquePillWrapSelector="UNIQUE_PILL_WRAP_SELECTOR",e.MultipleSelect="MULTIPLE_SELECT",e.MultiplePillWrapSelector="MULTIPLE_PILL_WRAP_SELECTOR",e.DatePicker="DATE_PICKER",e.DateTimePicker="DATE_TIME_PICKER",e.DateRangeSelector="DATE_RANGE_SELECTOR",e.DoubleDatePicker="DOUBLE_DATE_PICKER",e.DoubleDateTimePicker="DOUBLE_DATE_TIME_PICKER",e.NumberListSelector="NUMBER_LIST_SELECTOR",e.BlankSelector="BLANK_SELECTOR"}(r||(r={}));const d=[r.FieldSelector],h=[r.SimpleSelect,r.UniquePillWrapSelector],m=[r.MultipleSelect,r.MultiplePillWrapSelector],v=[r.TextInput],g=[r.TextInput],S=[r.DoubleNumberSelector],O=[r.DatePicker,r.DateTimePicker],f=[r.DoubleDatePicker,r.DoubleDateTimePicker],y=[r.NumberListSelector],C=[r.SimpleSelect,r.UniquePillWrapSelector],I=[r.BlankSelector],b=[r.UniquePredefinedSelector],E=[r.MultiplePredefinedSelector],T={[i.ClauseOperator.StringOperatorIs]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:v,codedValueInputEditors:C,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,codedValueInputEditors:C,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorIsNot]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:v,codedValueInputEditors:C,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,codedValueInputEditors:C,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorContains]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:v,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorDoesNotContain]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:v,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorStartsWith]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:v,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorDoesNotStartWith]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:v,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorEndsWith]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:v,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorDoesNotEndWith]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:v,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorIsAnyOf]:{[i.ClauseSourceType.MultipleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:m,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorIsNoneOf]:{[i.ClauseSourceType.MultipleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:m,supportAskForValue:!0,supportCaseSensitive:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorIsBlank]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:I,supportCaseSensitive:!0}},[i.ClauseOperator.StringOperatorIsNotBlank]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:I,supportCaseSensitive:!0}},[i.ClauseOperator.NumberOperatorIs]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:g,codedValueInputEditors:C,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,codedValueInputEditors:C,supportAskForValue:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsNot]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:g,codedValueInputEditors:C,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,codedValueInputEditors:C,supportAskForValue:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsAtLeast]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:g,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,supportAskForValue:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsAtMost]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:g,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,supportAskForValue:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsLessThan]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:g,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,supportAskForValue:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsGreaterThan]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:g,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,supportAskForValue:!0},[i.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:b,codedValueInputEditors:b,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsBetween]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:S,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsNotBetween]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:S,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsAnyOf]:{[i.ClauseSourceType.MultipleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:m,supportAskForValue:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsNoneOf]:{[i.ClauseSourceType.MultipleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:m,supportAskForValue:!0},[i.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:E,codedValueInputEditors:E,supportAskForValue:!0}},[i.ClauseOperator.NumberOperatorIsBlank]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:I}},[i.ClauseOperator.NumberOperatorIsNotBlank]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:I}},[i.ClauseOperator.DateOperatorIsOn]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,codedValueInputEditors:C,supportAskForValue:!0}},[i.ClauseOperator.DateOperatorIsNotOn]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d},[i.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:h,codedValueInputEditors:C,supportAskForValue:!0}},[i.ClauseOperator.DateOperatorIsIn]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:[r.DateRangeSelector],supportAskForValue:!0}},[i.ClauseOperator.DateOperatorIsNotIn]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:[r.DateRangeSelector],supportAskForValue:!0}},[i.ClauseOperator.DateOperatorIsBefore]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d}},[i.ClauseOperator.DateOperatorIsAfter]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d}},[i.ClauseOperator.DateOperatorIsOnOrBefore]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d}},[i.ClauseOperator.DateOperatorIsOnOrAfter]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[i.ClauseSourceType.Field]:{normalInputEditors:d}},[i.ClauseOperator.DateOperatorIsInTheLast]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:y,supportAskForValue:!0}},[i.ClauseOperator.DateOperatorIsNotInTheLast]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:y,supportAskForValue:!0}},[i.ClauseOperator.DateOperatorIsBetween]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:f,supportAskForValue:!0}},[i.ClauseOperator.DateOperatorIsNotBetween]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:f,supportAskForValue:!0}},[i.ClauseOperator.DateOperatorIsBlank]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:I}},[i.ClauseOperator.DateOperatorIsNotBlank]:{[i.ClauseSourceType.UserInput]:{normalInputEditors:I}}};function x(e,t){let s=[];return"STRING"===e?s=[i.ClauseOperator.StringOperatorIs,i.ClauseOperator.StringOperatorIsNot,i.ClauseOperator.StringOperatorStartsWith,i.ClauseOperator.StringOperatorDoesNotStartWith,i.ClauseOperator.StringOperatorEndsWith,i.ClauseOperator.StringOperatorDoesNotEndWith,i.ClauseOperator.StringOperatorContains,i.ClauseOperator.StringOperatorDoesNotContain,i.ClauseOperator.StringOperatorIsAnyOf,i.ClauseOperator.StringOperatorIsNoneOf,i.ClauseOperator.StringOperatorIsBlank,i.ClauseOperator.StringOperatorIsNotBlank]:"NUMBER"===e?s=[i.ClauseOperator.NumberOperatorIs,i.ClauseOperator.NumberOperatorIsNot,i.ClauseOperator.NumberOperatorIsAtLeast,i.ClauseOperator.NumberOperatorIsAtMost,i.ClauseOperator.NumberOperatorIsLessThan,i.ClauseOperator.NumberOperatorIsGreaterThan,i.ClauseOperator.NumberOperatorIsBetween,i.ClauseOperator.NumberOperatorIsNotBetween,i.ClauseOperator.NumberOperatorIsAnyOf,i.ClauseOperator.NumberOperatorIsNoneOf,i.ClauseOperator.NumberOperatorIsBlank,i.ClauseOperator.NumberOperatorIsNotBlank]:"DATE"===e&&(s=[i.ClauseOperator.DateOperatorIsOn,i.ClauseOperator.DateOperatorIsNotOn,i.ClauseOperator.DateOperatorIsIn,i.ClauseOperator.DateOperatorIsNotIn,i.ClauseOperator.DateOperatorIsBefore,i.ClauseOperator.DateOperatorIsAfter,i.ClauseOperator.DateOperatorIsOnOrBefore,i.ClauseOperator.DateOperatorIsOnOrAfter,i.ClauseOperator.DateOperatorIsBetween,i.ClauseOperator.DateOperatorIsNotBetween,i.ClauseOperator.DateOperatorIsBlank,i.ClauseOperator.DateOperatorIsNotBlank],t&&s.splice(8,0,i.ClauseOperator.DateOperatorIsInTheLast,i.ClauseOperator.DateOperatorIsNotInTheLast)),s}const j=[i.ClauseSourceType.SingleSelectFromUnique,i.ClauseSourceType.MultipleSelectFromUnique];function V(e,t,s){const a=s.split("_"),l=parseInt(a[a.length-1]);let r=e.slice(0,l);return t&&(r=r.concat(t)),r=r.concat(e.slice(l+1,e.length)),r}function D(e){return(e=e.toLowerCase()).replace(/\_(\w)/g,(function(e,t){return t.toUpperCase()}))}function F(e,t,s,a){let l=null;if(j.includes(t.valueOptions.sourceType)&&t.askForValueOptions&&t.askForValueOptions.cascade!==i.ClauseCascade.None){const r=function(e,t,s){const a={sql:"",logicalOperator:e.logicalOperator,parts:[]},l=t.askForValueOptions.cascade,r=s.split("_");let o=null,n=parseInt(r[1]);return r.length>2&&(o=parseInt(r[1]),n=parseInt(r[3])),l===i.ClauseCascade.Previous?e.parts.some((e,t)=>{if(o)if(t<o)a.parts.push(e);else{if(t!==o)return!0;{const t=e,s={type:t.type,logicalOperator:t.logicalOperator,parts:[]};t.parts.some((e,t)=>{if(!(t<n))return!0;s.parts.push(e)}),a.parts.push(s)}}else{if(!(t<n))return!0;a.parts.push(e)}}):l===i.ClauseCascade.All&&e.parts.some((e,t)=>{if(o)if(t!==o)a.parts.push(e);else{const t=e,s={type:t.type,logicalOperator:t.logicalOperator,parts:[]};t.parts.some((e,t)=>{t!==n&&s.parts.push(e)}),a.parts.push(s)}else t!==n&&a.parts.push(e)}),a}(e,t,s);l=i.dataSourceUtils.getArcGISSQL(Object(i.Immutable)(r),a).sql}return l}function N(e){if(!e)return[];const t={};!function e(s){s.parts&&s.parts.forEach((function(s){if(s.type===i.ClauseType.Set)e(s);else{t[s.jimuFieldName]=!0}}))}(e);return Object.keys(t).map(e=>e)}function M(e){let t=!0;return e?(function e(s){s.parts&&s.parts.forEach((function(s){if(s.type===i.ClauseType.Set)e(s);else{s.valueOptions.isValid||(t=!1)}}))}(e),t):t}function U(e){let t=0;return e&&e.parts.some(e=>{e.type===i.ClauseType.Single&&e.displayType!==i.ClauseDisplayType.None?t++:e.type===i.ClauseType.Set&&e.parts.some(e=>{e.displayType!==i.ClauseDisplayType.None&&t++})}),t}function k(e){let t=0;return e&&e.parts.some(e=>{e.type===i.ClauseType.Single?t++:e.type===i.ClauseType.Set&&e.parts.some(e=>{t++})}),t}function w(e,t,s){const{displayType:a,displayLabel:l,askForValueOptions:r}=e;let o="";return a!==i.ClauseDisplayType.None&&(o=a===i.ClauseDisplayType.UseAskForValue?r.label:l,null===o&&(o=P(e,t,s))),o}function P(e,t,s){var a;if(!t)return"";let l=(t.alias||t.name)+" "+s;if(e.displayType===i.ClauseDisplayType.UseLabel){const s=null===(a=e.valueOptions)||void 0===a?void 0:a.value;if(s){l=`${l} ${s.map(e=>t.type===i.JimuFieldType.String?`'${e.label}'`:e.label).join(",")}`}}return l}function A(e,t,s){let a=null;if(e.parts){const l=e.asMutable({deep:!0});return a=l.parts,a.map(e=>{e.type===i.ClauseType.Set?e.parts.forEach(e=>{R(e,t,s)}):R(e,t,s)}),l}return null}function R(e,t,s){if("1.1.0"===t&&!e.displayType)if(e.askForValueOptions){if(e.displayType=i.ClauseDisplayType.UseAskForValue,""!==e.askForValueOptions.label){const t=P(e,e.jimuFieldName?Object(i.Immutable)(s.getSchema().fields[e.jimuFieldName]):null,i.i18n.getIntl().formatMessage({id:D(e.operator)}));e.askForValueOptions.label===t&&(e.askForValueOptions.label=null),e.askForValueOptions.label=null}}else e.displayType=i.ClauseDisplayType.None}var L=s(1);class B extends i.React.PureComponent{constructor(e){super(e),this._setStateForDisplayUI=()=>{const e=this.props.fieldObj?this.props.fieldObj.type:null;this.setState({displayUI:this.getDisplayUI(e)})},this.getDisplayUI=e=>{let t="";switch(e){case i.JimuFieldType.Number:t="number";break;case i.JimuFieldType.String:case null:t="text"}return t},this.onNumberChange=e=>{const t=parseFloat(e.target.value),s=t+""!="NaN"?t:null;this.onChange(s)},this.onTextChange=e=>{const t=e.target.value;this.onChange(t+""!=""?t:null)},this.onChange=e=>{if(!this.props.fieldObj)return;const t=null!==e?[{value:e,label:e+""}]:null,s=Ve(this.props.value.sourceType,this.props.value.inputEditor,t);this.props&&this.props.onChange(s)},this.state={displayUI:null}}componentDidMount(){const e=this.props.fieldObj?this.props.fieldObj.type:null;this.setState({displayUI:this.getDisplayUI(e)})}componentDidUpdate(e,t){this.props.fieldObj===e.fieldObj&&this.props.value.sourceType===e.value.sourceType&&this.props.value.inputEditor===e.value.inputEditor||this._setStateForDisplayUI()}render(){var e;const t=this.props.runtime?void 0:"sm",s=c(this.props.isSmallSize||this.props.runtime).inputEditorWidth,a=(null===(e=this.props.value)||void 0===e?void 0:e.value)?this.props.value.value[0].value:"";return"number"===this.state.displayUI?i.React.createElement(L.NumericInput,{size:t,style:{width:s},showHandlers:!1,value:a,onBlur:this.onNumberChange,onPressEnter:this.onNumberChange}):i.React.createElement(L.TextInput,{size:t,style:{width:s},type:"text",value:a,onBlur:this.onTextChange,onKeyUp:this.onTextChange})}}var _=B;class q extends i.React.PureComponent{constructor(e){super(e),this.getSelectedFields=()=>{const e=this.props.value.value;return e?Object(i.Immutable)([e[0].value]):null},this.onChange=e=>{const t=e[0],s={value:t.jimuName,label:t.alias?t.alias:t.name},a=Ve(this.props.value.sourceType,this.props.value.inputEditor,[s]);this.props&&this.props.onChange(a)},this.state={FieldSelector:null,type:this.props.fieldObj.type}}componentDidMount(){this.__unmount=!1,i.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector").then(e=>{this.__unmount||this.setState({FieldSelector:e.FieldSelector})})}componentWillUnmount(){this.__unmount=!0}componentDidUpdate(e,t){this.props.fieldObj!==e.fieldObj&&this.setState({type:this.props.fieldObj.type})}render(){return this.state.FieldSelector?i.React.createElement("div",{style:{width:c(this.props.isSmallSize).inputEditorWidth}},i.React.createElement(this.state.FieldSelector,{types:Object(i.Immutable)([this.state.type]),dataSources:[this.props.dataSource],onChange:this.onChange,hiddenFields:Object(i.Immutable)([this.props.fieldObj.jimuName]),selectedFields:this.getSelectedFields(),isDataSourceDropDownHidden:!0,isSearchInputHidden:!0,useDropdown:!0,dropdownProps:{size:this.props.runtime?void 0:"sm"}})):null}}var z=q;class W extends i.React.PureComponent{constructor(e){super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:L.defaultMessages[e]}),this.onValue1Change=e=>{this.value1=parseFloat(e.target.value),this.onChange()},this.onValue2Change=e=>{this.value2=parseFloat(e.target.value),this.onChange()},this.onChange=()=>{const e=[],t=null!==this.value1&&this.value1+""!="NaN"?{value:this.value1,label:this.value1+""}:null,s=null!==this.value2&&this.value2+""!="NaN"?{value:this.value2,label:this.value2+""}:null;e.push(t),e.push(s);const a=Ve(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(a)}}render(){var e,t;const s=this.props.runtime?void 0:"sm";this.value1=(null===(e=this.props.value)||void 0===e?void 0:e.value)&&this.props.value.value[0]?this.props.value.value[0].value:null,this.value2=(null===(t=this.props.value)||void 0===t?void 0:t.value)&&this.props.value.value[1]?this.props.value.value[1].value:null;const a=c(!1);return i.React.createElement("div",{className:Object(i.classNames)(this.props.className,"double-number-picker d-flex")},i.React.createElement(L.NumericInput,{size:s,style:{width:a.inputEditorWidth},value:this.value1,showHandlers:!1,onBlur:this.onValue1Change,onPressEnter:this.onValue1Change}),i.React.createElement("div",{className:"double-input-connector",style:{width:a.connectorWidth}},this.i18nMessage("andLowerCase")),i.React.createElement(L.NumericInput,{size:s,style:{width:a.inputEditorWidth},value:this.value2,showHandlers:!1,onBlur:this.onValue2Change,onPressEnter:this.onValue2Change}))}}var H=i.themeUtils.withStyles(Object(i.injectIntl)(W),"VIDoubleNumberSelector"),K=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(e);l<a.length;l++)t.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(s[a[l]]=e[a[l]])}return s};class J extends i.React.PureComponent{constructor(e){super(e),this.onValueChange=e=>{const t=Ve(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(t)},this.state={}}render(){const e=this.props.value&&this.props.value.value?this.props.value.value:Object(i.Immutable)([]),t=this.props,{value:s,fieldObj:a}=t,l=K(t,["value","fieldObj"]);return i.React.createElement("div",{style:{width:c(this.props.isSmallSize||this.props.runtime).inputEditorWidth}},i.React.createElement(L.AdvancedSelect,Object.assign({},l,{field:this.props.fieldObj,values:e,isMultiple:this.props.isMultiple,allTag:"allDynamicTag",appendToBody:!!this.props.runtime,strategy:this.props.runtime?"absolute":"fixed",fluid:!0,size:this.props.runtime?void 0:"sm",onChange:this.onValueChange})))}}var $=J;class Q extends i.React.PureComponent{constructor(e){var t;super(e),this.getDataSource=()=>this.dsManager.createLocalDataSource(this.props.dataSource,this.localDsRandomId),this.isMultiple=()=>this.props.value.sourceType===i.ClauseSourceType.MultipleSelectFromUnique,this.i18nMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:L.defaultMessages[e]},t),this.updateList=(e=this.props.fieldObj)=>{this._isMounted&&!this.props.codedValues&&e&&i.dataSourceUtils.queryValueLabelsByFieldAndPageSize(e,this.dataSource,100,this.props.intl,this.props.sql,this.context.scope,this.context.widgetId).then(e=>{this._isMounted&&this.setState({list:e.list,listWithSetValues:this.getListWithSetValues(e.list)})})},this.getListWithSetValues=e=>{var t;const s=(null===(t=this.props.value)||void 0===t?void 0:t.value)||[],a=e.concat(s).sort((e,t)=>{var s;return null===(s=e.label)||void 0===s?void 0:s.localeCompare(t.label)});return a.forEach((e,t)=>{var s;e.value===(null===(s=a[t+1])||void 0===s?void 0:s.value)&&a.splice(t,1)}),a},this.getDisplayLabel=e=>{let t="";const s=e.value||[],a=s.length;return t=this.isMultiple()?this.i18nMessage("numSelected",{number:a}):a?s[0].label:this.i18nMessage("allTag"),t},this.onTogglePopper=()=>{setTimeout(()=>this.setState({isOpen:!this.state.isOpen}),100)},this.isPillActive=e=>{var t;return!!((null===(t=this.props.value)||void 0===t?void 0:t.value)?this.props.value.value:[]).filter(t=>t.value===e).length},this.onPillClick=(e,t)=>{var s;const a=t.target.className.indexOf("active")<0;if(!this.isMultiple()&&!a)return;let l=a?[e]:[];this.isMultiple()?null===(s=this.props.value.value)||void 0===s||s.map(t=>{(a||!a&&e.value!==t.value)&&l.push({value:t.value,label:t.label})}):(this.setState({isOpen:!1}),l.length&&l[0].value===i.EMPTY_OPTION_VALUE&&(l=[])),l=l.length?l:null;const r=Ve(this.props.value.sourceType,this.props.value.inputEditor,l);this.props&&this.props.onChange(r)},this.onDisplayChange=e=>{const t=Ve(this.props.value.sourceType,e,this.props.value.value);this.props&&this.props.onChange(t)},this.getPills=e=>{const t=this.i18nMessage("allTag");return i.React.createElement("div",{className:"pill-btn-container"},!this.isMultiple()&&i.React.createElement(L.Button,{className:"pill-btn",size:this.props.runtime?void 0:"sm",value:i.EMPTY_OPTION_VALUE,active:null===this.props.value.value,onClick:e=>this.onPillClick({value:i.EMPTY_OPTION_VALUE,label:t},e)},t),e.map((e,t)=>{if(null!==e.value){const s=0===(this.props.codedValues||this.state.list).filter(t=>t.value===e.value).length,a=this.isPillActive(e.value);return i.React.createElement(L.Button,{className:Object(i.classNames)("pill-btn",{"pill-dash-btn":s&&a}),size:this.props.runtime?void 0:"sm",key:t,value:e.value,active:a,onClick:t=>this.onPillClick(e,t)},e.label)}}))},Q.count++,this.dsManager=i.DataSourceManager.getInstance(),this.localDsRandomId=Y(),this.dataSource=this.getDataSource(),this.state={list:[],listWithSetValues:(null===(t=this.props.value)||void 0===t?void 0:t.value)||[],isOpen:!1},this._isMounted=!0}componentDidMount(){this.updateList()}componentWillUnmount(){this._isMounted=!1,this.dsManager.destroyDataSource(this.dataSource.id)}componentDidUpdate(e){this.props.fieldObj!==e.fieldObj||this.props.codedValues!==e.codedValues||this.props.sql!==e.sql?this.updateList():this.props.datasourceInfo!==e.datasourceInfo||this.props.datasourceBelongInfo!==e.datasourceBelongInfo?(this.dataSource=this.getDataSource(),this.updateList()):this.props.value!==e.value&&this.setState({listWithSetValues:this.getListWithSetValues(this.state.list)})}render(){const{className:e,codedValues:t,value:a,runtime:l}=this.props,r=this.getDisplayLabel(a);let o=t||this.state.listWithSetValues;return o.length>20&&(o=o.slice(0,20)),i.React.createElement("div",{className:Object(i.classNames)(e,"h-100")},l?i.React.createElement("div",{className:"pill-runtime-container"},this.getPills(o)):i.React.createElement("div",{className:"h-100 d-flex"},i.React.createElement(L.Button,{size:"sm",className:"pill-selector-button h-100",type:"default",ref:e=>this.pillButton=e,title:r,style:{width:c(this.props.isSmallSize||l).inputEditorWidth,justifyContent:this.isMultiple()||null!==a.value?"space-between":"flex-end"},onClick:this.onTogglePopper},i.React.createElement("div",{className:"pill-display-label"},r),i.React.createElement(L.Icon,{icon:s(60),size:"8"})),i.React.createElement(L.Popper,{open:this.state.isOpen,toggle:this.onTogglePopper,className:e,showArrow:!0,reference:this.pillButton},i.React.createElement("div",{className:"pill-selector-popper"},i.React.createElement("div",{className:"pill-setting-container"},this.getPills(o))))))}}Q.contextType=L.QueryScopeContext,Q.count=-1;const Y=()=>"PILL_SELECT-"+Q.count,G=i.ReactRedux.connect((e,t)=>{const s=window.jimuConfig.isBuilder?e.appStateInBuilder:e;return s&&t.dataSource?{datasourceInfo:s.dataSourcesInfo[t.dataSource.id]||null,datasourceBelongInfo:t.dataSource.isDataView?s.dataSourcesInfo[t.dataSource.belongToDataSource.id]:null}:{datasourceInfo:null,datasourceBelongInfo:null}})(Q);var X=i.themeUtils.withStyles(Object(i.injectIntl)(G),"VIPillSelector");class Z extends i.React.PureComponent{constructor(e){super(e),this.getInputEditor=e=>{let t="";switch(e){case r.DatePicker:case r.DoubleDatePicker:t="date";break;case r.DateTimePicker:case r.DoubleDateTimePicker:t="datetime";break;default:t=null}return t},this.getFormatedValue=()=>{let e;if(this.state.displayUI&&this.props.value&&this.props.value.value){const t=new Date(this.props.value.value[0].value),s=i.dataSourceUtils.getLocalTimes(t),a=new Date(s);if(!this.state.displayUI.includes("time")&&0!==a.getHours())return this.onChange(s),null;e=a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2),this.state.displayUI.includes("time")&&(e=e+"T"+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2)),e=new Date(e)}return e||new Date},this.checkIfTimezoneChanged=()=>{let e=!1;if(this.state.displayUI&&this.props.value&&this.props.value.value){const t=new Date(this.props.value.value[0].value),s=i.dataSourceUtils.getLocalTimes(t),a=new Date(s);this.state.displayUI.includes("time")||0===a.getHours()||(this.onChange(t.getTime()),e=!0)}return e},this.onChange=(e,t)=>{const s=e?[{value:e,label:t||""}]:null,a=Ve(this.props.value.sourceType,this.props.value.inputEditor,s);this.props&&this.props.onChange(a)},this.state={DatePicker:null,displayUI:null}}componentDidMount(){this.__unmount=!1,i.moduleLoader.loadModule("jimu-ui/basic/date-picker").then(e=>{this.__unmount||(this.props.value.inputEditor?this.setState({DatePicker:e.DatePicker,displayUI:this.getInputEditor(this.props.value.inputEditor)}):this.setState({DatePicker:e.DatePicker}))})}componentWillUnmount(){this.__unmount=!0}componentDidUpdate(e,t){this.__unmount||this.props.fieldObj===e.fieldObj&&this.props.value.sourceType===e.value.sourceType&&this.props.value.inputEditor===e.value.inputEditor||this.setState({displayUI:this.getInputEditor(this.props.value.inputEditor)})}render(){var e,t,s;if(!this.state.DatePicker)return null;let a=null,l=null===(t=null===(e=this.props.fieldObj)||void 0===e?void 0:e.format)||void 0===t?void 0:t.dateFormat,r=!1,o=!1,n=!1;if(this.state.displayUI){if(null===(s=this.props.value)||void 0===s?void 0:s.value){const e=this.props.value.value[0].value;"string"==typeof e?a=e:(a=new Date(e),r=!0)}"date"===this.state.displayUI?l?l.indexOf("Time")>0&&(l=l.split("24")[0].split("ShortTime")[0].split("LongTime")[0]):l=i.dateUtils.DATE_TIME_DEFAULT_FORMAT.date:"datetime"===this.state.displayUI&&(o=!0,l?l.indexOf("Time")<0&&(l=l+" "+i.dateUtils.DATE_TIME_DEFAULT_FORMAT.time):l=i.dateUtils.DATE_TIME_DEFAULT_FORMAT.dateTime,l.indexOf("LongTime")>=0&&(n=!0))}return i.React.createElement(this.state.DatePicker,{style:this.props.style||{width:c(this.props.isSmallSize||this.props.runtime).inputEditorWidth},strategy:this.props.runtime?"absolute":"fixed",disablePortal:!this.props.runtime,selectedDate:a,showTimeInput:o,isTimeLong:n,isUTCDate:r,format:l,runtime:this.props.runtime,supportVirtualDateList:!this.props.runtime,hasDoneButton:!0,onChange:(e,t)=>this.onChange(e,t)})}}var ee=Z;const te=[i.dateUtils.VirtualDateType.ThisWeek,i.dateUtils.VirtualDateType.ThisMonth,i.dateUtils.VirtualDateType.ThisQuarter,i.dateUtils.VirtualDateType.ThisYear];class se extends i.React.PureComponent{constructor(e){super(e),this.onValueChange=(e,t)=>{const s=e.target.value;let a=null;""!==s&&(a=[{value:s,label:t.props.label}]);const l=Ve(this.props.value.sourceType,this.props.value.inputEditor,a);this.props&&this.props.onChange(l)},this.stopPropagation=e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.state={}}render(){const e=this.props.value&&this.props.value.value?this.props.value.value[0].value:"";return i.React.createElement(L.Select,{size:this.props.runtime?void 0:"sm",style:{width:c(this.props.isSmallSize||this.props.runtime).inputEditorWidth},value:e,onChange:this.onValueChange,menuProps:{onClick:this.stopPropagation}},i.React.createElement("option",{key:0,value:"",label:""}," "),te.map((e,t)=>{const s=D(e),a=this.props.intl.formatMessage({id:s,defaultMessage:L.defaultMessages[s]});return i.React.createElement("option",{key:t,value:e,label:a},a)}))}}var ae=Object(i.injectIntl)(se);class le extends i.React.PureComponent{constructor(e){super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:L.defaultMessages[e]}),this.onChange=()=>{const e=(this.value1.value||[null]).concat(this.value2.value||[null]),t=Ve(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(t)}}render(){const e=this.props.value,t=(null==e?void 0:e.value)&&e.value[0]?[e.value[0]]:null,s=(null==e?void 0:e.value)&&e.value[1]?[e.value[1]]:null;this.value1=Ve(e.sourceType,e.inputEditor,t),this.value2=Ve(e.sourceType,e.inputEditor,s);const a=c(!1);return i.React.createElement("div",{className:Object(i.classNames)(this.props.className,"double-datetime-picker d-flex")},i.React.createElement(ee,{style:{width:a.inputEditorWidth},value:this.value1,fieldObj:this.props.fieldObj,runtime:this.props.runtime,onChange:e=>{this.value1=e,this.onChange()}}),i.React.createElement("div",{className:"double-input-connector",style:{width:a.connectorWidth}},this.i18nMessage("andLowerCase")),i.React.createElement(ee,{style:{width:a.inputEditorWidth},value:this.value2,fieldObj:this.props.fieldObj,runtime:this.props.runtime,onChange:e=>{this.value2=e,this.onChange()}}))}}var re=i.themeUtils.withStyles(Object(i.injectIntl)(le),"VIDoubleDateTimePicker");const ie=[i.dateUtils.TimeUnit.Minute,i.dateUtils.TimeUnit.Hour,i.dateUtils.TimeUnit.Day,i.dateUtils.TimeUnit.Week,i.dateUtils.TimeUnit.Month,i.dateUtils.TimeUnit.Year];class oe extends i.React.PureComponent{constructor(e){super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:L.defaultMessages[e]}),this.onUnitSelect=e=>{e!==this.unit&&(this.unit=e,this.onChange())},this.onChange=()=>{const e=[{value:this.value,label:this.unit}],t=Ve(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(t)},this.toggle=()=>{this.setState({isOpen:!this.state.isOpen})},this.state={isOpen:!1}}render(){const e=this.props.value.value[0];this.value=e.value?e.value:null,this.unit=e.label;const t=this.i18nMessage(D(this.unit)),a=c(this.props.isSmallSize||this.props.runtime,!0);return Object(i.jsx)("div",{className:"d-flex number-list-selector",style:{justifyContent:this.props.runtime?"space-between":"flex-start"}},Object(i.jsx)(L.NumericInput,{style:{width:a.inputEditorWidth},placeholder:this.i18nMessage("amount"),showHandlers:!1,value:this.value,onChange:e=>{this.value=e,this.onChange()},size:this.props.runtime?void 0:"sm"}),Object(i.jsx)(L.Dropdown,{className:"ml-1",style:{width:a.dropDownWidth},isOpen:this.state.isOpen,toggle:this.toggle,activeIcon:!0},Object(i.jsx)(L.DropdownButton,{type:"default",title:t,onClick:this.toggle,size:this.props.runtime?void 0:"sm",arrow:Object(i.jsx)(L.Icon,{icon:s(60),size:"8"})},t),Object(i.jsx)(L.DropdownMenu,{showArrow:!0},Object(i.jsx)(L.DropdownItem,{header:!0},this.i18nMessage("selectUnit")),ie.map((e,t)=>Object(i.jsx)(L.DropdownItem,{key:t,onClick:()=>{this.onUnitSelect(e)},active:this.unit===e},this.i18nMessage(D(e)))))))}}var ne=Object(i.injectIntl)(oe),ue=s(36),pe=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(e);l<a.length;l++)t.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(s[a[l]]=e[a[l]])}return s};const ce=s(218),de=s(61);class he extends i.React.PureComponent{constructor(e){super(e),this.externalDsStyle={maxWidth:"960px"},this.i18nMessage=e=>{const{intl:t}=this.props;return t?t.formatMessage({id:e,defaultMessage:L.defaultMessages[e]}):""},this.isDuplicated=()=>{},this.onSelectValueChange=e=>{null===e?this.onChange({value:i.EMPTY_OPTION_VALUE,label:null,alias:null}):this.onChange({value:e[0].value,label:e[0].label,alias:e[0].label})},this.onNumberValueBlur=e=>{const t=parseFloat(e.target.value),s=t+""!="NaN"?t:null;if(s===this.props.value.value)return;const a=null===s?null:s+"";this.onChange({value:s,label:a,alias:a})},this.onNumberValueKeyUp=()=>{this.numberValueInputRef.blur()},this.onStringValueBlur=e=>{const t=e.target.value.trim();let s=""!==t?t:null,a=s;t===this.i18nMessage("allTag")&&(s=i.EMPTY_OPTION_VALUE,a=null),s!==this.props.value.value&&this.onChange({value:s,label:t,alias:a})},this.onStringValueKeyUp=()=>{this.stringValueInputRef.blur()},this.onAliasBlur=e=>{let t=e.target.value.trim();this.props.value.value===i.EMPTY_OPTION_VALUE&&t===this.i18nMessage("allTag")&&(t=null),t!==this.props.value.alias&&(t=""!==t?t:this.props.value.alias,this.onChange({value:this.props.value.value,label:this.props.value.label,alias:t,selected:this.props.value.selected}))},this.onAliasKeyUp=e=>{this.aliasInputRef.blur(),this.aliasInputRef},this.onAliasChange=e=>{""===e.target.value.trim()&&this.setState({alias:""})},this.setSelected=()=>{this.onChange({value:this.props.value.value,label:this.props.value.label,alias:this.props.value.alias,selected:!this.props.value.selected})},this.onChange=e=>{var t;const s=null!==(t=e.selected)&&void 0!==t?t:this.props.value.selected;this.props&&this.props.onChange(this.props.index,Object(i.Immutable)({value:e.value,label:e.label,alias:e.alias,selected:s}))},this.deleteItem=()=>{this.props&&this.props.onChange(this.props.index,null)},this.toggleAdvancedSelect=()=>{this.setState({isOpen:!this.state.isOpen})},this.getItem=(e,t)=>{let s=!1;this.props.allValues.map((e,a)=>{if(null===t.value||e.value===t.value&&a<this.props.index)return s=!0,!0});const a=t.value===i.EMPTY_OPTION_VALUE,l=a?this.i18nMessage("allTag"):t.value,r=a&&null===this.state.alias?this.i18nMessage("allTag"):this.state.alias;return Object(i.jsx)(i.React.Fragment,null,Object(i.jsx)("div",{className:"d-flex justify-content-between ml-2"},Object(i.jsx)("div",{className:Object(i.classNames)("predefined-value",{"value-input-isValid":s})},this.state.isOpen?Object(i.jsx)(L.AdvancedSelect,Object.assign({},e,{field:this.props.field,appendToBody:!1,strategy:"fixed",values:[t],excludeValues:this.props.excludeValues,isEmptyOptionHidden:this.props.isMultiple,isOpen:this.state.isOpen,toggle:this.toggleAdvancedSelect,fluid:!0,size:"sm",onChange:this.onSelectValueChange})):Object(i.jsx)(L.InputGroup,null,this.props.field.type===i.JimuFieldType.Number?Object(i.jsx)(L.NumericInput,{size:"sm",showHandlers:!1,disabled:a,value:l,onBlur:this.onNumberValueBlur,onPressEnter:this.onNumberValueKeyUp}):Object(i.jsx)(L.TextInput,{type:"text",size:"sm",ref:e=>this.stringValueInputRef=e,disabled:a,value:l||"",onBlur:this.onStringValueBlur,onKeyUp:this.onStringValueKeyUp}),Object(i.jsx)(L.InputGroupAddon,{addonType:"append"},Object(i.jsx)(L.Button,{onClick:()=>this.setState({isOpen:!0}),size:"sm",className:"border-left-0",type:"default",icon:!0},Object(i.jsx)(L.Icon,{icon:de,size:8}))))),Object(i.jsx)("div",{className:"predefined-label"},Object(i.jsx)(L.TextInput,{size:"sm",type:"text",value:null!=r?r:"",ref:e=>this.aliasInputRef=e,onBlur:this.onAliasBlur,onKeyUp:this.onAliasKeyUp,onChange:this.onAliasChange})),Object(i.jsx)("div",{className:"predefined-cbx"},this.props.isMultiple?Object(i.jsx)(L.Checkbox,{className:"mt-1",checked:t.selected,onChange:this.setSelected,"aria-label":null!=r?r:"","aria-checked":t.selected}):Object(i.jsx)(L.Radio,{style:{cursor:"pointer"},checked:t.selected,onChange:this.setSelected,"aria-label":null!=r?r:"","aria-checked":t.selected})),Object(i.jsx)("div",{className:"predefined-delete"},Object(i.jsx)(L.Button,{type:"tertiary",onClick:this.deleteItem,icon:!0,size:"sm",title:this.i18nMessage("delete"),"aria-label":this.i18nMessage("delete")},Object(i.jsx)(L.Icon,{size:12,icon:ce})))))},this.state={alias:this.props.value.alias,isOpen:!1}}componentDidUpdate(e,t){e.value.alias===this.props.value.alias&&t.alias===this.props.value.alias||this.setState({alias:this.props.value.alias})}render(){const e=this.props,{value:t,isMultiple:s}=e,a=pe(e,["value","isMultiple"]);return Object(i.jsx)("div",{className:"predefined-item"},this.getItem(a,t))}}var me=Object(i.injectIntl)(he),ve=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(e);l<a.length;l++)t.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(s[a[l]]=e[a[l]])}return s};const ge=s(88);class Se extends i.React.PureComponent{constructor(e){super(e),this.externalDsStyle={maxWidth:"960px"},this.i18nMessage=e=>{const{intl:t}=this.props;return t?t.formatMessage({id:e,defaultMessage:L.defaultMessages[e]}):""},this.addItem=()=>{const e=this.props.isMultiple||0!==this.props.values.length?{value:null,label:null,alias:null,selected:!1}:{value:i.EMPTY_OPTION_VALUE,label:null,alias:null,selected:!0},t=this.props.values.concat({value:e.value,label:e.label,alias:e.label,selected:e.selected});this.props.onChange(t)},this.onChange=(e,t)=>{const s=this.props.values.asMutable({deep:!0}),a=s[e].selected;let l=s.slice(0,e);t&&(l=l.concat(t)),l=l.concat(s.slice(e+1,s.length)),(null==t?void 0:t.selected)&&!this.props.isMultiple?l.map(e=>{e.selected&&e.value!==t.value&&(e.selected=!1)}):a&&null===t&&!this.props.isMultiple&&l[0]&&(l[0].selected=!0),this.props.onChange(Object(i.Immutable)(l))},this.createItemElement=(e,t,s)=>Object(i.jsx)(me,Object.assign({key:s,index:s,value:e,excludeValues:this.props.values.filter(t=>t.value!==e.value&&null!==t.value),allValues:this.props.values},t,{onChange:this.onChange})),this.state={}}render(){const e=this.props,{values:t,onChange:s}=e,a=ve(e,["values","onChange"]);return Object(i.jsx)("div",{className:"predefined-container"},Object(i.jsx)("div",{className:"d-flex justify-content-end"},Object(i.jsx)(L.Button,{size:"sm",onClick:()=>{this.addItem()},type:"default","aria-label":this.i18nMessage("add")},Object(i.jsx)(L.Icon,{icon:ge,className:"mr-1",size:12}),this.i18nMessage("add"))),Object(i.jsx)("div",{className:"predefined-list"},Object(i.jsx)("div",{className:"d-flex predefined-list-header pl-2"},Object(i.jsx)("div",{className:"d-flex justify-content-between"},Object(i.jsx)("div",{className:"predefined-value"},this.i18nMessage("value")),Object(i.jsx)("div",{className:"predefined-label"},this.i18nMessage("label")),Object(i.jsx)("div",{className:"predefined-cbx"},this.i18nMessage("default")),Object(i.jsx)("div",{className:"predefined-delete"}))),Object(i.jsx)("div",{className:"predefined-list-content"},Object(i.jsx)(ue.List,{className:"setting-ui-unit-list",itemsJson:this.props.values.asMutable({deep:!0}).map((e,t)=>({itemStateDetailContent:e,itemKey:""+t})),dndEnabled:!0,onDidDrop:(e,t)=>{const{itemJsons:[,s]}=t.props;this.props.onChange(Object(i.Immutable)(s.map(e=>e.itemStateDetailContent)))},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:ue.TreeItemActionType.RenderOverrideItem,children:[{name:ue.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:ue.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:ue.TreeItemActionType.RenderOverrideItemBody,children:[{name:ue.TreeItemActionType.RenderOverrideItemDragHandle},{name:ue.TreeItemActionType.RenderOverrideItemMainLine}]}]}]}]}),isItemFocused:()=>!1,renderOverrideItemMainLine:(e,t)=>{const{itemJsons:s}=t.props,l=s[0],r=s[1];return this.createItemElement(l.itemStateDetailContent,a,r.indexOf(l))}}))))}}var Oe=Object(i.injectIntl)(Se),fe=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(e);l<a.length;l++)t.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(s[a[l]]=e[a[l]])}return s};const ye=s(67);class Ce extends i.React.PureComponent{constructor(e){var t,s;super(e),this.externalDsStyle={maxWidth:"700px"},this.i18nMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:L.defaultMessages[e]},t),this.handleToggle=e=>{e&&this.setState({isOpen:!this.state.isOpen})},this.handleOkBtn=()=>{if(!this.isPredefinedValid())return void this.setState({isValid:!1});this.handleToggle(!0);const e=Ve(this.props.value.sourceType,this.props.value.inputEditor,this.state.value);this.props&&this.props.onChange(e)},this.isPredefinedValid=()=>{let e=!1;if(this.state.value){const t=this.state.value.asMutable({deep:!0}).map(e=>e.value).filter(e=>null!==e);e=Array.from(new Set(t)).length===this.state.value.length}return e},this.handleCancelBtn=()=>{var e,t;this.setState({isValid:!0,value:Object(i.Immutable)(null!==(t=null===(e=this.props.value)||void 0===e?void 0:e.value)&&void 0!==t?t:[])}),this.handleToggle(!0)},this.onSettingValueChange=e=>{this.setState({value:e,isValid:!0})},this.isValuesSet=()=>this.state.value.length>0,this.onValueChangeForRuntime=e=>{const t=e?e.map(e=>e.value):[i.EMPTY_OPTION_VALUE],s=this.state.value.asMutable({deep:!0});s.map(e=>{e.selected=t.includes(e.value)});const a=Ve(this.props.value.sourceType,this.props.value.inputEditor,s);this.props&&this.props.onChange(a)},this.getValuesForRuntime=e=>{const t=[];return e.forEach(e=>{const s=e.value===i.EMPTY_OPTION_VALUE&&null===e.alias?null:e.alias;t.push({value:e.value,label:s,selected:e.selected})}),{values:t.filter(e=>e.selected),codedValues:t}},this.state={isValid:!0,isOpen:!!e.isOpen,value:Object(i.Immutable)(null!==(s=null===(t=this.props.value)||void 0===t?void 0:t.value)&&void 0!==s?s:[])}}componentDidUpdate(e,t){var s,a;this.props.value!==e.value&&this.setState({value:Object(i.Immutable)(null!==(a=null===(s=this.props.value)||void 0===s?void 0:s.value)&&void 0!==a?a:[])})}render(){const e=this.props,{runtime:t,value:s,fieldObj:a,isMultiple:l,intl:r}=e,o=fe(e,["runtime","value","fieldObj","isMultiple","intl"]),n={width:c(this.props.isSmallSize||t).inputEditorWidth};if(t){const e=s&&s.value?s.value:Object(i.Immutable)([]),t=this.getValuesForRuntime(e),{codedValues:r}=o,u=fe(o,["codedValues"]);return i.React.createElement("div",{style:n},i.React.createElement(L.AdvancedSelect,Object.assign({},u,{field:a,isMultiple:l,values:t.values,codedValues:t.codedValues,isEmptyOptionHidden:!0,fluid:!0,onChange:this.onValueChangeForRuntime})))}const u=this.i18nMessage(l?"multiplePredefinedLabel":"uniquePredefinedLabel"),p=r.formatMessage({id:"ok",defaultMessage:i.defaultMessages.ok}),d=r.formatMessage({id:"cancel",defaultMessage:i.defaultMessages.cancel});return i.React.createElement("div",{style:n},i.React.createElement("div",{className:"w-100"},i.React.createElement(L.Button,{className:Object(i.classNames)("w-100 h-100 nowrap",{"frame-active":this.isValuesSet()}),type:"secondary",size:"sm",onClick:()=>this.handleToggle(!0),title:u,"aria-label":u},i.React.createElement("div",{className:"w-100 px-2 text-truncate"},u)),i.React.createElement(L.Modal,{backdrop:"static",centered:!0,isOpen:this.state.isOpen,toggle:()=>this.handleToggle(void 0),contentClassName:"border-0 h-100",className:this.props.className,style:this.externalDsStyle,returnfocusafterclose:"true",size:"lg"},i.React.createElement(L.ModalHeader,{tag:"h4",toggle:this.handleCancelBtn},u),i.React.createElement(L.ModalBody,null,i.React.createElement(Oe,Object.assign({},o,{field:a,values:this.state.value,isMultiple:l,onChange:this.onSettingValueChange}))),i.React.createElement(L.ModalFooter,null,i.React.createElement("div",{className:"m-0 w-100 d-block"},!this.state.isValid&&i.React.createElement("div",{className:"invalide-label"},i.React.createElement(L.Icon,{icon:ye,size:18,color:this.props.theme.colors.palette.danger[700],className:"mr-2"}),this.i18nMessage("predefinedValueInValidTip")),i.React.createElement("div",{className:"d-flex"},i.React.createElement(L.Button,{type:"primary",onClick:this.handleOkBtn,className:"ml-auto mr-2",style:{minWidth:"64px"},"aria-label":p},p),i.React.createElement(L.Button,{type:"secondary",onClick:this.handleCancelBtn,style:{minWidth:"64px"},"aria-label":d},d)))))))}}var Ie=i.themeUtils.withStyles(i.themeUtils.withTheme(Object(i.injectIntl)(Ce)),"VIPredefinedSelector");class be extends i.React.PureComponent{constructor(e){super(e)}render(){return i.React.createElement("div",null)}}var Ee=be;const Te={[r.TextInput]:_,[r.DoubleNumberSelector]:H,[r.FieldSelector]:z,[r.SimpleSelect]:$,[r.UniquePillWrapSelector]:X,[r.MultipleSelect]:$,[r.MultiplePillWrapSelector]:X,[r.UniquePredefinedSelector]:Ie,[r.MultiplePredefinedSelector]:Ie,[r.DatePicker]:ee,[r.DateTimePicker]:ee,[r.DateRangeSelector]:ae,[r.DoubleDatePicker]:re,[r.DoubleDateTimePicker]:re,[r.NumberListSelector]:ne,[r.BlankSelector]:Ee};function xe(e,t,s,a,l,o,n,u){const p=Te[e.inputEditor],c={value:e,fieldObj:t,dataSource:a,codedValues:l||null,runtime:o||!1,sql:n||null,isSmallSize:u},d=[r.MultipleSelect,r.MultiplePredefinedSelector].includes(e.inputEditor);return i.React.createElement(p,Object.assign({},c,{isMultiple:d,onChange:s}))}function je(e,t){e.getLayerDefinition();return e.getFieldCodedValueList(t)}function Ve(e,t,s,a){return{isValid:void 0===a||a,sourceType:e||i.ClauseSourceType.UserInput,inputEditor:t||r.TextInput,value:s||(t===r.NumberListSelector?[{value:null,label:i.dateUtils.TimeUnit.Day}]:null)}}function De(){return{type:i.ClauseType.Single,jimuFieldName:"",operator:null,valueOptions:Ve(null,null,null,!1),displayType:i.ClauseDisplayType.None,askForValueOptions:null,displayLabel:null}}function Fe(){const e=De(),t=De();return{type:i.ClauseType.Set,logicalOperator:i.ClauseLogic.And,parts:Object(i.Immutable)([e,t])}}function Ne(e,t){return T[e][t].supportCaseSensitive||!1}function Me(e,t){return T[e][t].supportAskForValue||!1}function Ue(e,t){return T[e][t].codedValueInputEditors||null}function ke(e,t,s){const a=i.ClauseSourceType.UserInput;return Ve(a,Pe(e,a,t,s)[0])}function we(e,t,s,a,l){const o={};let n=null,u=null,p=r.TextInput;const c=T[s];if(c){for(const e in c)o[e]=[],u=u||e;Object.keys(o).map(r=>{var c;n&&(a=null);const d=Pe(s,r,a,l);if(o[r]=d.inputEditorTypes,n=n||d.codedValues,r===u){const e=[i.ClauseOperator.DateOperatorIsOn,i.ClauseOperator.DateOperatorIsNotOn,i.ClauseOperator.DateOperatorIsBefore,i.ClauseOperator.DateOperatorIsAfter,i.ClauseOperator.DateOperatorIsOnOrBefore,i.ClauseOperator.DateOperatorIsOnOrAfter];p=d.inputEditorTypes[0],r===i.ClauseSourceType.UserInput&&(null===(c=t.format)||void 0===c?void 0:c.dateFormat)&&t.format.dateFormat.includes("Time")&&e.includes(s)&&(p=d.inputEditorTypes[1])}e===i.SqlExpressionMode.Simple&&(o[r]=[r===u?p:d.inputEditorTypes[0]],delete o[i.ClauseSourceType.SingleSelectFromPredefined],delete o[i.ClauseSourceType.MultipleSelectFromPredefined])})}else u=i.ClauseSourceType.UserInput,o[u]=[p];return{displayTypes:o,codedValues:n,defaultSourceType:u,defaultInputEditorType:p}}function Pe(e,t,s,a){t=t||i.ClauseSourceType.UserInput;const l=T[e];let o=[],n=null;if(l){const e=l[t];o=e.normalInputEditors,e.codedValueInputEditors&&s&&a&&(n=je(s,a),n&&n.length>0&&(o=e.codedValueInputEditors))}else o=[r.TextInput];return{inputEditorTypes:o,codedValues:n}}function Ae(e){let t=null;if("esriFieldTypeString"===e)t=i.JimuFieldType.String;else if("esriFieldTypeDate"===e)t=i.JimuFieldType.Date;else{["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].includes(e)&&(t=i.JimuFieldType.Number)}return t}function Re(e,t){return x(Ae(e),t)}class Le extends i.React.PureComponent{constructor(e){super(e),this._setStateForInputEditor=()=>{this.setState({inputEditor:xe(this.props.valueOptions,this.props.fieldObj,this.props.onChange,this.props.dataSource,this.props.codedValues,this.props.runtime,this.props.sql,this.props.isSmallSize)})},this.state={inputEditor:null}}componentDidMount(){this._setStateForInputEditor()}componentDidUpdate(e,t){this.props.fieldObj===e.fieldObj&&this.props.valueOptions===e.valueOptions&&this.props.codedValues===e.codedValues&&this.props.sql===e.sql&&this.props.isSmallSize===e.isSmallSize||this._setStateForInputEditor()}render(){return i.React.createElement("div",{className:"w-100 h-100"},this.state.inputEditor)}}const Be=Le;class _e extends i.React.PureComponent{constructor(e){super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:L.defaultMessages[e]}),this.getCodedValues=()=>{let e=null;if(this.props.clause.valueOptions.sourceType===i.ClauseSourceType.UserInput){e=Pe(this.props.clause.operator,this.props.clause.valueOptions.sourceType,this.props.dataSource,this.props.clause.jimuFieldName).codedValues}return e},this.onValueOptsChange=e=>{const t=Object.assign({},this.props.clause,{valueOptions:e});this.props&&this.props.onChange(t,this.props.id)},this.state={}}render(){this.fieldObj=Object(i.Immutable)(this.props.dataSource.getSchema().fields[this.props.clause.jimuFieldName]);const e=this.i18nMessage(D(this.props.clause.operator)),t=w(this.props.clause,this.fieldObj,e),{displayType:s,askForValueOptions:a}=this.props.clause,l=a&&a.hint;return Object(i.jsx)("div",{className:Object(i.classNames)("sql-expression-single",this.props.className,{"m-0":s===i.ClauseDisplayType.None})},s===i.ClauseDisplayType.UseAskForValue&&Object(i.jsx)(L.Label,{className:"mb-0 w-100"},Object(i.jsx)("div",{className:a.display===i.ClauseLabelDisplay.Inline&&""!==a.label?"clause-inline":"clause-block"},""!==a.label&&Object(i.jsx)("div",{className:"sql-expression-label"},t),Object(i.jsx)("div",{className:"sql-expression-input"},Object(i.jsx)(Be,{onChange:this.onValueOptsChange,dataSource:this.props.dataSource,codedValues:this.getCodedValues(),valueOptions:this.props.clause.valueOptions,fieldObj:this.fieldObj,runtime:!0,sql:F(this.props.expression,this.props.clause,this.props.id,this.props.dataSource)}))),l&&Object(i.jsx)("div",{className:"w-100 sql-expression-hint"},l)),s===i.ClauseDisplayType.UseLabel&&Object(i.jsx)("div",{className:"w-100 sql-expression-displaylabel"},t))}}var qe=i.themeUtils.withStyles(Object(i.injectIntl)(_e),"SqlExpressionClauseRuntime");class ze extends i.React.PureComponent{constructor(e){super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:L.defaultMessages[e]}),this.onClauseChange=(e,t)=>{const s=V(this.state.partsArray,e,t),a=0===this.state.partsArray.length?null:{type:i.ClauseType.Set,logicalOperator:this.props.clauseSet.logicalOperator,parts:s};this.props.onChange&&this.props.onChange(a,this.props.id),this.setState({partsArray:s})},this.state={partsArray:this.props.clauseSet&&this.props.clauseSet.parts?this.props.clauseSet.parts:Object(i.Immutable)([])}}componentDidUpdate(e,t){this.props.clauseSet!==e.clauseSet&&this.setState({partsArray:this.props.clauseSet.parts})}render(){return Object(i.jsx)("div",{className:this.props.className?this.props.className:""},0===this.state.partsArray.length?null:Object(i.jsx)("div",{className:"sql-expression-set"},this.state.partsArray.map((e,t)=>{const s=this.props.id+"_clause_"+t;return e.displayLabel!=i.ClauseDisplayType.None&&Object(i.jsx)(qe,{key:t.toString(),id:s,clause:e,isHosted:this.props.isHosted,expression:this.props.expression,dataSource:this.props.dataSource,onChange:this.onClauseChange})})))}}var We=i.themeUtils.withStyles(Object(i.injectIntl)(ze),"SqlExpressionClauseSetRuntime");class He extends i.React.PureComponent{constructor(e){var t;super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:L.defaultMessages[e]}),this.onChange=(e,t)=>{const s=V(this.props.expression.parts,e,t);let a=Object(i.Immutable)({sql:this.props.expression.sql,displaySQL:this.props.expression.displaySQL,logicalOperator:this.props.expression.logicalOperator,parts:s.asMutable({deep:!0})});const l=i.dataSourceUtils.getArcGISSQL(a,this.props.dataSource);a=a.set("sql",l.sql).set("displaySQL",l.displaySQL),this.props.onChange&&this.props.onChange(a)};const s=this.props.dataSource;s&&(this.isHosted=i.dataSourceUtils.isHostedService(s.getDataSourceJson().url||(null===(t=s.layer)||void 0===t?void 0:t.url))),this.state={}}render(){return Object(i.jsx)("div",{className:this.props.className?this.props.className:""},Object(i.jsx)(L.QueryScopeContext.Provider,{value:{scope:this.props.queryScope||i.QueryScope.InRuntimeView,widgetId:this.props.widgetId}},Object(i.jsx)("div",{style:this.props.style,className:"sql-expression-builder"},this.props.expression?Object(i.jsx)("div",{className:"sql-expression-container"},0===this.props.expression.parts.length?Object(i.jsx)("div",{className:"no-data-tip"},this.i18nMessage("noClauseTip")):this.props.expression.parts.map((e,t)=>e.type===i.ClauseType.Single?(e=e).displayLabel!=i.ClauseDisplayType.None&&Object(i.jsx)(qe,{key:t,id:"clause_"+t,expression:this.props.expression,clause:e,isHosted:this.isHosted,dataSource:this.props.dataSource,onChange:this.onChange}):Object(i.jsx)(We,{key:t,id:"clauseset_"+t,expression:this.props.expression,clauseSet:e,isHosted:this.isHosted,dataSource:this.props.dataSource,onChange:this.onChange}))):Object(i.jsx)("div",{className:"no-data-tip"},this.i18nMessage("noAddedDataSourceCanBeUsed")))))}}var Ke=i.themeUtils.withStyles(Object(i.injectIntl)(He),"SqlExpressionRuntime");i.ThemeManager.getInstance().registerJimuThemeStyleModule("jimu-ui/basic/sql-expression-runtime/",{componentStyles:a})}}))}}}));