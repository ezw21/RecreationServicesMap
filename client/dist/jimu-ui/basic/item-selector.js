System.register(["jimu-core","jimu-ui"],(function(e){var t,i;return{setters:[function(e){t=e},function(e){i=e}],execute:function(){e(function(e){var t={};function i(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(s,o,function(t){return e[t]}.bind(null,o));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=989)}({0:function(e,i){e.exports=t},1:function(e,t){e.exports=i},241:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 6A5 5 0 111 6a5 5 0 0110 0zm1 0A6 6 0 110 6a6 6 0 0112 0zM8.046 4.146l-3.01 3.01-1.182-1.181a.5.5 0 10-.708.707l1.182 1.182a1 1 0 001.415 0l3.01-3.01a.5.5 0 10-.707-.708z" fill="#000"></path></svg>'},242:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.003 2.404l.778.778a.5.5 0 10.707-.707L2.367.353a.5.5 0 10-.707.708l.63.63A4.481 4.481 0 001.306 4.5c0 .515.087 1.01.246 1.47a9.794 9.794 0 001.014-.144 3.49 3.49 0 01-.26-1.326c0-.786.26-1.512.697-2.096zM5.806 1c-.397 0-.778.066-1.134.188L3.905.42A4.483 4.483 0 015.806 0c1.477 0 2.787.711 3.608 1.81-.23.26-.465.507-.702.738A3.497 3.497 0 005.806 1zM4.045 7.525c-.442.126-.87.223-1.275.296a4.483 4.483 0 002.536 1.152V11h-1.5a.5.5 0 000 1h4a.5.5 0 000-1h-1.5V8.973a4.5 4.5 0 003.951-5.14c-.314.316-.634.609-.957.881a3.5 3.5 0 01-5.255 2.811zm7.349-6.307a.49.49 0 01.123.691C8.061 6.64 3.267 7.812.805 7.781a.47.47 0 01-.453-.523.537.537 0 01.543-.476c2.198.003 6.593-1.072 9.797-5.438a.514.514 0 01.702-.126z" fill="#000"></path></svg>'},243:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 2s-2.266-.168-3-.5c-.385-.174-.628-.478-.86-.767C6.837.353 6.554 0 6 0c-.554 0-.837.353-1.14.733-.232.289-.475.593-.86.767-.734.332-3 .5-3 .5s.077 3.846 1 6c.87 2.03 4 4 4 4s3.13-1.97 4-4c.923-2.154 1-6 1-6zm-5 8.791c.282-.2.647-.474 1.032-.796.875-.733 1.713-1.606 2.049-2.389.4-.932.638-2.306.771-3.522.048-.44.081-.845.103-1.18A16.061 16.061 0 018.584 2.7c-.326-.065-.701-.155-.996-.289-.626-.283-1.032-.8-1.25-1.078a5.88 5.88 0 00-.078-.1C6.046.974 6.012.994 6.002 1L6 1 5.998.999c-.01-.006-.044-.025-.258.235a5.88 5.88 0 00-.079.1c-.217.276-.623.794-1.249 1.077-.295.134-.67.224-.996.288a16.061 16.061 0 01-1.371.204c.022.336.055.74.103 1.18.133 1.217.372 2.591.771 3.523.336.783 1.174 1.656 2.05 2.389.384.322.749.595 1.031.796z" fill="#000"></path></svg>'},244:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 2s-2.266-.168-3-.5c-.385-.174-.628-.478-.86-.767C6.837.353 6.554 0 6 0c-.554 0-.837.353-1.14.733-.232.289-.475.593-.86.767-.734.332-3 .5-3 .5s.077 3.846 1 6c.87 2.03 4 4 4 4s.1-.063.268-.177c.118-.08.27-.186.445-.313a3.5 3.5 0 003.916-5.788C10.963 3.862 11 2 11 2zM9.701 5.212a20.86 20.86 0 00.151-1.128 27.11 27.11 0 00.103-1.18A16.025 16.025 0 018.584 2.7c-.326-.065-.701-.156-.996-.289-.626-.283-1.032-.8-1.25-1.078a.732.732 0 00-.279-.312C6.02.989 6.008.996 6.003.999L6 1 5.998.999a.018.018 0 00-.011-.003c-.013.001-.037.012-.088.061a2.08 2.08 0 00-.159.177 6.516 6.516 0 00-.079.1c-.217.276-.623.794-1.249 1.077-.295.133-.67.224-.996.288a12.392 12.392 0 01-.786.13 18.563 18.563 0 01-.585.074c.022.336.055.74.103 1.18.133 1.217.372 2.591.771 3.523.336.783 1.174 1.655 2.05 2.389.197.165.388.317.567.453l.118.09a3.5 3.5 0 014.047-5.326zM11 8.5a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" fill="#000"></path></svg>'},245:function(e,t){e.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 3.5a1 1 0 11-2 0 1 1 0 012 0zM5 5.5a.5.5 0 000 1h.5v2H5a.5.5 0 000 1h2a.5.5 0 000-1h-.5v-3H5z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M12 6A6 6 0 110 6a6 6 0 0112 0zm-1 0A5 5 0 111 6a5 5 0 0110 0z" fill="#000"></path></svg>'},77:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M.304 6.016a1.028 1.028 0 011.466 0l4.398 4.451 8.062-8.16a1.028 1.028 0 011.466 0c.405.41.405 1.074 0 1.484l-8.795 8.902c-.405.41-1.062.41-1.466 0L.304 7.5a1.058 1.058 0 010-1.484z" fill="#000"></path><path d="M0 0h16v16H0z"></path></g></svg>'},989:function(e,t,i){"use strict";i.r(t),i.d(t,"ItemSelector",(function(){return A})),i.d(t,"ItemDetail",(function(){return S})),i.d(t,"DataBadge",(function(){return x})),i.d(t,"ItemCategory",(function(){return M})),i.d(t,"ItemTypes",(function(){return a.SupportedItemTypes})),i.d(t,"SortField",(function(){return D})),i.d(t,"SortOrder",(function(){return k})),i.d(t,"itemSelectorUtils",(function(){return o}));var s={};i.r(s),i.d(s,"ItemSelector",(function(){return r})),i.d(s,"ItemDetail",(function(){return l})),i.d(s,"DataBadge",(function(){return n}));var o={};i.r(o),i.d(o,"getDsJsonFromItem",(function(){return p}));var a=i(0);function r(e){const t=e.theme;return a.css`
    .modal-dialog{
      max-width: auto;
    }

    .mt-13{
      margin-top: ${a.polished.rem(13)};
    }

    .ds-thumbnail{
      width:  ${a.polished.rem(18)};
      height:  ${a.polished.rem(18)};
      background-color: ${t.colors.palette.info[400]};
    }

    .ds-type{
      font-size: ${a.polished.rem(13)};
      color: ${t.colors.palette.dark[800]};
      max-width: ${a.polished.rem(168)};
    }

    .item-selector{
      width: 100%;
      height: 100%;
      padding: 0;
      position: relative;

      .item-list-container{
        overflow-x: auto;
        overflow-y: auto;
        padding-top: 0.25rem;
        height: calc(100% - ${a.polished.rem(100)});
      }

      .item-border-color-cyan{
        border: ${a.polished.rem(2)} solid ${t.colors.palette.primary[700]} !important;
      }

      @media only screen and (max-width: 1210px){
        .item-list{
          width: 540px;
        }
      }

      @media only screen and (min-width: 1210px){
        .item-list{
          width: 810px;
        }
      }

      @media only screen and (min-width: 1480px){
        .item-list{
          width: 1080px;
        }
      }

      @media only screen and (min-width: 1750px){
        .item-list{
          width: 1350px;
        }
      }

      @media only screen and (min-width: 2020px){
        .item-list{
          width: 1620px;
        }
      }

      @media only screen and (min-width: 2290px){
        .item-list{
          width: 1890px;
        }
      }

      @media only screen and (min-width: 2560px){
        .item-list{
            width: 2160px;
        }
      }

      @media only screen and (min-width: 2830px){
        .item-list{
            width: 2430px;
        }
      }

      @media only screen and (min-width: 3100px){
        .item-list{
            width: 2700px;
        }
      }

      .item-list{
        display: flex;
        flex-wrap: wrap;
        margin-left: -0.5rem;
        margin-right: -0.5rem;
        overflow: visible;
        min-width: ${a.polished.rem(540)};

        .item{
          width: ${a.polished.rem(240)};
          margin: 0 ${a.polished.rem(15)} ${a.polished.rem(30)} ${a.polished.rem(15)};

          .two-line-truncate{
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            word-break: break-word;
            word-wrap: break-word;
          }

          .item-active-border-transparent{
            border: ${a.polished.rem(2)} solid transparent;

            &:hover{
              border-color: ${t.colors.palette.primary[700]};
            }
          }

          .item-card-container.item-border-transparent{
            border: ${a.polished.rem(1)} solid transparent;
          }

          .item-card-container{
            padding-bottom: 122%;
            position: relative;
            overflow: hidden;

            &:hover{
              border-color: transparent !important;
            }

            .mt-10{
              margin-top: 10px;
            }

            .item-card{
              position: absolute;
              background-color: ${t.colors.secondary};

              .item-info-container{
                padding: ${a.polished.rem(12)};
              }

              .item-icon{
                cursor: pointer;
                width: ${a.polished.rem(50)};
                margin-right: -4px;
              }

              .item-sub-label{
                width: 80%;
                max-height: ${a.polished.rem(58)};
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
              }

              .item-label{
                font-size: ${a.polished.rem(16)};
                line-height: ${a.polished.rem(20)};
                color: ${t.colors.palette.dark[800]};
                height: ${a.polished.rem(40)};
              }

              .item-sub-label{
                font-size: ${a.polished.rem(13)};
                color: ${t.colors.palette.dark[600]};
              }

              .item-thumbnail{
                background-size: 100% 100%;
                background-position: top center;
                cursor: pointer;
                height: 56%;
              }

              .item-badge-container{
                position: absolute;
                top: ${a.polished.rem(8)};
                left: ${a.polished.rem(8)};
              }

              .item-active-icon, .item-part-active-icon{
                position: absolute;
                top: -2px;
                right: -2px;

                .item-active-icon-container, .item-part-active-icon-container{
                  width: ${a.polished.rem(26)};
                  height: ${a.polished.rem(26)};
                  line-height: ${a.polished.rem(26)};
                  color: ${t.colors.secondary};
                  background-color: ${t.colors.palette.primary[700]};
                }

                .item-part-active-icon-container{
                  padding: ${a.polished.rem(3)};
                }

              }

              .item-part-active-icon-container{
                .item-part-active-icon-innerbox{
                  width: ${a.polished.rem(18)};
                  height: ${a.polished.rem(18)};
                  background-color: ${t.colors.palette.secondary[300]};
                  >div{
                    width: ${a.polished.rem(10)};
                    height: ${a.polished.rem(10)};
                    border-radius: ${a.polished.rem(1)};
                    background-color: ${t.colors.palette.primary[700]};
                  }
                }
              }
            }
          }
        }
      }

    }

  `}function l(e){const t=e.theme;return a.css`
  .component-item-detail{
    background: ${t.colors.palette.light[300]};
    overflow: auto;
    padding: 0 16px 16px 16px;
    border-left: 1px solid ${t.colors.palette.light[800]};
    border-right: 1px solid ${t.colors.palette.light[800]};
    .ml-12{
      margin-left: ${a.polished.rem(12)};
    }
    .container-fluid{
      padding: 0 !important;
    }
    z-index: 3;
    font-size: ${a.polished.rem(14)};
    .small-text{
      font-size: ${a.polished.rem(13)};
    }
    .html-container{
      *{
        color: ${t.colors.black} !important;
        font-size: ${a.polished.rem(14)} !important;
        font-weight: normal !important;
        font-family: inherit !important;
        background: ${t.colors.palette.light[300]} !important;
      }
    }
    .item-header{
      height: 41px;
      border-bottom: 1px solid ${t.colors.palette.light[800]};
      height: ${a.polished.rem(45)};
      margin-left: -16px;
      margin-right: -16px;
      .item-header-title{
        font-size: 16px;
        line-height: 41px;
      }
    }
    .item-close{
      cursor: pointer;
      margin-right: -4px;
    }
    .item-img{
      img{
        width: 100%;
      }
    }
    .item-line{
      width: 100%;
      height: 1px;
      border-bottom: 1px solid ${t.colors.palette.light[800]};
    }
    .item-detial-title, .item-detial-title:hover, .item-detial-title:focus, .item-detial-title:active{
      outline: none;
      box-shadow: 0 0 0 !important;
      border: 0 !important;
      font-size: 16px;
      white-space: normal !important;
      color: ${t.colors.black};
      .item-detial-title-text{
        max-width: 290px;
      }
    }

    .ds-thumbnail{
      width:  ${a.polished.rem(18)};
      height:  ${a.polished.rem(18)};
      background-color: ${t.colors.palette.info[400]};
    }

    .ds-type{
      font-size: ${a.polished.rem(13)};
      color: ${t.colors.palette.dark[800]};
      max-width: ${a.polished.rem(168)};
    }
  }

  `}function n(e){const t=e.theme;return a.css`
    .badge{
      width: ${a.polished.rem(18)};
      height: ${a.polished.rem(18)};
      border-radius: ${a.polished.rem(9)};
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 2px;
      svg{
        color: ${t.colors.black};
      }
    }

    .auth{
      background-color: ${t.colors.palette.success[300]};
    }

    .living-atlas, .primium, .subscriber{
      background-color: ${t.colors.palette.info[500]};
    }

  `}var c=i(1);function p(e,t){var i;if(!e)return null;let s;const o=a.dataSourceUtils.fixLayerId(e.title||e.id);if(e.type===a.SupportedItemTypes.WebMap)s=Object(a.Immutable)({id:o,type:null==t?void 0:t.WebMap});else if(e.type===a.SupportedItemTypes.WebScene)s=Object(a.Immutable)({id:o,type:null==t?void 0:t.WebScene});else if(e.type===a.SupportedItemTypes.FeatureCollection){s=(null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Singlelayer"))?Object(a.Immutable)({id:o,type:a.DataSourceTypes.FeatureLayer}):Object(a.Immutable)({id:o,type:a.DataSourceTypes.GroupLayer})}else{const t=e.url;if(t)if(a.dataSourceUtils.isSupportedWholeService(t)){const e=a.dataSourceUtils.getDsTypeFromWholeServiceUrl(t);s=Object(a.Immutable)({id:o,type:e})}else if(a.dataSourceUtils.isSupportedSingleLayerService(t)){const e=a.dataSourceUtils.getFullServiceUrl(t,!1);let i;switch(a.dataSourceUtils.getDsTypeFromWholeServiceUrl(e)){case a.DataSourceTypes.FeatureService:case a.DataSourceTypes.MapService:i=a.DataSourceTypes.FeatureLayer;break;case a.DataSourceTypes.SceneService:i=a.DataSourceTypes.SceneLayer}i&&(s=Object(a.Immutable)({id:o,type:i}))}}return s}var d=function(e,t,i,s){return new(i||(i=Promise))((function(o,a){function r(e){try{n(s.next(e))}catch(e){a(e)}}function l(e){try{n(s.throw(e))}catch(e){a(e)}}function n(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}n((s=s.apply(e,t||[])).next())}))};const m=i(241),h=i(242),u=i(243),g=i(244),f={};class v extends a.React.PureComponent{constructor(e){super(e),this.__unmounted=!1,this.fetchItemInfo=(e,t,i=!0)=>d(this,void 0,void 0,(function*(){if(!e||!t)return yield Promise.reject();const s=this.getCachePromiseId(e,t);return i&&f[s]||(f[s]=a.requestUtils.requestWrapper(t,i=>d(this,void 0,void 0,(function*(){return yield a.esri.restPortal.getItem(e,{portal:a.portalUrlUtils.getPortalRestUrl(t),authentication:i})})))),yield f[s]})),this.getCachePromiseId=(e,t)=>`${t}-${e}`,this.state={item:null}}componentDidMount(){this.__unmounted=!1,!this.props.item&&this.props.itemId&&this.props.portalUrl&&this.fetchItemInfo(this.props.itemId,this.props.portalUrl).then(e=>{this.__unmounted||this.setState({item:e})})}componentDidUpdate(e,t){this.props.item||e.portalUrl===this.props.portalUrl&&e.itemId===this.props.itemId||this.fetchItemInfo(this.props.itemId,this.props.portalUrl,!1).then(e=>{this.__unmounted||this.setState({item:e})},()=>{this.__unmounted||this.setState({item:null})}),this.props.item&&this.setState({item:null})}componentWillUnmount(){this.__unmounted=!0}render(){var e,t;if(!this.props.item&&!this.props.url&&!this.state.item)return null;const i=this.props.item||this.state.item,s=a.dataSourceUtils.isOriginDataPremium(i,this.props.url),o=a.dataSourceUtils.isOriginDataSubscriber(i,this.props.url),r=(null===(t=null===(e=null==i?void 0:i.contentStatus)||void 0===e?void 0:e.toLowerCase())||void 0===t?void 0:t.indexOf("authoritative"))>-1||o,l="livingatlas"===(null==i?void 0:i.groupDesignations)||o;return Object(a.jsx)("div",{className:Object(a.classNames)("h-100 d-flex justify-content-center align-items-center",{[this.props.className]:!!this.props.className})},r&&Object(a.jsx)("div",{className:"auth badge",title:this.props.intl.formatMessage({id:"authoritativeBadgeTooltip",defaultMessage:c.defaultMessages.authoritativeBadgeTooltip})},Object(a.jsx)(c.Icon,{icon:m,className:"auth-icon",size:12,title:this.props.intl.formatMessage({id:"authoritativeBadgeTooltip",defaultMessage:c.defaultMessages.authoritativeBadgeTooltip})})),l&&Object(a.jsx)("div",{className:"living-atlas badge",title:this.props.intl.formatMessage({id:"livingAtlasBadgeTooltip",defaultMessage:c.defaultMessages.livingAtlasBadgeTooltip})},Object(a.jsx)(c.Icon,{icon:h,className:"living-atlas-icon",size:12,title:this.props.intl.formatMessage({id:"livingAtlasBadgeTooltip",defaultMessage:c.defaultMessages.livingAtlasBadgeTooltip})})),s&&Object(a.jsx)("div",{className:"primium badge",title:this.props.intl.formatMessage({id:"premiumBadgeTooltip",defaultMessage:c.defaultMessages.premiumBadgeTooltip})},Object(a.jsx)(c.Icon,{icon:g,className:"primium-icon",size:12,title:this.props.intl.formatMessage({id:"premiumBadgeTooltip",defaultMessage:c.defaultMessages.premiumBadgeTooltip})})),o&&!s&&Object(a.jsx)("div",{className:"subscriber badge",title:this.props.intl.formatMessage({id:"subscriberBadgeTooltip",defaultMessage:c.defaultMessages.subscriberBadgeTooltip})},Object(a.jsx)(c.Icon,{icon:u,className:"subscriber-icon",size:12,title:this.props.intl.formatMessage({id:"subscriberBadgeTooltip",defaultMessage:c.defaultMessages.subscriberBadgeTooltip})})))}}const b=a.themeUtils.withStyles(Object(a.injectIntl)(v),"DataBadge");var x=b;const y=new(0,a.esri.Sanitizer);let w=null;class j extends a.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.state={dataComponentsUtils:null,AllDataSourceTypes:null}}componentDidMount(){w||(w=a.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector")),w.then(e=>{const{dataComponentsUtils:t,AllDataSourceTypes:i}=e;this.__unmount||this.setState({dataComponentsUtils:t,AllDataSourceTypes:i})})}componentWillUnmount(){this.__unmount=!0}render(){var e,t;if(!this.props.item)return null;const i=a.SessionManager.getInstance().getSessionByUrl(this.props.portalUrl),s=this.props.item.thumbnail&&this.props.portalUrl?(null==i?void 0:i.token)?`${this.props.portalUrl.replace(/\/$/,"")}/sharing/rest/content/items/${this.props.item.id}/info/${this.props.item.thumbnail}?token=${i.token}`:`${this.props.portalUrl.replace(/\/$/,"")}/sharing/rest/content/items/${this.props.item.id}/info/${this.props.item.thumbnail}`:"Web Scene"===this.props.item.type?"https://static.arcgis.com/images/scene.png":"https://static.arcgis.com/images/desktopapp.png",o=this.props.item.id&&this.props.portalUrl?`${this.props.portalUrl.replace(/\/sharing\/rest/,"").replace(/\/$/,"")}/home/item.html?id=${this.props.item.id}`:null,{title:r,owner:l,modified:n,description:d,snippet:m}=this.props.item,h=y.sanitize(d),u=y.sanitize(m),g=p(this.props.item,this.state.AllDataSourceTypes),f=null===(e=this.state.dataComponentsUtils)||void 0===e?void 0:e.getDsTypeString(null==g?void 0:g.type,this.props.intl);return Object(a.jsx)("div",{className:Object(a.classNames)("h-100",{[this.props.className]:!!this.props.className})},Object(a.jsx)("div",{className:"h-100 component-item-detail",style:this.props.style},Object(a.jsx)("div",{className:"item-header d-flex justify-content-between"},Object(a.jsx)(c.PanelHeader,{level:1,className:"p-3",showClose:!!this.props.onClose,onClose:this.props.onClose,title:this.props.intl.formatMessage({id:"details",defaultMessage:c.defaultMessages.details})})),Object(a.jsx)("div",{className:"container-fluid"},Object(a.jsx)("div",{className:"row mt-2 mb-2 px-2"},o?Object(a.jsx)(c.Link,{to:o,className:"col item-img",themeStyle:{type:"link"},target:"_blank"},Object(a.jsx)("img",{src:s,alt:r})):Object(a.jsx)("div",{className:"col item-img"},Object(a.jsx)("img",{src:s,alt:r}))),Object(a.jsx)("div",{className:"mt-2 mb-2"},o?Object(a.jsx)(c.Link,{to:o,className:"w-100 item-detial-title p-0 text-left text-break",themeStyle:{type:"link"},target:"_blank"},Object(a.jsx)("h5",{className:"item-detial-title-text w-100",title:r},r)):Object(a.jsx)("h5",{className:"w-100 text-truncate item-detial-title",title:r},r)),Object(a.jsx)("div",{className:"d-flex align-items-center w-100 mt-1",title:f},Object(a.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},Object(a.jsx)(c.Icon,{icon:null===(t=this.state.dataComponentsUtils)||void 0===t?void 0:t.getDsIcon(g),className:"text-dark",size:"12"})),Object(a.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},Object(a.jsx)("div",{className:"text-truncate ds-type-name"},f))),Object(a.jsx)("div",{className:"row mt-2 mb-2"},Object(a.jsx)("div",{className:"col small-text"},`${this.props.intl.formatMessage({id:"owner",defaultMessage:c.defaultMessages.owner})}: ${l}`)),Object(a.jsx)("div",{className:"row mt-2 mb-2"},Object(a.jsx)("div",{className:"col small-text"},`${this.props.intl.formatMessage({id:"updated",defaultMessage:c.defaultMessages.updated})}: ${this.props.intl.formatDate(new Date(n))}`)),Object(a.jsx)("div",{className:"row mt-2 mb-2"},Object(a.jsx)("div",{className:"ml-12"},Object(a.jsx)(b,{item:this.props.item}))),Object(a.jsx)("div",{className:"row mt-2 mb-2"},Object(a.jsx)("div",{className:"col item-line"})),m&&Object(a.jsx)("div",{className:"row mt-2 mb-2"},Object(a.jsx)("p",{className:"col html-container",dangerouslySetInnerHTML:{__html:u}})),Object(a.jsx)("div",{className:"row mt-2 mb-2"},Object(a.jsx)("h6",{className:"col"},this.props.intl.formatMessage({id:"description",defaultMessage:c.defaultMessages.description}))),Object(a.jsx)("div",{className:"row mt-2 mb-2"},Object(a.jsx)("div",{className:"col html-container",dangerouslySetInnerHTML:{__html:h}})))))}}var S=a.themeUtils.withStyles(Object(a.injectIntl)(j),"ItemDetail");const I=i(77),O=i(245);let $=null;class N extends a.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.onItemClicked=e=>{const t=(new Date).getTime();(!this.lastClickTime||t-this.lastClickTime>1e3)&&(this.props.selected||this.props.partSelected?this.props.onRemoveDataClicked(e,this.props.item):this.props.onAddDataClicked(e,this.props.item)),this.lastClickTime=t},this.onShowDetailClicked=e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.props.onShowDetailClicked(e,this.props.item)},this.state={dataComponentsUtils:null,AllDataSourceTypes:null}}componentDidMount(){$||($=a.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector")),$.then(e=>{const{dataComponentsUtils:t,AllDataSourceTypes:i}=e;this.__unmount||this.setState({dataComponentsUtils:t,AllDataSourceTypes:i})})}componentWillUnmount(){this.__unmount=!0}render(){var e,t;if(!this.props.item)return null;const i=a.SessionManager.getInstance().getSessionByUrl(this.props.portalUrl),s=this.props.item.thumbnail&&this.props.portalUrl?(null==i?void 0:i.token)?`${this.props.portalUrl.replace(/\/$/,"")}/sharing/rest/content/items/${this.props.item.id}/info/${this.props.item.thumbnail}?token=${i.token}`:`${this.props.portalUrl.replace(/\/$/,"")}/sharing/rest/content/items/${this.props.item.id}/info/${this.props.item.thumbnail}`:"Web Scene"===this.props.item.type?"https://static.arcgis.com/images/scene.png":"https://static.arcgis.com/images/desktopapp.png",o=p(this.props.item,this.state.AllDataSourceTypes),r=null===(e=this.state.dataComponentsUtils)||void 0===e?void 0:e.getDsTypeString(null==o?void 0:o.type,this.props.intl);return a.React.createElement("div",{className:"item",onClick:this.onItemClicked},a.React.createElement("div",{className:Object(a.classNames)("item-active-border-transparent",{"item-border-color-cyan":this.props.selected||this.props.partSelected})},a.React.createElement("div",{className:"item-card-container"},a.React.createElement("div",{className:"h-100 w-100 item-card"},a.React.createElement("div",{className:"item-badge-container"},a.React.createElement(b,{item:this.props.item})),a.React.createElement("div",{className:Object(a.classNames)({"item-active-icon":this.props.selected},{"d-none":!this.props.selected})},a.React.createElement("div",{className:"text-center item-active-icon-container"},a.React.createElement(c.Icon,{icon:I,size:16}))),a.React.createElement("div",{className:Object(a.classNames)({"item-part-active-icon":this.props.partSelected},{"d-none":!this.props.partSelected})},a.React.createElement("div",{className:"item-part-active-icon-container"},a.React.createElement("div",{className:"item-part-active-icon-innerbox d-flex justify-content-center align-items-center"},a.React.createElement("div",null)))),a.React.createElement("div",{className:"w-100 item-thumbnail",style:{backgroundImage:`url(${s})`}}),a.React.createElement("div",{className:"w-100 nav flex-column item-info-container"},a.React.createElement("div",{className:"two-line-truncate item-label",title:this.props.item.title},this.props.item.title),a.React.createElement("div",{className:"d-flex align-items-center w-100 mt-13",title:r},a.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},a.React.createElement(c.Icon,{icon:null===(t=this.state.dataComponentsUtils)||void 0===t?void 0:t.getDsIcon(o),className:"text-dark",size:"12"})),a.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},a.React.createElement("div",{className:"text-truncate ds-type-name"},r))),a.React.createElement("div",{className:"d-flex justify-content-between align-items-center mt-10"},a.React.createElement("div",{className:"text-truncate item-sub-label",title:this.props.intl.formatMessage({id:"owner",defaultMessage:c.defaultMessages.owner})},this.props.item.owner||""),a.React.createElement("div",{className:"mw-50 d-flex align-items-top justify-content-end item-icon",title:this.props.intl.formatMessage({id:"details",defaultMessage:c.defaultMessages.details})},a.React.createElement(c.Button,{type:"tertiary",size:"sm",icon:!0,onClick:this.onShowDetailClicked},a.React.createElement(c.Icon,{icon:O})))))))))}}var M,D,k;!function(e){e.MyContent="MY_CONTENT",e.MyGroup="MY_GROUP",e.MyOrganization="MY_ORGANIZATION",e.Public="PUBLIC",e.LivingAtlas="LIVING_ATLAS"}(M||(M={})),function(e){e.Modified="modified",e.Title="title",e.Views="numViews"}(D||(D={})),function(e){e.Desc="desc",e.Asc="asc"}(k||(k={}));var T=function(e,t,i,s){return new(i||(i=Promise))((function(o,a){function r(e){try{n(s.next(e))}catch(e){a(e)}}function l(e){try{n(s.throw(e))}catch(e){a(e)}}function n(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}n((s=s.apply(e,t||[])).next())}))};let U=null;class C extends a.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.pageStart=0,this.pageSize=document?Math.max(3,Math.min(10,Math.ceil((document.body.clientWidth-440)/240)))*Math.ceil((document.body.clientHeight-180)/290):60,this.setItems=(e,t,i,s,o,r,l)=>{this.fetchLivingAtlasGroupId().then(n=>{const c=this.getSearchRequestOptions(e,t,i,n,s,o,r,l);if(!c)return void this.setState({loaded:!0,items:[]});const p=this.getPortalUrl();a.esri.restPortal.searchItems(c).then(e=>{var t;if(!this.__unmount){const i=null===(t=e.results)||void 0===t?void 0:t.map(e=>Object.assign(Object.assign({},e),{portalUrl:p}));this.setState({loaded:!0,items:l?this.state.items.concat(i):i})}},e=>{this.__unmount||this.setState({loaded:!0,items:[]}),console.error(e)})})},this.getSearchRequestOptions=(e,t,i,s,o,r,l,n)=>{let c=l?`(${l}) AND`:"";Array.isArray(e)?e.forEach((t,i)=>{let s="";t===a.SupportedItemTypes.FeatureCollection?s+=' AND NOT typekeywords:("Map Notes" OR "Route Layer")':t===a.SupportedItemTypes.SceneService&&(s+=' AND typekeywords:("3DObject" OR "Point")'),c+=0===i?` ((type: "${t}"${s})`:` OR (type: "${t}"${s})`,i===e.length-1&&(c+=")")}):c+=` type:"${e}"`;const p=t;n&&(this.pageStart=this.state.items.length+1);const d=Object(a.getAppStore)().getState(),m=d&&d.user;if(m&&this.props.category===M.MyContent)c+=" AND owner:"+m.username,r&&(c+=" AND ownerfolder: "+r);else if(m&&this.props.category===M.MyOrganization)c+=" AND orgid:"+m.orgId;else if(m&&this.props.category===M.MyGroup)if((null==o?void 0:o.length)>0){c+=` AND ${"(access:shared OR access:public OR access:org)"} AND (group:(${o.reduce((e,t,i)=>0===i?t:`${e} OR ${t}`,"")}))`}else c=null;else this.props.category===M.LivingAtlas&&(s?c+=" AND group:"+s:c=null);return c?{q:c+' AND NOT type:"Web Mapping Application"',sortField:p,sortOrder:i||"desc",num:this.pageSize,start:this.pageStart,authentication:a.SessionManager.getInstance().getSessionByUrl(this.getPortalUrl())}:null},this.getPortalUrl=()=>{var e,t;if(this.props.category===M.Public){return(null===(t=null===(e=Object(a.getAppStore)().getState())||void 0===e?void 0:e.portalSelf)||void 0===t?void 0:t.isPortal)?"https://www.arcgis.com":this.props.portalUrl}return this.props.portalUrl},this.fetchLivingAtlasGroupId=()=>T(this,void 0,void 0,(function*(){if(U)return yield U;const e=Object(a.getAppStore)().getState().portalSelf,t=null==e?void 0:e.livingAtlasGroupQuery;if(t){const e={num:1,start:0,sortField:"title",sortOrder:"asc",q:t,authentication:a.SessionManager.getInstance().getSessionByUrl(this.getPortalUrl())};U=a.esri.restPortal.searchGroups(e).then(e=>{var t;return null===(t=null==e?void 0:e.results[0])||void 0===t?void 0:t.id})}else U=Promise.resolve(null);return U})),this.getWhetherItemSelected=e=>this.props.selectedItems&&this.props.selectedItems.some(t=>t.id===e.id),this.getWhetherItemPartSelected=e=>this.props.partSelectedItems&&this.props.partSelectedItems.some(t=>t.id===e.id),this.onScroll=e=>{const t=e.target.clientHeight,i=e.target.scrollHeight-(t+e.target.scrollTop)<=10;this.state.loaded&&i&&(this.setState({loaded:!1}),this.setItems(this.props.itemType,this.props.sortField,this.props.sortOrder,this.getRealGroupIds(),this.props.folderId,this.props.searchValue,!0))},this.onShowDetailClicked=(e,t)=>{this.setState({showDetailItem:t})},this.onCloseDetailClicked=()=>{this.setState({showDetailItem:null})},this.onAddDataClicked=(e,t)=>{let i;i=this.props.isRadio?[t]:this.props.selectedItems.concat(t),this.props.onSelect&&this.props.onSelect(i,t)},this.onRemoveDataClicked=(e,t)=>{const i=this.props.selectedItems.filter(e=>e.id!==t.id);this.props.onRemove&&this.props.onRemove(i,t)},this.state={loaded:!1,items:[],showDetailItem:null}}componentDidMount(){this.__unmount=!1,this.setItems(this.props.itemType,this.props.sortField,this.props.sortOrder,this.getRealGroupIds(),this.props.folderId,this.props.searchValue)}componentDidUpdate(e,t){e.portalUrl===this.props.portalUrl&&e.category===this.props.category&&e.isRadio===this.props.isRadio&&this.isItemTypeSame(e.itemType,this.props.itemType)&&e.sortField===this.props.sortField&&e.searchValue===this.props.searchValue&&e.sortOrder===this.props.sortOrder&&e.folderId===this.props.folderId&&e.groupId===this.props.groupId||(this.setState({loaded:!1}),this.pageStart=0,this.contentNode&&(this.contentNode.scrollTop=0),this.setItems(this.props.itemType,this.props.sortField,this.props.sortOrder,this.getRealGroupIds(),this.props.folderId,this.props.searchValue))}componentWillUnmount(){this.__unmount=!0,this.contentNode&&this.contentNode.removeEventListener("scroll",this.onScroll)}isItemTypeSame(e,t){const i=Array.isArray(e),s=Array.isArray(t);return i&&s?e.length===t.length&&e.every(e=>t.some(t=>t===e)):e===t}getRealGroupIds(){return this.props.groupId?[this.props.groupId]:this.getAllGroupIds()}getAllGroupIds(){var e,t;const i=null===(t=null===(e=Object(a.getAppStore)())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.user;return((null==i?void 0:i.groups)||[]).map(e=>e.id)}render(){const e=Object(a.jsx)("div",{className:"item-list"},this.state.items&&this.state.items.map((e,t)=>Object(a.jsx)(N,{selected:this.getWhetherItemSelected(e),partSelected:this.getWhetherItemPartSelected(e),key:t,item:e,portalUrl:this.getPortalUrl(),onAddDataClicked:this.onAddDataClicked,intl:this.props.intl,onRemoveDataClicked:this.onRemoveDataClicked,onShowDetailClicked:this.onShowDetailClicked}))),t=this.props.getDetailPosition&&this.props.getDetailPosition()||{l:"0",t:"0",r:"auto",b:"auto",h:"auto",w:"300px"};return Object(a.jsx)("div",{className:Object(a.classNames)("w-100 h-100",{[this.props.className]:!!this.props.className})},Object(a.jsx)("div",{className:"item-selector"},Object(a.jsx)("div",{className:"w-100 h-100 d-flex flex-wrap justify-content-center align-items-start item-list-container",onScroll:this.onScroll,ref:e=>this.contentNode=e},e,!this.state.loaded||this.state.items&&0!==this.state.items.length?null:Object(a.jsx)("div",{className:"w-100 h-100 p-2"},this.props.intl.formatMessage({id:"noItemFoundWarning",defaultMessage:c.defaultMessages.noItemFoundWarning}))),this.state.showDetailItem?Object(a.jsx)(S,{item:this.state.showDetailItem,portalUrl:this.getPortalUrl(),onClose:this.onCloseDetailClicked,style:{position:"fixed",right:""+t.r,left:""+t.l,top:""+t.t,bottom:""+t.b,height:""+t.h,width:""+t.w}}):null,!this.state.loaded&&Object(a.jsx)(c.Loading,{type:c.LoadingType.Primary})))}}var A=a.themeUtils.withStyles(Object(a.injectIntl)(C),"ItemSelector");a.ThemeManager.getInstance().registerJimuThemeStyleModule("jimu-ui/basic/item-components/",{componentStyles:s})}}))}}}));