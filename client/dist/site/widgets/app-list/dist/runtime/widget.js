System.register(["jimu-core","jimu-ui","jimu-for-builder/service"],(function(e){var t,i,s;return{setters:[function(e){t=e},function(e){i=e},function(e){s=e}],execute:function(){e(function(e){var t={};function i(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=30)}([function(e,i){e.exports=t},function(e,t){e.exports=i},function(e,t){e.exports=s},,function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a.75.75 0 01.75.75v6.5h6.5a.75.75 0 110 1.5h-6.5v6.5a.75.75 0 11-1.5 0v-6.5H.75a.75.75 0 110-1.5h6.5V.75A.75.75 0 018 0z" fill="#000" fill-rule="evenodd"></path></svg>'},,,,,function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 6.598L14.308.29a.991.991 0 011.402 1.402L9.402 8l6.308 6.308a.991.991 0 01-1.402 1.402L8 9.402 1.692 15.71A.991.991 0 01.29 14.308L6.598 8 .29 1.692A.991.991 0 011.692.29L8 6.598z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M13 7.5a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm-6.5 0a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM0 7.5a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" fill="#000"></path><path d="M0 0h16v16H0z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1a7 7 0 000 14zm0 1A8 8 0 118 0a8 8 0 010 16zm2.544-8L6.455 4.986v6.028L10.545 8zm.556.802l-4.09 3.014a.937.937 0 01-1.332-.229 1.008 1.008 0 01-.178-.573V4.986c0-.545.428-.986.955-.986.2 0 .394.064.556.184L11.1 7.198a1.006 1.006 0 010 1.604z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 7a3 3 0 100-6 3 3 0 000 6zm0 1a4 4 0 110-8 4 4 0 010 8zm1 2H7a6.002 6.002 0 00-5.917 5h13.834A6.002 6.002 0 009 10zM7 9h2a7 7 0 017 7H0a7 7 0 017-7zm.646 3.721l1.768-1.767a.5.5 0 11.707.707l-2.475 2.475-1.767-1.768a.5.5 0 01.707-.707l1.06 1.06z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14 0a2 2 0 012 2v8.5a.5.5 0 01-1 0V2a1 1 0 00-1-1H2a1 1 0 00-1 1v12a1 1 0 001 1h8.5a.5.5 0 010 1H2a2 2 0 01-2-2V2a2 2 0 012-2h12zm-1.074 12.196l2.923 2.922a.517.517 0 01-.73.73l-2.923-2.922a.517.517 0 01.73-.73zM8 3a5 5 0 110 10A5 5 0 018 3zm0 1a4 4 0 100 8 4 4 0 000-8z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.212 9.936L2 12.27l2.333-.212L13.27 3.12 11.149 1 2.212 9.936zm-.707-.707L10.441.293a1 1 0 011.415 0l2.12 2.121a1 1 0 010 1.414l-8.935 8.937a1 1 0 01-.617.289l-2.333.212a1 1 0 01-1.087-1.087l.212-2.333a1 1 0 01.289-.617zm7.434-6.497l2.829 2.829-.707.707-2.829-2.829.707-.707zM.5 15h15a.5.5 0 010 1H.5a.5.5 0 010-1z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a8 8 0 100 16A8 8 0 008 0zm3.83 3.162c.067.24.01.47-.273.47a.669.669 0 00.16-.55c.039.027.08.055.112.08h.001zm-.372-.95l.207.072a.803.803 0 00-.428.158.406.406 0 01.222-.23h-.001zM7.792 1.01c.212-.019.426-.015.638.012l-.054.083c-.123-.004-.54-.027-.653-.01.073-.074.015-.021.07-.085h-.001zM2.527 12.357a7.018 7.018 0 01-.414-.58c.2.125.394.26.58.405a.918.918 0 00-.166.175zm7.606 2.31a6.986 6.986 0 01-7.058-1.695c-.003-.07 0-.08.059-.122 1-.692.512-1.033-1.055-2.047-.123-.084-.179-.132-.19-.165-.075-1.662-.082-.85-.662-2.313a2.123 2.123 0 00-.222-.427 6.967 6.967 0 011.911-4.701c.616.008.934.146 1.176-.473.015-.04.06-.16.073-.121.7.04.593.475 1.518-.9.072-.11.126-.232.157-.36.2-.065.405-.119.613-.166-.465.623-.137 1.095.319 1.095.141 0 .731-.33 1.07-.387.608.03.853.118 1.201-.337.083-.15.183-.29.3-.416a6.936 6.936 0 011.548.498c-.508.388-.222.396-.56.838-.334.444-.017.803.425 1.138-.1.072-.194.153-.28.242a.59.59 0 00-.223-.321.669.669 0 00-.735-.596.599.599 0 00-.147 1.122c.01.197.12.376.292.473-.164.242-.081.414-.01.663-.052 0-.29-.069-.374-.069-.72 0-.785 1.215-.46 1.543-.79.68-.809.795-.917 1.017a1.921 1.921 0 00-1.248 1.686c0 .41-.25.36-.317.682-.102.485.146.728.435 1.006.32.311.152.587.628.973.572.477.863.374 1.603.268a2.339 2.339 0 011.257.134c.09.021.181.057.1.298a.596.596 0 00.133.739.275.275 0 01.11.19c.05.639-.197.474-.47 1.01v.001zm.383-8.91l.2.098a.313.313 0 01.255-.052c.37.233.57.424.93.066.12.1.23.214.325.339a.593.593 0 00.914.493c.214.276.447.177.757.255.04.091.07.186.088.284-.164.077-.34.123-.52.136-.114-.03-.231-.125-.35-.125a.533.533 0 00-.656.356 1.398 1.398 0 01-.698-.416c.1-.693-.948-.767-1.63-.616.02-.025.108-.16.089-.185a.665.665 0 00.094-.14.838.838 0 00.315-.284l-.113-.209zm-.996.222a.732.732 0 00-.064.138c0-.055.002-.102.005-.147l.059.01v-.001zm1.844 8.16a1.248 1.248 0 00-.241-1.173.955.955 0 00-.68-1.316c-.006-.002-.38-.081-.473-.113-1.052-.302-1.98.487-2.265-.484a2.546 2.546 0 00-.573-.79c.382-.424.237-.624.333-1.035.313-1.157.897-.378 1.276-1.376.017-.042.634-.564.768-.765.379.458.848.204 1.465.243.133.77 1.55 1.512 2.121.763.703.292 1.96-.216 1.646-1.118v.001a1.301 1.301 0 00-.112-.342.945.945 0 00-.935-.511.8.8 0 00-.72-.205c-.255-.554-.903-1.088-1.488-.733a.95.95 0 00-.705-.183.798.798 0 00-.36-.04 5.501 5.501 0 00-.033-.098.782.782 0 00.065-.216.87.87 0 00.691-.33c1.179.708 2.182-1.263.96-1.935.016 0 .03-.01.046-.011a6.994 6.994 0 01-.786 11.766v.001z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M8 2a2 2 0 10-4 0 2 2 0 004 0zM6 3a1 1 0 110-2 1 1 0 010 2zM4 7h1v5a1 1 0 01-1-1H3a1 1 0 01-1-1V6a2 2 0 012-2h3.78a3.05 3.05 0 00-.596 1H4a1 1 0 00-1 1v4h1V7zm8-1a2 2 0 10-4 0 2 2 0 004 0zm-2 1a1 1 0 110-2 1 1 0 010 2zm2 1H8a2 2 0 00-2 2v4a1 1 0 001 1h1a1 1 0 001 1h2a1 1 0 001-1h1a1 1 0 001-1v-4a2 2 0 00-2-2zm1 3v3h-1v-3h-1v4H9v-4H8v3H7v-4a1 1 0 011-1h4a1 1 0 011 1v1z" fill="#000" fill-rule="nonzero"></path><path d="M0 0h16v16H0z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0a4 4 0 014 4v3a2 2 0 012 2v5a2 2 0 01-2 2H4a2 2 0 01-2-2V9a2 2 0 012-2V4a4 4 0 014-4zm4 8H4a1 1 0 00-1 1v5a1 1 0 001 1h8a1 1 0 001-1V9a1 1 0 00-1-1zM8 9v1h1v1H8v1h1v1H8v1H7V9h1zm0-8a3 3 0 00-3 3v3h1V4a2 2 0 114 0v3h1V4a3 3 0 00-3-3zm0 2a1 1 0 00-1 1v3h2V4a1 1 0 00-1-1z" fill="#000" fill-rule="nonzero"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M9 3V2a1 1 0 00-1-1H4a1 1 0 00-1 1v1a2 2 0 00-2 2v9a2 2 0 002 2h5v-4h1v4h5a2 2 0 002-2V5a2 2 0 00-2-2H9zm1 12v-3a1 1 0 00-1-1H8a1 1 0 00-1 1v3H3a1 1 0 01-1-1V5a1 1 0 011-1h1V2h4v2h6a1 1 0 011 1v9a1 1 0 01-1 1h-4zM7 9h3V6H7v3zm1-2h1v1H8V7zm3-1v3h3V6h-3zm2 2h-1V7h1v1zM3 9h3V6H3v3zm1-2h1v1H4V7z" fill="#000" fill-rule="nonzero"></path><path d="M0 0h16v16H0z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path fill="#000" fill-rule="nonzero" d="M8 .5l2.373 5.07L16 6.23l-4.16 3.792 1.104 5.478L8 12.773 3.056 15.5l1.102-5.478L0 6.229l5.625-.66z"></path><path d="M0 0h16v16H0z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M8 3c2.583 0 5.166 1.45 7.75 4.349a.972.972 0 010 1.302C13.166 11.551 10.583 13 8 13S2.834 11.55.25 8.651a.972.972 0 010-1.302C2.834 4.449 5.417 3 8 3zm0 1C5.763 4 3.442 5.303 1.039 8 3.442 10.697 5.763 12 8 12s4.558-1.303 6.961-4C12.558 5.303 10.237 4 8 4zm0 7a3 3 0 110-6 3 3 0 010 6zm0-1a2 2 0 100-4 2 2 0 000 4z" fill="#000" fill-rule="nonzero"></path><path d="M0 0h16v16H0z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M8 .5l2.373 5.07L16 6.23l-4.16 3.792 1.104 5.478L8 12.773 3.056 15.5l1.102-5.478L0 6.229l5.625-.66L8 .5zm1.704 5.998L7.999 2.857 6.294 6.498l-4.002.469L5.25 9.664l-.789 3.918L8 11.631l3.537 1.951-.788-3.918 2.957-2.697-4.002-.469z" fill="#000" fill-rule="nonzero"></path><path d="M0 0h16v16H0z"></path></g></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 32"><path d="M3.478 8.441c-.447.427-1.172.427-1.619 0s-.447-1.12 0-1.548L8.333.701a1.183 1.183 0 011.619 0l6.475 6.192c.447.427.447 1.121 0 1.548s-1.172.427-1.619 0L9.143 3.023 3.478 8.441zM3.478 23.559c-.447-.427-1.172-.427-1.619 0s-.447 1.12 0 1.548l6.474 6.192a1.183 1.183 0 001.619 0l6.475-6.192c.447-.427.447-1.12 0-1.548s-1.172-.427-1.619 0l-5.665 5.418-5.665-5.418z"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M4.586 8.657l6.01-6.01a.5.5 0 01.707.707l-6.01 6.01a1 1 0 01-1.414 0L.697 6.182a.5.5 0 01.707-.707l3.182 3.182z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7 1a6 6 0 100 12A6 6 0 007 1zm0 13a7 7 0 115.621-2.828l-.222.284 3.405 3.404a.668.668 0 01-.944.944L11.456 12.4A6.974 6.974 0 017 14z" fill="#000" fill-rule="evenodd"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M7.745 7l4.1 4.1a.527.527 0 01-.745.746L7 7.746l-4.1 4.1a.527.527 0 01-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 01.746-.746l4.1 4.1 4.1-4.1a.527.527 0 01.746.746L7.746 7z" fill="#000"></path><path d="M1 1h12v12H1z"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1.5 13a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm14 1a.5.5 0 010 1h-10a.5.5 0 010-1h10zm-14-7.5a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm14 1a.5.5 0 010 1h-10a.5.5 0 010-1h10zM1.5 0a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm14 1a.5.5 0 010 1h-10a.5.5 0 010-1h10z" fill="#000" fill-rule="evenodd"></path></svg>'},function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14 0a2 2 0 012 2v12a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2h12zM7.5 8.5H1V14a1 1 0 001 1h5.5V8.5zm7.5 0H8.5V15H14a1 1 0 001-1V8.5zM2 1a1 1 0 00-1 1v5.5h6.5V1H2zm6.5 6.5H15V2a1 1 0 00-1-1H8.5v6.5z" fill="#000" fill-rule="nonzero"></path></svg>'},,,function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return G}));var s=i(0);var a,o,l,r,n,p,c,d;!function(e){e.Me="me",e.NotMe="notme",e.Anyone="anyone",e.MyFavorites="MyFavorites",e.Public="Public",e.Default="Default"}(a||(a={})),function(e){e.AllFolder="AllFolder",e.OtherFolder="OtherFolder"}(o||(o={})),function(e){e.AllGroup="AllGroup",e.Org="Org",e.OtherGroup="OtherGroup"}(l||(l={})),function(e){e.Default="Default",e.My="My",e.Shared="Shared"}(r||(r={})),function(e){e.Modified="modified",e.Title="title",e.NumViews="numViews"}(n||(n={})),function(e){e.Org="Org",e.Group="Group",e.OrgAndGroupNotMe="OrgAndGroupNotMe",e.ExbAdmin="ExbAdmin",e.My="My",e.Folder="Folder",e.All="All",e.Favorites="Favorites",e.AllFavorites="AllFavorites",e.PubLic="Public"}(p||(p={})),function(e){e.OrgAdmin="org_admin",e.OrgPublisher="org_publisher",e.OrgUser="org_user",e.CustomRoles="custom_roles"}(c||(c={})),function(e){e.Published="Published",e.Draft="Draft",e.Changed="Changed"}(d||(d={}));var h=i(1),m=function(e,t,i,s){return new(i||(i=Promise))((function(a,o){function l(e){try{n(s.next(e))}catch(e){o(e)}}function r(e){try{n(s.throw(e))}catch(e){o(e)}}function n(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,r)}n((s=s.apply(e,t||[])).next())}))};const u=s.React.createContext({deleteApp:e=>{},refreshList:()=>{},duplicateAppItem:e=>{},createApp:e=>{},favoriteTogle:(e,t)=>m(void 0,void 0,void 0,(function*(){return yield Promise.resolve(!0)})),getFolderList:()=>{},isLoadSkeleton:!1,theme:null,skeletonNum:null});var g={homePageSearch:"Search",newApp:"Create new",labelByModified:"Recent experiences",labelByTitle:"Experiences sorted by title",labelByView:"Experiences sorted by view count",templateLabelByModified:"Recent templates",templateLabelByTitle:"Templates sorted by title",templateLabelByView:"Templates sorted by view count",ownByMe:"Owned by me",ownByAnyone:"Owned by anyone",sharedWithMe:"Shared with me",orderByModified:"Last modified",orderByTitle:"Title",orderByView:"Most views",applistViews:"View count",applistItemViews:"Views",applistView:"view",editInfo:"Edit info",viewDetail:"View details",appListDelete:"Delete",appListName:"Name",appListDescription:"Description",download:"Download",editExperienceInfo:"Edit experience info",editExperienceTemplateInfo:"Edit experience template info",launchApp:"Launch",appListMore:"More",popUpOk:"OK",popUpCancel:"Cancel",popUpTitle:"Warning",popUpDiscription1:"You don't have permission to edit this web experience. Currently, you can only edit your own items.",popUpDiscription2:"You can view or duplicate it.",descriptionRemind:"Here is the description of the item.",editThumbnail:"Edit thumbnail",itemDeleteRemind:"Are you sure you want to delete this item?",untitledExperience:"Untitled experience",webExperience:"Web Experience",webExperienceTemplate:"Web Experience Template",createExperience:"Create your first experience",toCreate:"Click {createNewElement} to start a new experience",click:"Click",appListEdit:"Edit",everyone:"Shared: Everyone",noOne:"Shared: No One",organization:"Shared: Organization",group:"Shared: Group",appListPublished:"Published",appListDraft:"Draft",unpublishedChanges:"Unpublished changes",appTypeTemplate:"Experience Template",appTypeExperience:"Experience",publishedTitle:"This item can be viewed by users you've shared with.",publishedUnsaveTitle:"There are unpublished changes since last publishing.",itemStatusDraft:"Draft",draftStatusTitle:"This item is not published. It can only be viewed by you.",cardView:"Card view",listView:"List view",createNewTitle:"Create a new experience from this template",itemDescribtion:"Here is the description of the item.",editAppErrorMessage:"You have specified an image type that is not supported. Please use one of these types: PNG, GIF or JPEG.",favorites:"Favorites",myFavorites:"My favorites",itemInFavorites:"Item in Favorites",addFavorites:"Add to favorites",removeFromFavorites:"Remove from Favorites",noItemsYet:"No items yet.",templateEmptyText:"You can generate a template from an experience in the builder.",sharedEmptyText:"No items are shared with you. ",favoritesEmptyText:"When you find an item you like, click Add to Favorites to see it here.",noPublicItems:"No public items.",publicTemplate:"Public",allApp:"All",myOrg:"Organization",defaultTemplate:"Default",unableDelete:"Item could not be deleted since it is delete protected.",deleteError:"There was a problem deleting this application.",createError:"There was a problem when create new application.",duplicateError:"There was a problem when duplicate application.",noResource:"Resource does not exist or is inaccessible",noSearchResult:"No experiences found. Please try other search criteria.",noTemplates:"No templates found. Please try other search criteria.",tags:"Tags",tagsLowerCase:"tags",summaryField:"Summary",summaryPlaceholder:"Enter a summary",saveInFolder:"Save in folder"},v=i(2),f=function(e,t,i,s){return new(i||(i=Promise))((function(a,o){function l(e){try{n(s.next(e))}catch(e){o(e)}}function r(e){try{n(s.throw(e))}catch(e){o(e)}}function n(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,r)}n((s=s.apply(e,t||[])).next())}))};const b=i(9);class w extends s.React.PureComponent{constructor(e){var t,i,a,o;super(e),this.__unmount=!1,this.supportedResourceSuffix={IMAGE:[".png",".jpeg",".jpg",".gif",".bmp"]},this.getItemData=()=>{const{appItem:e}=this.props;v.appServices.getAppInfo(e).then(e=>{this.updateAppItem(e)},e=>{console.error(e)})},this.updateAppItem=e=>{var t;const{appItem:i,appIndex:a}=this.props;for(const t in e)i[t]=e[t];this.setState({localAppItem:Object(s.Immutable)(i)},()=>{this.updateState()}),null===(t=null==this?void 0:this.props)||void 0===t||t.updateAppList(i,a)},this.updateState=()=>{const{localAppItem:e}=this.state,t=((null==e?void 0:e.tags.asMutable())||[]).filter(e=>{if(e)return e});this.setState({currentTitleInput:e.title,currentDescriptInput:e.description?e.description:"",summary:(null==e?void 0:e.snippet)||"",tags:t,ownerFolder:e.ownerFolder||"/"})},this.uploadThumbnail=()=>f(this,void 0,void 0,(function*(){const e=this.getFiles();if(!e)return yield Promise.resolve(!0);const t=s.SessionManager.getInstance().getSessionByUrl(this.props.portalUrl),i={id:this.props.appItem.id,f:"json",token:null==t?void 0:t.token,thumbnail:e[0]};return yield v.appServices.updateAppThumbnail(i,this.props.appItem.owner).then(()=>f(this,void 0,void 0,(function*(){return this.isUpdateThumbnail=!0,yield Promise.resolve(!0)})),e=>f(this,void 0,void 0,(function*(){return this.setState({loading:!1}),yield Promise.reject(e)})))})),this.getFiles=()=>{const e=this.fileInput.current.files;if(!e||!e[0])return!1;const t=e[0].name,i="."+t.split(".")[t.split(".").length-1];if(!this.supportedResourceSuffix.IMAGE.includes(i.toLowerCase()))return this.handleToggle(),!1;const s=window.URL.createObjectURL(e[0]);return this.setState({files:s}),e},this.titleInputChange=(e,t=!1)=>{let i=e.target.value;i=i.length>250?i.slice(0,250):i;let a=Object(s.Immutable)(this.state.localAppItem);window.jimuConfig.isDevEdition&&(a=a.set("text",""));t&&(i=/^[ ]*$/.test(i)?this.props.appItem.title:i,i=i.replace(/(^\s*)|(\s*$)/g,"")),a=a.set("title",i),this.setState({localAppItem:a,currentTitleInput:i})},this.descriptInputChange=e=>{let t=Object(s.Immutable)(this.state.localAppItem);window.jimuConfig.isDevEdition&&(t=t.set("text","")),t=t.set("description",e),this.setState({currentDescriptInput:e,localAppItem:t})},this.nls=e=>this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:g[e]}):e,this.nlsCommonMessage=e=>this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:s.defaultMessages[e]}):s.defaultMessages[e],this.onConfirm=()=>{this.setState({loading:!0}),this.uploadThumbnail().then(()=>{this.changeItemsFolder().then(()=>{this.updateAppInfo()},e=>{this.setState({loading:!1}),console.error(e)})},e=>{this.setState({loading:!1}),console.error(e)})},this.updateAppInfo=()=>{const{appIndex:e}=this.props,t=this.state.localAppItem.asMutable({deep:!0});t.clearEmptyFields=!0,v.appServices.updateAppInfo(t).then(()=>{var i;this.isUpdateThumbnail?this.getItemData():null===(i=null==this?void 0:this.props)||void 0===i||i.updateAppList(t,e),this.setState({loading:!1}),this.props.onEditInfoOk()},e=>{this.setState({loading:!1}),console.error(e)})},this.changeItemsFolder=()=>f(this,void 0,void 0,(function*(){const{id:e}=this.props.appItem,t=this.props.appItem.ownerFolder||"/",{ownerFolder:i}=this.state,a={itemId:e,folderId:this.state.ownerFolder,authentication:null};return t!=i&&i?yield v.appServices.changeAppFolder(a).then(()=>f(this,void 0,void 0,(function*(){const e=Object(s.Immutable)(this.state.localAppItem);return e.set("ownerFolder",i),this.setState({localAppItem:e}),yield Promise.resolve(!0)})),e=>f(this,void 0,void 0,(function*(){return yield Promise.reject(!1)}))):yield Promise.resolve(!0)})),this.nameOnChange=e=>{let t=e.target.value;t.length>250&&(t=t.slice(0,250)),this.setState({currentTitleInput:t})},this.getUserTags=()=>{if(window.jimuConfig.isDevEdition)return!1;const e=Object(s.getAppStore)().getState().user.username;v.appServices.getUserTags(e).then(e=>{var t;const i=null===(t=null==e?void 0:e.tags)||void 0===t?void 0:t.map(e=>e.tag);this.setState({userTags:i||[]})})},this.getThumbnailUrl=()=>{const e=this.props.appItem.thumbnail;let t=e;const i=s.SessionManager.getInstance().getSessionByUrl(this.props.portalUrl);return t=t?this.props.portalUrl+"/sharing/rest/content/items/"+this.props.appItem.id+"/info/"+t+"?token="+(null==i?void 0:i.token):this.props.folderUrl+"./dist/runtime/assets/defaultthumb.png",e&&window.jimuConfig.isDevEdition&&(t=window.location.origin+"/apps/"+this.props.appItem.id+"/"+e),t},this.alignButtonWidth=(e,t)=>{this[e]=t},this.handleToggle=()=>{const{isShowAlertPopup:e}=this.state;this.setState({isShowAlertPopup:!e})},this.descriptionEditorFocus=e=>{e.stopPropagation(),this.props.setDescribtionFocusStatus(!0),this.setState({isDescriptionEditorEnabled:!0})},this.editInfoContentClick=e=>{var t;const i=e.target||e.srcElement;e.stopPropagation(),i&&(null===(t=null==i?void 0:i.className)||void 0===t?void 0:t.indexOf("info-content-textarea"))<0&&(this.props.setDescribtionFocusStatus(!1),this.setState({isDescriptionEditorEnabled:!1}))},this.onTagInputChange=e=>{const t=Object.assign({},this.state.localAppItem);t.tags=Object(s.Immutable)(e),this.setState({tags:e,localAppItem:Object(s.Immutable)(t)})},this.onSummaryChange=(e,t=!1)=>{e.stopPropagation();let i=e.target.value;i=i.length>250?i.slice(0,250):i;let a=Object(s.Immutable)(this.state.localAppItem);t&&(i=i&&i.replace(/(^\s*)|(\s*$)/g,"")),a=a.set("snippet",i),this.setState({localAppItem:a,summary:i})},this.onFolderChange=e=>{const t=e.target.value;this.setState({ownerFolder:t})},this.state={localAppItem:Object(s.Immutable)(this.props.appItem),currentTitleInput:this.props.appItem.title,currentDescriptInput:this.props.appItem.description?this.props.appItem.description:"",summary:(null===(i=null===(t=null==this?void 0:this.props)||void 0===t?void 0:t.appItem)||void 0===i?void 0:i.snippet)||"",loading:!1,files:"",buttonWidth:"",isShowAlertPopup:!1,isDescriptionEditorEnabled:!1,RichTextEditor:null,tags:(null===(o=null===(a=null==this?void 0:this.props)||void 0===a?void 0:a.appItem)||void 0===o?void 0:o.tags)||[],userTags:[],ownerFolder:this.props.appItem.ownerFolder||"/"},this.fileInput=s.React.createRef(),this.isUpdateThumbnail=!1}componentDidMount(){var e;this.getUserTags(),this.getItemData(),null===(e=null==this?void 0:this.context)||void 0===e||e.getFolderList()}getStyle(){const e=this.props.theme,{buttonWidth:t}=this.state,i=e.colors&&e.colors.palette?e.colors.palette.dark[300]:"#9fa4a7",a=e.colors&&e.colors.palette?e.colors.palette.light[300]:"#282828",o=e.colors&&e.colors.palette?e.colors.palette.light[800]:"#6a6a6a",l=e.colors&&e.colors.palette?e.colors.palette.dark[400]:"#a8a8a8",r=e.colors&&e.colors.palette?e.colors.palette.light[200]:"#181818",n=e.colors&&e.colors.palette?e.colors.palette.primary[700]:"#00D8ED";return s.css`
      .app-editinfo {
        width: ${s.polished.rem(700)};
        height: auto;
        left: 50%;
        top: 50%;
        margin-left: ${s.polished.rem(-350)};
        transform: translateY(-50%);
        background: ${a};
        border: 1px solid ${o};
        padding-bottom: ${s.polished.rem(30)};
        .info-title {
          height: ${s.polished.rem(54)};
          border-bottom: 1px solid ${o};
          font-weight: 500;
        }

        .info-title-text {
          padding-left: ${s.polished.rem(30)};
          font-size: ${s.polished.rem(16)};
          color: ${l};
          overflow: hidden;
          max-width: 85%;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .info-title-close {
          padding-right: ${s.polished.rem(30)};
          cursor: pointer;
        }
        .input-wrapper {
          border: none;
          outline: none;
        }
        .tag-text-input-container {
          -webkit-appearance: none;
        }
        .info-content {
          padding: ${s.polished.rem(40)} ${s.polished.rem(30)} 0;
          height: calc(100% - ${s.polished.rem(55)});

          .info-content-pic {
            width: ${s.polished.rem(240)};
            height: ${s.polished.rem(160)};
            background-size: cover;
            background-position: top center;
            margin-right: ${s.polished.rem(20)};
          }
          .edit-thumbnail-btn {
            width: ${s.polished.rem(240)};
            margin-top: ${s.polished.rem(11)};
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            box-sizing: border-box;
            display: block;
          }
          .edit-thumbnail-btn-con:hover .edit-thumbnail-btn {
            background: ${o};
          }
          .edit-thumbnail-inp {
            bottom: 0;
            left: 0;
            width: ${s.polished.rem(240)};
            height: ${s.polished.rem(34)};
            opacity: 0;
            cursor: pointer;
          }
          .info-content-btn-group {
            padding-top: ${s.polished.rem(36)};
          }

          .info-content-otherinfo {
            width: ${s.polished.rem(450)};

            .info-content-label {
              font-size: ${s.polished.rem(14)};
              line-height: ${s.polished.rem(18)};
              color: ${i};
              font-weight: 600;
              margin-bottom: ${s.polished.rem(10)} !important;
              overflow: hidden;
              text-overflow: ellipsis;
              box-sizing: border-box;
              max-width: ${s.polished.rem(380)};
            }

            .info-title-input {
              margin-bottom: ${s.polished.rem(16)};
            }

            .info-content-text {
            }
            .info-content-textarea-con {
              height: ${s.polished.rem(80)};
              margin-bottom: ${s.polished.rem(16)};
            }
            .info-content-textarea {
              width: ${s.polished.rem(378)};
              height: ${s.polished.rem(80)};
              resize: none;
              padding: ${s.polished.rem(4)} ${s.polished.rem(6)};
              box-sizing: border-box;
              border-radius: 2px;
              background: ${r};
              border: 1px solid ${r};
              font-size: ${s.polished.rem(14)};
            }
            .focus {
              border-color: ${n};
            }
            .info-content-btn {
              min-width: ${t||s.polished.rem(100)};
            }
            .select-choices-con {
              margin-bottom: ${s.polished.rem(16)};
            }
          }
        }
      }
    `}render(){const e=this.getThumbnailUrl(),t=this.props.theme.colors&&this.props.theme.colors.palette?this.props.theme.colors.palette.dark[400]:"#a8a8a8",{isShowAlertPopup:i,tags:a,userTags:o,summary:l,ownerFolder:r}=this.state,{folderListData:n}=this.props;return Object(s.jsx)("div",{css:this.getStyle(),className:"edit-info-con",onClick:e=>{this.editInfoContentClick(e)},"data-testid":"editInfo"},Object(s.jsx)("div",{className:"app-editinfo position-fixed"},Object(s.jsx)("div",{className:"bg-light-300 info-title align-items-center d-flex justify-content-between"},Object(s.jsx)("div",{className:"info-title-text",title:this.nls("editExperienceInfo")},this.props.isTemplateList?this.nls("editExperienceTemplateInfo"):this.nls("editExperienceInfo")),Object(s.jsx)("div",{className:"info-title-close",onClick:e=>{e.stopPropagation(),this.props.onEditInfoCancel()}},Object(s.jsx)(h.Icon,{width:16,height:16,color:t,icon:b}))),Object(s.jsx)("div",{className:"bg-light-300 info-content"},Object(s.jsx)("div",{className:"d-flex justify-content-center"},Object(s.jsx)("div",null,Object(s.jsx)("div",{"data-testid":"thumbnailCon",className:"info-content-pic",style:{backgroundImage:"url("+(this.state.files||e)+")"}}),Object(s.jsx)("div",{className:"position-relative edit-thumbnail-btn-con"},Object(s.jsx)(h.Button,{className:"edit-thumbnail-btn",title:this.nls("editThumbnail"),onClick:this.updateAppInfo},this.nls("editThumbnail")),Object(s.jsx)("input",{"data-testid":"thumbnailInput",title:this.nls("editThumbnail"),ref:this.fileInput,className:"position-absolute edit-thumbnail-inp",type:"file",accept:".png, .jpeg, .jpg, .gif, .bmp",onChange:this.getFiles}))),Object(s.jsx)("div",{className:"info-content-otherinfo"},Object(s.jsx)("div",{className:"info-content-label",title:this.nls("appListName")},this.nls("appListName")),Object(s.jsx)(h.TextInput,{value:this.state.currentTitleInput,className:" info-title-input",onChange:this.nameOnChange,onBlur:e=>{this.titleInputChange(e,!0)},onKeyUp:e=>{this.titleInputChange(e)}}),Object(s.jsx)("div",{className:"info-content-label",title:this.nls("summaryField")},this.nls("summaryField")),Object(s.jsx)(h.TextArea,{placeholder:this.nls("summaryPlaceholder"),value:l,className:"info-content-textarea form-control mb-3",onBlur:e=>{this.onSummaryChange(e,!0)},onKeyDown:e=>{this.onSummaryChange(e)},onChange:e=>{this.setState({summary:e.target.value})}}),!window.jimuConfig.isDevEdition&&Object(s.jsx)("div",{className:"select-choices-con"},Object(s.jsx)("div",{className:"info-content-label",title:this.nls("tags")},this.nls("tags")),Object(s.jsx)(h.TagInput,{data:a,selectListData:o,onChange:this.onTagInputChange,name:this.nls("tagsLowerCase"),menuProps:{maxHeight:80}})),!window.jimuConfig.isDevEdition&&Object(s.jsx)("div",null,Object(s.jsx)("div",{className:"info-content-label",title:this.nls("saveInFolder")},this.nls("saveInFolder")),Object(s.jsx)(h.Select,{value:r,onChange:this.onFolderChange},n.map(e=>Object(s.jsx)(h.Option,{value:e.value,key:e.value},e.text)))),Object(s.jsx)("div",{className:"d-flex justify-content-end info-content-btn-group"},Object(s.jsx)(h.Button,{type:"primary",className:"info-content-btn mr-2",ref:e=>{this.alignButtonWidth("okButton",e)},onClick:this.onConfirm,title:this.nlsCommonMessage("ok")},this.nlsCommonMessage("ok")),Object(s.jsx)(h.Button,{className:"info-content-btn",onClick:()=>{this.props.onEditInfoCancel()},ref:e=>{this.alignButtonWidth("cancelButton",e)},title:this.nlsCommonMessage("cancel")},this.nlsCommonMessage("cancel"))))))),this.state.loading&&Object(s.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-primary-loading"}),Object(s.jsx)(h.AlertPopup,{isOpen:i,hideCancel:!0,toggle:this.handleToggle},Object(s.jsx)("div",{style:{fontSize:"1rem"}},this.nls("editAppErrorMessage"))))}}w.contextType=u;const x=s.themeUtils.withTheme(w);class j extends s.React.PureComponent{constructor(e){super(e),this.getStyle=()=>s.css`
      svg {
        color: #fff;
      }
      /* &.modal-header button.close {
        padding: 0;
        margin: 0;
      } */
    `,this.stopPropagation=e=>{e.stopPropagation()}}render(){const{isOpen:e}=this.props,t=this.props.intl?this.props.intl.formatMessage({id:"appListDelete",defaultMessage:g.appListDelete}):g.appListDelete,i=this.props.intl?this.props.intl.formatMessage({id:"popUpCancel",defaultMessage:g.popUpCancel}):g.popUpCancel,a=this.props.intl?this.props.intl.formatMessage({id:"itemDeleteRemind",defaultMessage:g.itemDeleteRemind}):g.itemDeleteRemind;return Object(s.jsx)(u.Consumer,null,({deleteApp:o})=>Object(s.jsx)(h.Modal,{className:Object(s.classNames)("d-flex justify-content-center"),isOpen:e,centered:!0,toggle:this.props.deleteToggle,onClick:e=>{this.stopPropagation(e)}},Object(s.jsx)(h.ModalHeader,{tag:"h4",toggle:this.props.deleteToggle,className:"item-delete-header",css:this.getStyle()},t),Object(s.jsx)(h.ModalBody,null,a),Object(s.jsx)(h.ModalFooter,null,Object(s.jsx)(h.Button,{type:"danger",onClick:e=>{this.stopPropagation(e),o(this.props.itemId),this.props.deleteToggle()}},t),Object(s.jsx)(h.Button,{type:"secondary",onClick:e=>{this.stopPropagation(e),this.props.deleteToggle()}},i))))}}const y=i(10);class I extends s.React.PureComponent{constructor(e){super(e),this.eidtInfoStyle={width:"100%",height:"100%",maxWidth:"5000px",margin:0},this.getStyle=()=>s.css`
      .modal-content {
        background: none;
      }
    `,this.appLaunch=()=>{const e=this.props.isTemplateList?"template":"experience",t=window.jimuConfig.useStructuralUrl?`${window.jimuConfig.mountPath}${e}/${this.props.appItem.id}/`:`${window.jimuConfig.mountPath}${e}/?id=${this.props.appItem.id}`;window.open(t)},this.viewDetails=()=>{const e=`${this.props.portalUrl}/home/item.html?id=${this.props.appItem.id}`;window.open(e)},this.showEditInfo=()=>{this.setState({isShownEditInfo:!0})},this.onEditInfoCancel=()=>{this.setState({isShownEditInfo:!1})},this.onEditInfoOk=()=>{this.setState({isShownEditInfo:!1})},this.deleteToggle=()=>{this.setState({isShowDeleteAlertPopup:!this.state.isShowDeleteAlertPopup})},this.setDescribtionFocusStatus=(e=!1)=>{this.setState({isDescriptionEditorFocus:e})},this.editInfoModalClick=e=>{e.stopPropagation(),this.setDescribtionFocusStatus(!1)},this.state={isOpen:!1,isShownEditInfo:!1,isShowDeleteAlertPopup:!1,isDescriptionEditorFocus:!1}}render(){const e=window.jimuConfig.isDevEdition,t=this.state.isShownEditInfo,{editPrivileges:i,isTemplateList:a,updateAppList:o,appIndex:l,isPublish:r,appItem:n}=this.props,{isShowDeleteAlertPopup:p,isDescriptionEditorFocus:c}=this.state,d=s.SessionManager.getInstance().getMainSession(),m=null==d?void 0:d.token;return Object(s.jsx)(u.Consumer,null,({deleteApp:d,refreshList:u,duplicateAppItem:v})=>Object(s.jsx)("div",{css:this.getStyle(),className:this.props.className,title:this.props.intl?this.props.intl.formatMessage({id:"appListMore",defaultMessage:g.appListMore}):g.appListMore},Object(s.jsx)(h.Dropdown,{direction:"right",size:"sm",isOpen:this.state.isOpen,className:"app-list-dropdown",onClick:e=>e.stopPropagation(),toggle:()=>this.setState({isOpen:!this.state.isOpen})},Object(s.jsx)(h.DropdownToggle,{size:"sm",type:"tertiary"},Object(s.jsx)(h.Icon,{style:{transform:"rotate(0deg)",marginRight:"3px"},icon:y,className:"app-list-iconfill app-list-icon-margin dropdown-icon"})),Object(s.jsx)(h.DropdownMenu,{className:"app-list-dropdown"},i.canCreate&&Object(s.jsx)(h.DropdownItem,{className:"pb-1",onClick:()=>v(n),title:this.props.intl.formatMessage({id:"duplicate",defaultMessage:h.defaultMessages.duplicate})},this.props.intl.formatMessage({id:"duplicate",defaultMessage:h.defaultMessages.duplicate})),i.canEdit&&Object(s.jsx)(h.DropdownItem,{className:"pb-1",onClick:this.showEditInfo,title:this.props.intl.formatMessage({id:"editInfo",defaultMessage:g.editInfo})},this.props.intl.formatMessage({id:"editInfo",defaultMessage:g.editInfo})),!e&&Object(s.jsx)(h.DropdownItem,{className:"pb-1",onClick:this.viewDetails,title:this.props.intl.formatMessage({id:"viewDetail",defaultMessage:g.viewDetail})},this.props.intl.formatMessage({id:"viewDetail",defaultMessage:g.viewDetail})),i.canDelete&&Object(s.jsx)(h.DropdownItem,{className:"pb-1",onClick:()=>{this.deleteToggle()},title:this.props.intl.formatMessage({id:"appListDelete",defaultMessage:g.appListDelete})},this.props.intl.formatMessage({id:"appListDelete",defaultMessage:g.appListDelete})),e&&r&&Object(s.jsx)(h.DropdownItem,{href:`/download/${this.props.appItem.id}?locale=${this.props.intl.locale}&token=${m}`,target:"_blank"},this.props.intl.formatMessage({id:"download",defaultMessage:g.download})))),t&&Object(s.jsx)(h.Modal,{onClick:e=>{this.editInfoModalClick(e)},css:this.getStyle(),isOpen:t,style:this.eidtInfoStyle,contentClassName:"h-100 w-100"},Object(s.jsx)(x,{appIndex:l,updateAppList:o,appItem:this.props.appItem,portalUrl:this.props.portalUrl,folderUrl:this.props.folderUrl,onEditInfoCancel:this.onEditInfoCancel,intl:this.props.intl,isDescriptionEditorFocus:c,isTemplateList:a,setDescribtionFocusStatus:this.setDescribtionFocusStatus,folderListData:this.props.folderListData,onEditInfoOk:this.onEditInfoOk})),Object(s.jsx)(j,{isOpen:p,deleteToggle:this.deleteToggle,itemId:this.props.appItem.id,intl:this.props.intl})))}}class S extends s.React.PureComponent{constructor(e){super(e),this.toggle=()=>{this.setState({tooltipOpen:!this.state.tooltipOpen})},this.handleItemClick=()=>{const e=this.judgeUserEditPrivileges(this.props.updateGroupItemId);if(this.props.isTemplateList||!this.props.isPrivilegeCheckEnd)return!1;if(e.canEdit){let e=this.getQueryString("locale");e=e?"&locale="+e:"";const t=window.jimuConfig.mountPath+"builder/?id="+this.props.appItem.id+e;window.location.href=t}else this.setState({isShowAlertPopup:!0})},this.editTemplateClick=()=>{if(!this.judgeUserEditPrivileges(this.props.updateGroupItemId).canEdit||!this.props.isPrivilegeCheckEnd)return!1;let e=this.getQueryString("locale");e=e?"&locale="+e:"";const t=window.jimuConfig.mountPath+"builder/?id="+this.props.appItem.id+e;window.location.href=t},this.appLaunch=e=>{e.stopPropagation()},this.checkIsOwner=()=>{const e=Object(s.getAppStore)().getState().user;return!(!e||!this.props.appItem.owner||(null==e?void 0:e.username)!==this.props.appItem.owner)},this.viewDetails=e=>{this.appLaunch(e);const t=`${this.props.portalUrl}/home/item.html?id=${this.props.appItem.id}`;window.open(t)},this.handleToggle=()=>{this.setState({isShowAlertPopup:!this.state.isShowAlertPopup})},this.initExtraState=()=>{const e=`${this.props.portalUrl}/home/item.html?id=${this.props.appItem.id}`;this.setState({detailUrl:e})},this.getThumbnail=()=>{const e=this.props.appItem.thumbnail,{isExbTeamCommonTemplate:t,id:i,isDefaultTemplate:a}=this.props.appItem,{portalUrl:o,folderUrl:l,isTemplateList:r}=this.props;let n=e;const p=r?"templateDefaultthumb.png":"defaultthumb.png",c=s.SessionManager.getInstance().getSessionByUrl(o),d=c&&(null==c?void 0:c.token)?"?token="+c.token:"";return n=n?o+"/sharing/rest/content/items/"+i+"/info/"+e+d:l+"./dist/runtime/assets/"+p,e&&this.state.isDevEdition&&(n=window.location.origin+"/apps/"+i+"/"+e),a&&(n=e),t&&e&&(n=o+"/sharing/rest/content/items/"+i+"/info/"+e+d),n},this.getPreviewUrl=()=>{const{isTemplateList:e}=this.props,{id:t,isExbTeamCommonTemplate:i}=this.props.appItem;return s.urlUtils.getAppUrl({appId:t,isTemplate:e,isArcGisOnlineTemplate:i})},this.getShareState=e=>{const t={icon:this.state.IconSharedEveryone,tips:this.nls("everyone")};if(!e)return null;switch(e){case"public":t.tips=this.nls("everyone"),t.icon=this.state.IconSharedEveryone;break;case"private":t.tips=this.nls("noOne"),t.icon=this.state.IconSharedNoOne;break;case"org":t.tips=this.nls("organization"),t.icon=this.state.IconSharedOrganization;break;case"shared":t.tips=this.nls("group"),t.icon=this.state.IconSharedGroup}return t},this.getPublishStatus=e=>{const t=e.typeKeywords||[];let{publishStatus:i,publishStatusText:s}=this.state;t.forEach(e=>{if(e.includes("status:")){switch(e.split(": ")[1]){case d.Published:i=d.Published,s=this.nls("appListPublished");break;case d.Draft:i=d.Draft,s=this.nls("appListDraft");break;case d.Changed:i=d.Changed,s=this.nls("unpublishedChanges")}}}),this.setState({publishStatus:i,publishStatusText:s})},this.isHideEditDropBtn=()=>!!this.state.isDevEdition||!this.props.appItem.isDefaultTemplate&&void 0,this.nls=(e,t=!1)=>t?this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:s.defaultMessages[e]}):e:this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:g[e]}):e,this.getFavoriteStatus=e=>{const{appItem:t}=this.props;let i=!1;return i=e.includes(t.id),i},this.judgeUserEditPrivileges=(e=Object(s.Immutable)([]))=>{const{appItem:t,capabilities:i}=this.props,a=null==t?void 0:t.userRole,{isDefaultTemplate:o,isExbTeamCommonTemplate:l}=t,r=Object(s.getAppStore)().getState().user,{canUpdateExperience:n,canDeleteExperience:p,canViewExperience:d,canCreateExperience:h}=i,m=e.asMutable().includes(t.id),u={canDelete:!1,canEdit:!1,canCreate:!1,canView:!1};u.canEdit=n||!1,u.canDelete=p||!1,u.canView=d||!1,u.canCreate=h||!1,m&&(u.canDelete=!1,u.canEdit=n,u.canCreate=h);const g=this.checkIsOwner()||a==c.OrgAdmin&&(null==t?void 0:t.isOrgItem);return g&&(u.canDelete=p,u.canEdit=n,u.canCreate=h),(o||l&&"ExB_team"!=(null==r?void 0:r.username))&&(u.canDelete=!1,u.canEdit=!1,u.canCreate=h),m||g||(u.canDelete=!1,u.canEdit=!1),Object(s.Immutable)(u)},this.state={tooltipOpen:!1,itemSelected:!1,isShowAlertPopup:!1,IconPlay:i(11),IconPeople:i(12),IconAppPreview:i(13),IconToolEdit:i(14),IconAdd:i(4),IconSharedEveryone:i(15),IconSharedGroup:i(16),IconSharedNoOne:i(17),IconSharedOrganization:i(18),star:i(19),view16:i(20),starOutline:i(21),isDevEdition:window.jimuConfig.isDevEdition,thumbnail:"",detailUrl:"",limitsTips:"",publishStatus:"",publishStatusText:""}}componentDidMount(){this.initExtraState(),this.getPublishStatus(this.props.appItem)}getQueryString(e){return s.queryString.parse(window.location.search)[e]||""}}class O extends S{render(){const{IconPlay:e,IconAppPreview:t,IconToolEdit:i,IconAdd:a,isDevEdition:o,isShowAlertPopup:l,publishStatus:r,publishStatusText:n,star:p,starOutline:c}=this.state,{appItem:m}=this.props,{id:g,type:f}=m,{updateAppList:b,appIndex:w}=this.props,x=this.getShareState(this.props.appItem.access),j=this.getFavoriteStatus(this.props.allFavoritesIdData),y=this.judgeUserEditPrivileges(this.props.updateGroupItemId),S=this.props.isTemplateList?"template":"experience";return s.React.createElement(u.Consumer,null,({createApp:u,favoriteTogle:O})=>s.React.createElement(h.Card,{button:!0,className:"detailview-item",onClick:this.handleItemClick,style:{position:"relative",cursor:this.props.isTemplateList?"auto":"pointer"}},s.React.createElement("div",{className:"h-100 w-100",style:{position:"absolute"},"data-testid":"card-item"},s.React.createElement("div",{className:"w-100 app-list-detailview-pic position-relative",style:{backgroundImage:"url("+this.getThumbnail()+")"}},r&&s.React.createElement("div",{className:Object(s.classNames)("publish-status position-absolute text-truncate",r),title:n},n)),s.React.createElement(h.CardBody,{className:"w-100  justify-content-between flex-column item-message-con",style:{height:"48%"}},s.React.createElement("h2",{className:"app-list-h2 item-card-title",title:this.props.appItem.title},this.props.appItem.title),s.React.createElement("div",{className:"app-list-h3 app-list-detailview-name",title:this.props.appItem.owner},this.props.appItem.owner),s.React.createElement("div",{className:"app-list-h3 app-list-detailview-time"},this.props.appItem.modified&&s.React.createElement(s.FormattedDate,{value:new Date(this.props.appItem.modified),year:"numeric",month:"2-digit",day:"2-digit"})),!this.props.isTemplateList&&s.React.createElement("div",{className:"d-flex justify-content-between align-items-center edit-item-con"},o?s.React.createElement("div",{className:"app-list-h3"}):s.React.createElement("div",{className:"app-list-h3 item-views-number",title:`${this.nls("applistItemViews")}: ${this.props.appItem.numViews}`},s.React.createElement(h.Button,{rel:"noreferrer",title:`${this.nls("applistItemViews")}: ${this.props.appItem.numViews}`,type:"tertiary",className:"pl-1 pr-1 border-0 mr-1",onClick:this.viewDetails},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:this.state.view16})),s.React.createElement("span",null,this.props.appItem.numViews)),s.React.createElement("div",{className:"d-flex align-items-center item-btn-box"},!o&&s.React.createElement(h.Button,{rel:"noreferrer",title:x.tips,type:"tertiary",className:"pl-1 pr-1 app-item-launch border-0 mr-2",onClick:this.viewDetails},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:x.icon})),!o&&y.canView&&s.React.createElement(h.Button,{rel:"noreferrer",title:j?this.nls("removeFromFavorites"):this.nls("addFavorites"),type:"tertiary",className:Object(s.classNames)("pl-1 pr-1 app-item-launch border-0 mr-2",{favorite:j}),onClick:e=>{this.appLaunch(e),O(j,g)}},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:j?p:c})),y.canView&&s.React.createElement(h.Button,{type:"tertiary",tag:"a",href:window.jimuConfig.useStructuralUrl?`${window.jimuConfig.mountPath}${S}/${this.props.appItem.id}/`:`${window.jimuConfig.mountPath}${S}/?id=${this.props.appItem.id}`,rel:"noreferrer",target:"_blank",title:this.nls("launchApp"),className:" pl-1 pr-1 app-item-launch border-0 margin-4",onClick:this.appLaunch},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:e})),s.React.createElement(I,{appIndex:w,updateAppList:b,className:"app-item-more",portalUrl:this.props.portalUrl,intl:this.props.intl,appItem:this.props.appItem,folderUrl:this.props.folderUrl,isOwner:this.checkIsOwner(),isPublish:r!=d.Draft,isTemplateList:this.props.isTemplateList,folderListData:this.props.folderListData,editPrivileges:y}))),this.props.isTemplateList&&s.React.createElement("div",{className:"d-flex justify-content-between align-items-center edit-item-con"},s.React.createElement("div",{className:"item-btn-box template-item-btn-box"},y.canView&&s.React.createElement(h.Button,{type:"tertiary",tag:"a",href:this.getPreviewUrl(),rel:"noreferrer",target:"_blank",title:this.nls("launchApp"),className:"float-left pl-1 pr-1 app-item-launch border-0 mr-2",onClick:this.appLaunch},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:t})),!o&&f!=v.AppType.ExperienceType&&y.canView&&s.React.createElement(h.Button,{rel:"noreferrer",title:j?this.nls("removeFromFavorites"):this.nls("addFavorites"),type:"tertiary",className:Object(s.classNames)("pl-1 pr-1 app-item-launch border-0 mr-2 float-left",{favorite:j}),onClick:e=>{this.appLaunch(e),O(j,g)}},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:j?p:c})),y.canEdit&&s.React.createElement(h.Button,{rel:"noreferrer",type:"tertiary",className:"float-left pl-1 pr-1 app-item-launch border-0 mr-2",title:this.nls("appListEdit"),onClick:this.editTemplateClick},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:i})),y.canCreate&&r!=d.Draft&&s.React.createElement(h.Button,{rel:"noreferrer",type:"tertiary",className:"float-left pl-1 pr-1 app-item-launch border-0 mr-2",onClick:e=>{this.appLaunch(e),u(m)},title:this.nls("createNewTitle")},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:a}))),s.React.createElement("div",{className:"d-flex align-items-center item-btn-box"},s.React.createElement(I,{className:"float-right app-item-more",appIndex:w,updateAppList:b,portalUrl:this.props.portalUrl,intl:this.props.intl,appItem:this.props.appItem,folderUrl:this.props.folderUrl,isOwner:this.checkIsOwner(),isPublish:r!=d.Draft,isTemplateList:this.props.isTemplateList,folderListData:this.props.folderListData,editPrivileges:y}))))),s.React.createElement(h.AlertPopup,{isOpen:l,title:this.nls("popUpTitle"),hideCancel:!0,toggle:this.handleToggle},s.React.createElement("div",{style:{fontSize:"1rem"}},this.nls("noEditContentPrivilegesError",!0)))))}}class $ extends s.React.PureComponent{constructor(e){super(e),this.renderCardSkeleton=()=>Object(s.jsx)(h.Card,{button:!0,className:"detailview-item",css:this.getStyle()},Object(s.jsx)("div",{className:"h-100 w-100"},Object(s.jsx)("div",{className:"w-100 app-list-detailview-pic position-relative skeleton-pic"}),Object(s.jsx)(h.CardBody,{className:"w-100  justify-content-between flex-column item-message-con",style:{height:"48%"}},Object(s.jsx)("h2",{className:"app-list-h2 item-card-title skeleton-title"}),Object(s.jsx)("div",{className:"app-list-h3 app-list-detailview-name skeleton-name"}),Object(s.jsx)("div",{className:"app-list-h3 app-list-detailview-time skeleton-time"}),Object(s.jsx)("div",{className:"d-flex align-items-center item-btn-box skeleton-btn-box position-relative"},Object(s.jsx)("div",null,Object(s.jsx)("span",{className:"skeleton-btn"}),Object(s.jsx)("span",{className:"skeleton-btn skeleton-lg-btn"})),Object(s.jsx)("div",{className:"text-right flex-grow-1 right-btn-con"},Object(s.jsx)("span",{className:"skeleton-btn"}),Object(s.jsx)("span",{className:"skeleton-btn"}),Object(s.jsx)("span",{className:"skeleton-btn"}),Object(s.jsx)("span",{className:"skeleton-btn"})))))),this.renderListSkeleton=()=>{const e=window.jimuConfig.isDevEdition;return Object(s.jsx)("div",{className:"mb-3 ml-0 mr-0 position-relative app-item-backcolor listview-item item-list-con d-flex",css:this.getStyle()},Object(s.jsx)("div",{className:"p-0 position-absolute app-list-listview-pic-con"},Object(s.jsx)("div",{className:"app-list-listview-pic skeleton-list-pic"})),Object(s.jsx)("div",{className:Object(s.classNames)("d-flex align-items-center item-list-name-con",{"item-list-name-con-dev":e})},Object(s.jsx)("div",{className:"app-list-h2 d-flex align-items-center"},Object(s.jsx)("div",{className:"flex-grow-1 text-truncate skeleton-list-title"}))),Object(s.jsx)("div",{className:"d-flex align-items-center item-list-owner "},Object(s.jsx)("div",{className:"app-list-h3 app-list-listview-name item-list-border-l"},Object(s.jsx)("span",{className:"skeleton-list-name"}))),Object(s.jsx)("div",{className:"d-flex align-items-center item-list-border-l item-list-time"},Object(s.jsx)("div",{className:"app-list-h3 skeleton-list-time"})),!e&&Object(s.jsx)("div",{className:"d-flex align-items-center item-list-border-l app-list-views-con app-list-views"},!this.props.isTemplateList&&Object(s.jsx)("div",{className:"app-list-h3 app-list-listview-view"},Object(s.jsx)("span",{className:"skeleton-btn cir-btn"}),Object(s.jsx)("span",{className:"skeleton-btn skeleton-view-num"}))),Object(s.jsx)("div",{className:Object(s.classNames)("align-items-center d-flex item-list-icon-con justify-content-end skeleton-list-icon-con")},Object(s.jsx)("span",{className:"skeleton-btn cir-btn mr-16"}),Object(s.jsx)("span",{className:"skeleton-btn cir-btn mr-16"}),Object(s.jsx)("span",{className:"skeleton-btn cir-btn mr-16"}),Object(s.jsx)("span",{className:"skeleton-btn cir-btn mr-16"})))}}getStyle(){var e,t,i,a,o,l,r,n,p;const c=this.props.theme;return s.css`
      .skeleton-pic,
      .skeleton-time,
      .skeleton-name,
      .skeleton-title,
      .skeleton-btn,
      .skeleton-list-pic,
      .skeleton-list-title,
      .skeleton-list-name,
      .skeleton-list-time {
        background: ${null===(i=null===(t=null===(e=null==c?void 0:c.colors)||void 0===e?void 0:e.palette)||void 0===t?void 0:t.secondary)||void 0===i?void 0:i[600]};
      }
      .item-message-con {
        .skeleton-title {
          height: ${s.polished.rem(32)};
        }
        .skeleton-name {
          height: ${s.polished.rem(18)};
          width: ${s.polished.rem(173)};
          margin-bottom: ${s.polished.rem(12)};
        }
        .skeleton-time {
          height: ${s.polished.rem(18)};
          width: ${s.polished.rem(120)};
          margin-bottom: ${s.polished.rem(12)};
        }
        .skeleton-btn-box {
          border-top: 1px solid ${null===(l=null===(o=null===(a=null==c?void 0:c.colors)||void 0===a?void 0:a.palette)||void 0===o?void 0:o.secondary)||void 0===l?void 0:l[600]};
          box-sizing: border-box;
          padding-top: ${s.polished.rem(10)};
        }
        .skeleton-btn {
          display: inline-block;
          width: ${s.polished.rem(16)};
          height: ${s.polished.rem(16)};
          border-radius: 50%;
          margin-right: ${s.polished.rem(4)};
        }
        .skeleton-lg-btn {
          border-radius: 0;
          width: ${s.polished.rem(32)};
        }
        .right-btn-con .skeleton-btn {
          margin-right: 0;
          margin-left: ${s.polished.rem(16)};
        }
      }
      &.listview-item {
        .item-list-owner .app-list-listview-name {
          margin-top: 0;
        }
        .app-list-listview-pic-con .skeleton-list-pic {
          background: ${null===(p=null===(n=null===(r=null==c?void 0:c.colors)||void 0===r?void 0:r.palette)||void 0===n?void 0:n.secondary)||void 0===p?void 0:p[600]};
        }
        .skeleton-list-title {
          width: ${s.polished.rem(200)};
          height: ${s.polished.rem(22)};
        }
        .skeleton-list-name {
          display: inline-block;
          width: ${s.polished.rem(120)};
          height: ${s.polished.rem(22)};
        }
        .skeleton-list-time {
          width: ${s.polished.rem(74)};
          height: ${s.polished.rem(22)};
        }
        .cir-btn {
          display: inline-block;
          width: ${s.polished.rem(16)};
          height: ${s.polished.rem(16)};
          border-radius: 50%;
        }
        .skeleton-view-num {
          width: ${s.polished.rem(32)};
          height: ${s.polished.rem(18)};
          margin-left: ${s.polished.rem(4)};
        }
        .mr-16 {
          margin-right: ${s.polished.rem(16)};
        }
      }
    `}render(){return this.props.isCardSkeleton?this.renderCardSkeleton():this.renderListSkeleton()}}class T extends s.React.PureComponent{constructor(e){super(e),this.renderSkeleton=()=>{var e;const t=[],i=this.context.skeletonNum||6;for(let a=0;a<i;a++)t.push(s.React.createElement($,{key:a,theme:null===(e=null==this?void 0:this.context)||void 0===e?void 0:e.theme,isTemplateList:this.props.isTemplateList,isCardSkeleton:!0}));return t}}getViewContent(){var e;const t=this.props.apps.length,{isPrivilegeCheckEnd:i,updateAppList:a}=this.props;return s.React.createElement("div",{className:"app-list-detailview-content","data-testid":"app-item-list-card"},t>0&&this.props.apps.map((e,t)=>s.React.createElement(O,{appIndex:t,updateAppList:a,allFavoritesIdData:this.props.allFavoritesIdData,updateGroupItemId:this.props.updateGroupItemId,portalUrl:this.props.portalUrl,intl:this.props.intl,key:e.id,folderUrl:this.props.folderUrl,appItem:e.asMutable({deep:!0}),itemIdx:t,capabilities:this.props.capabilities,folderListData:this.props.folderListData,isPrivilegeCheckEnd:i,isTemplateList:this.props.isTemplateList})),(null===(e=null==this?void 0:this.context)||void 0===e?void 0:e.isLoadSkeleton)&&this.renderSkeleton())}render(){const e=this.getViewContent();return s.React.createElement("div",{className:"app-list-detailview"},e)}}T.contextType=u;class k extends S{render(){const{IconPlay:e,IconAppPreview:t,IconToolEdit:i,IconAdd:a,isDevEdition:o,publishStatus:l,publishStatusText:r,star:n,starOutline:p}=this.state,{isTemplateList:c,appIndex:m,appItem:g,updateAppList:f}=this.props,{id:b,modified:w,type:x}=g,j=this.getShareState(this.props.appItem.access),y=this.getFavoriteStatus(this.props.allFavoritesIdData),S=this.judgeUserEditPrivileges(this.props.updateGroupItemId),O=this.props.isTemplateList?"template":"experience";return s.React.createElement(u.Consumer,null,({createApp:u,favoriteTogle:$})=>s.React.createElement("div",{onClick:this.handleItemClick,style:{cursor:c?"auto":"pointer"},className:Object(s.classNames)("mb-3 ml-0 mr-0 position-relative app-item-backcolor  listview-item item-list-con d-flex"),onMouseEnter:()=>{this.setState({itemSelected:!0})},onMouseLeave:()=>{this.setState({itemSelected:!1})},"data-testid":"list-item"},s.React.createElement("div",{className:"p-0 position-absolute app-list-listview-pic-con"},s.React.createElement("div",{className:"app-list-listview-pic",style:{backgroundImage:"url("+this.getThumbnail()+")"}})),s.React.createElement("div",{className:Object(s.classNames)("d-flex align-items-center item-list-name-con",{"item-list-name-con-dev":o})},s.React.createElement("div",{className:"app-list-h2 d-flex align-items-center",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:this.props.appItem.title},s.React.createElement("div",{className:"flex-grow-1 text-truncate"},this.props.appItem.title),l&&s.React.createElement("div",{className:Object(s.classNames)("publish-status text-truncate list-publish-status ",l),title:r},r))),s.React.createElement("div",{className:"d-flex align-items-center item-list-owner "},s.React.createElement("div",{className:"app-list-h3 app-list-listview-name item-list-border-l",title:this.props.appItem.owner},this.props.appItem.owner)),s.React.createElement("div",{className:"d-flex align-items-center item-list-border-l item-list-time"},s.React.createElement("div",{className:"app-list-h3"},w&&s.React.createElement(s.FormattedDate,{value:new Date(this.props.appItem.modified),year:"numeric",month:"2-digit",day:"2-digit"}))),!o&&s.React.createElement("div",{title:`${this.nls("applistItemViews")}: ${this.props.appItem.numViews}`,className:"d-flex align-items-center item-list-border-l app-list-views-con app-list-views"},!c&&s.React.createElement("div",{className:"app-list-h3 app-list-listview-view"},s.React.createElement(h.Button,{rel:"noreferrer",title:`${this.nls("applistItemViews")}: ${this.props.appItem.numViews}`,type:"tertiary",className:"pl-1 pr-1 border-0 mr-1",onClick:this.viewDetails},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:this.state.view16})),s.React.createElement("span",null,this.props.appItem.numViews))),s.React.createElement("div",{className:Object(s.classNames)("align-items-center d-flex item-list-icon-con justify-content-end",{templateIconCon:c,decIconCon:o})},!c&&s.React.createElement("div",{className:"d-flex align-items-center"},!o&&s.React.createElement(h.Button,{rel:"noreferrer",type:"tertiary",title:j.tips,className:"float-right pl-1 pr-1 app-item-launch border-0 mr-2",onClick:this.viewDetails},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:j.icon})),!o&&S.canView&&s.React.createElement(h.Button,{rel:"noreferrer",title:y?this.nls("removeFromFavorites"):this.nls("addFavorites"),type:"tertiary",className:Object(s.classNames)("pl-1 pr-1 app-item-launch border-0 mr-2",{favorite:y}),onClick:e=>{this.appLaunch(e),$(y,b)}},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:y?n:p})),S.canView&&s.React.createElement("a",{"data-testid":"launchApp",href:window.jimuConfig.useStructuralUrl?`${window.jimuConfig.mountPath}${O}/${this.props.appItem.id}/`:`${window.jimuConfig.mountPath}${O}/?id=${this.props.appItem.id}`,rel:"noreferrer",target:"_blank"},s.React.createElement(h.Button,{title:this.nls("launchApp"),className:"float-right  btn  app-item-launch border-0 margin-4",type:"tertiary",onClick:this.appLaunch},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:e}))),s.React.createElement(I,{updateAppList:f,appIndex:m,className:"float-right mr-2",portalUrl:this.props.portalUrl,intl:this.props.intl,appItem:this.props.appItem,folderUrl:this.props.folderUrl,isOwner:this.checkIsOwner(),isPublish:l!=d.Draft,isTemplateList:c,folderListData:this.props.folderListData,editPrivileges:S})),c&&s.React.createElement("div",{className:Object(s.classNames)("d-flex align-items-center justify-content-end",!this.checkIsOwner()&&"icon-con-padding-r")},S.canView&&s.React.createElement(h.Button,{type:"tertiary",tag:"a",href:window.jimuConfig.useStructuralUrl?`../${O}/${this.props.appItem.id}/`:`../${O}/?id=${this.props.appItem.id}`,rel:"noreferrer",target:"_blank",title:this.nls("launchApp"),className:"float-right pl-1 pr-1 app-item-launch border-0 mr-2",onClick:this.appLaunch},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:t})),!o&&x!=v.AppType.ExperienceType&&S.canView&&s.React.createElement(h.Button,{rel:"noreferrer",title:y?this.nls("removeFromFavorites"):this.nls("addFavorites"),type:"tertiary",className:Object(s.classNames)("pl-1 pr-1 app-item-launch border-0 mr-2 float-right",{favorite:y}),onClick:e=>{this.appLaunch(e),$(y,b)}},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:y?n:p})),S.canEdit&&s.React.createElement(h.Button,{rel:"noreferrer",type:"tertiary",className:"float-right pl-1 pr-1 app-item-launch border-0 mr-2",title:this.nls("appListEdit"),onClick:this.editTemplateClick},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:i})),S.canCreate&&l!=d.Draft&&s.React.createElement(h.Button,{rel:"noreferrer",type:"tertiary",className:"float-right pl-1 pr-1 app-item-launch border-0 margin-4",title:this.nls("createNewTitle"),onClick:e=>{this.appLaunch(e),u(g)}},s.React.createElement(h.Icon,{className:"app-list-iconfill mr-0",icon:a})),s.React.createElement(I,{className:"float-right mr-2",updateAppList:f,appIndex:m,portalUrl:this.props.portalUrl,intl:this.props.intl,appItem:this.props.appItem,folderUrl:this.props.folderUrl,isOwner:this.checkIsOwner(),isTemplateList:c,isPublish:l!=d.Draft,folderListData:this.props.folderListData,editPrivileges:S}))),s.React.createElement(h.AlertPopup,{isOpen:this.state.isShowAlertPopup,title:this.nls("popUpTitle"),hideCancel:!0,toggle:this.handleToggle},s.React.createElement("div",{style:{fontSize:"1rem"}},this.nls("noEditContentPrivilegesError",!0)))))}}class E extends s.React.PureComponent{constructor(e){super(e),this.renderSkeleton=()=>{var e;const t=this.context.skeletonNum||6,i=[];for(let a=0;a<t;a++)i.push(s.React.createElement($,{key:a,theme:null===(e=null==this?void 0:this.context)||void 0===e?void 0:e.theme,isCardSkeleton:!1,isTemplateList:this.props.isTemplateList}));return i},this.toggle=()=>{this.setState({tooltipOpen:!this.state.tooltipOpen})},this.state={tooltipOpen:!1}}getViewContent(){const e=this.props.apps.length,{isPrivilegeCheckEnd:t,updateAppList:i}=this.props;if(e<1)return null;{let e=null,a=null;return e=this.props.apps.map((e,a)=>s.React.createElement(k,{appIndex:a,updateAppList:i,allFavoritesIdData:this.props.allFavoritesIdData,updateGroupItemId:this.props.updateGroupItemId,portalUrl:this.props.portalUrl,folderUrl:this.props.folderUrl,key:e.id,itemIdx:a,appItem:e.asMutable({deep:!0}),intl:this.props.intl,capabilities:this.props.capabilities,folderListData:this.props.folderListData,isPrivilegeCheckEnd:t,isTemplateList:this.props.isTemplateList})),a=s.React.createElement(h.Container,{className:"app-list-listview-container",style:{maxWidth:"100%"}},e),a}}render(){var e;const t=this.getViewContent();return s.React.createElement("div",{className:"app-list-listview w-100","data-testid":"app-item-list-list"},t,s.React.createElement(h.Container,{className:"app-list-listview-container",style:{maxWidth:"100%"}},(null===(e=null==this?void 0:this.context)||void 0===e?void 0:e.isLoadSkeleton)&&this.renderSkeleton()))}}E.contextType=u;class N extends s.React.PureComponent{constructor(e){super(e)}render(){const{apps:e,isDetailContent:t,portalUrl:i,intl:a,folderUrl:o,switchListView:l,isTemplateList:r,allFavoritesIdData:n,capabilities:p,updateGroupItemId:c,folderListData:d,isPrivilegeCheckEnd:h,updateAppList:m}=this.props;return s.React.createElement("div",{className:"app-list-view"},t&&s.React.createElement(T,{updateAppList:m,allFavoritesIdData:n,updateGroupItemId:c,portalUrl:i,intl:a,folderUrl:o,apps:e,capabilities:p,switchListView:l,folderListData:d,isPrivilegeCheckEnd:h,isTemplateList:r}),!t&&s.React.createElement(E,{updateAppList:m,allFavoritesIdData:n,updateGroupItemId:c,portalUrl:this.props.portalUrl,intl:this.props.intl,folderUrl:o,apps:e,capabilities:p,switchListView:l,folderListData:d,isPrivilegeCheckEnd:h,isTemplateList:r}))}}function C(e){return s.css`
    &.invalid-message {
      text-align: center;
      top: 50%;
      font-size: ${s.polished.rem(16)};
      color: ${e.colors.palette.dark[600]};
      min-width: ${s.polished.rem(800)};
      width: 100%;
      box-sizing: border-box;
      padding:0 ${s.polished.rem(50)};
    }
    .loading-con {
      position: fixed;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      background: ${s.polished.rgba(e.colors.white,.2)};
    }
    .widget-builder-app-list {
      overflow-y: auto;

      .widget-builder-app-list-screen {
        width:824px;
        margin: auto;
      }

      button.app-list-newapp:hover{
        color: ${e.colors.black} !important;
      }

      .modal-content {
        background:none;
      }

      .app-list-newapp {
        padding-left: ${s.polished.rem(16)};
        padding-right: ${s.polished.rem(16)};
        font-size: ${s.polished.rem(16)};
        margin-left: ${s.polished.rem(20)};
        height:${s.polished.rem(40)};
        white-space: nowrap;
        .app-list-newapp-icon {
          margin-right: ${s.polished.rem(8)};
        }
      }

      .app-list-search-container {
        padding-left: ${s.polished.rem(16)};
        padding-right: ${s.polished.rem(16)};
      }

      .app-list-h1 {
        font-size: ${s.polished.rem(24)};
      }

      .app-list-h2 {
        font-size: ${s.polished.rem(16)};
      }

      .app-list-h3 {
        font-size: ${s.polished.rem(13)};
      }

      .app-list-maxwidth {
        max-width: ${75}rem;
        top:40px;
      }

      .app-list-banner {
        overflow: hidden;
        width: 100%;
        height: ${5}rem;
        align-items: center;
        .list-title {
          font-size:${1.25}rem;
          color: ${e.colors.palette.dark[600]};
          margin-bottom: 0;
        }
      }

      .app-list-filterbar {
        margin-left: auto;
        margin-right: auto;
        width: 100%;
        padding-top: ${1.875}rem;
        padding-bottom: ${1.875}rem;
        border-top: 1px solid ${e.colors.palette.secondary[800]};
        .search-con {
          position:relative;
          align-items:center;
          border-radius:2px;
          background:${e.colors.palette.light[200]};
          /* width:${s.polished.rem(257)}; */
          width:${s.polished.rem(228)};
        }
        .app-list-switchview-con {
          border-radius: 2px;
          overflow:hidden;
          display: inline-block;
          vertical-align: middle;
        }
        .app-list-switchview {
          border-radius: 0;
        }
        .app-list-switchview-right {
          border-radius: 0;
        }
        .app-list-searchIconFill {
          color: ${e.colors.palette.dark[600]};
        }
        .app-list-searchbox:focus + .clear-con{
          display: block;
        }
        .clear-con {
          right: ${s.polished.rem(6)};
          cursor: pointer;
          color: ${e.colors.palette.dark[600]};
          transition: all ease .5s;
          /* display: none; */
        }
        .clear-con:hover {
          color: ${e.colors.black};
        }
        .app-list-searchbox {
          color: ${e.colors.black};
          width: 100%;
          height: ${2}rem;
          font-size:${.875}rem;
          box-sizing: border-box;
        }
        .app-list-searchbox::-ms-clear{
          display: none;
        }
        .app-list-clear {
          cursor: pointer;
        }
        .app-list-searchbox::-webkit-input-placeholder {
          color: ${e.colors.palette.dark[400]};
        }
        .app-list-searchbox:-moz-placeholder {
          color: ${e.colors.palette.dark[400]};
        }
        .app-list-searchbox:-ms-input-placeholder {
          color: ${e.colors.palette.dark[400]};
        }
        .filterbar-input {
          width: ${8.75}rem;
          margin-right:${s.polished.rem(10)};
          height:${s.polished.rem(32)};
          line-height:${s.polished.rem(32)};
          padding-top:0;
          padding-bottom:0;
          cursor: pointer;
          display: inline-block;
          vertical-align: middle;
        }

        .app-list-filterbar-title {
          padding-left: ${s.polished.rem(16)};
          padding-right: ${s.polished.rem(16)};
        }
      }
      .favorite {
        color: ${e.colors.palette.warning[500]};
      }
      .margin-4 {
        margin-right: ${s.polished.rem(4)};
      }
      .app-list-item-scroll-con {
        height: calc(100% - 200px);
        overflow-y: auto;
        min-width: 824px;
      }
      .app-list-content {
        width: 100%;
        padding-bottom: ${3.125}rem;
      }
      .top-space {
        height: ${11.625}rem;
      }
      .app-list-detailview {
        width: 100%;

        .app-list-detailview-name {
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
          /* max-width: ${s.polished.rem(120)}; */
        }

        .app-list-detailview-content {
          width: 100%;

          display: flex;
          flex-wrap: wrap;

          .app-list-detailview-pic {
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            height: ${s.polished.rem(160)};
          }
          .app-list-detailview-pic-cursor {
            cursor: pointer;
          }
        }

        .dropdown-toggle::after {
          display: none !important;
        }
      }

      .app-list-listview {

        .app-list-listview-name {
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .app-list-listview-view {
          &{
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
          }
          button {
            vertical-align: middle;
          }
          button:hover {
            color:${e.colors.palette.dark[600]};
          }
          span {
            display: inline-block;
            vertical-align: middle;
            margin-bottom: ${s.polished.rem(-2)};
            color:${e.colors.palette.dark[600]};
          }
        }
        .app-list-views-con {
          padding-right: 5px;
        }
        .app-list-listview-container {
          position: relative;
          padding-left: ${s.polished.rem(16)};
          padding-right: ${s.polished.rem(16)};
        }

        .app-list-listview-pic {
          width:${s.polished.rem(60)};
          height:${s.polished.rem(40)};
          left:0;
          top:0;
          background-size: cover;
          background-position: center center;
          background-color: ${e.colors.palette.dark[600]};
          position: inherit;
        }
        .app-list-detailview-pic-cursor {
          cursor: pointer;
        }
        .app-list-listview-pic-con {
          z-index: 10;
        }
      }

      .detailview-item {
        width: ${s.polished.rem(244)};
        height: ${s.polished.rem(330)};
        margin: 0 ${s.polished.rem(15)} ${s.polished.rem(30)} ${s.polished.rem(15)};
        border: 1px solid ${e.colors.palette.light[300]};
        background: ${e.colors.palette.light[500]}
      }

      .app-item-more {
        margin-right: -0.625rem;
      }

      .app-item-backcolor {
        background-color: ${e.colors.palette.light[500]};
      }

      .app-item-launch:focus {
        outline: none;
        box-shadow: none !important;
      }
      .icon-con-padding-r {
        padding-right:${s.polished.rem(5)};
      }
      .app-list-icon-margin {
        fill: #BCC4CD !important;
        margin-right: 0;
        margin-left: 0;
      }

      .app-list-dropdown {
        padding: 0;
        margin: 0;
        min-width: 0;
      }

      .dropdown-toggle::after {
        display: none !important;
      }

      .app-list-searchIconFill {
        fill: ${e.colors.palette.dark[600]} !important;
        color: ${e.colors.palette.dark[600]} !important;
      }

      .item-message-con {
        padding:${s.polished.rem(12)};
        padding-bottom:0;
      }
      .item-card-title {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        overflow: hidden;
        height:${s.polished.rem(46)};
        color:${e.colors.palette.dark[800]};
        font-size:${1}rem;
        margin-bottom:${s.polished.rem(18)};
      }
      .app-list-detailview-name, .app-list-detailview-time {
        color:${e.colors.palette.dark[600]};
        font-size:${13/16}rem;
        line-height:${1}rem;
        min-height:${1}rem;
        margin-bottom:${s.polished.rem(9)};
      }
      .edit-item-con {
        & {
          border-top:1px solid ${e.colors.palette.light[800]};
          padding-top:${s.polished.rem(4)};
        }
        .item-views-number {
          color:${e.colors.palette.dark[600]};
          max-width: ${s.polished.rem(118)};
          overflow: hidden;
          white-space: nowrap;
          text-overflow: ellipsis;
        }
        .item-views-number button {
          vertical-align: middle;
        }
        .item-views-number button:hover {
          color:${e.colors.palette.dark[600]};
        }
        .item-views-number span {
          display: inline-block;
          line-height: ${s.polished.rem(30)};
          vertical-align: middle;
          margin-bottom: ${s.polished.rem(-2)};
        }
        .template-item-btn-box {
          margin-left: ${s.polished.rem(-4)};
        }
      }
      .description-con {
        & {
          background-color: ${s.polished.rgba(e.colors.white,.8)};
          left:0;
          top:0;
          right:0;
          bottom:0;
          box-sizing: border-box;
          padding:${s.polished.rem(16)};
          color:${e.colors.palette.dark[800]};
          font-size:${.75}rem;
          opacity: 0;
          transition: all ease .2s;
          overflow-y:scroll;
        }
        div {

        }
      }
      .dropdown-toggle svg.jimu-icon {
        transform: rotate(0deg);
        margin-right: 3px;
      }
      .app-list-detailview-pic:hover .description-con {
        opacity: 1;
      }
      .publish-status {
        background: ${e.colors.palette.warning[800]};
        height: ${s.polished.rem(18)};
        line-height: ${s.polished.rem(18)};
        right: ${s.polished.rem(8)};
        top: ${s.polished.rem(8)};
        color: ${e.colors.palette.warning[100]};
        padding: 0 ${s.polished.rem(6)};
        border-radius: 2px;
        font-size: ${s.polished.rem(10)};
        box-sizing: border-box;
        font-weight: bold;
      }
      .list-publish-status {
        max-width: ${s.polished.rem(100)};
        margin: 0 ${s.polished.rem(16)} 0 ${s.polished.rem(10)};
        min-width: ${s.polished.rem(40)};
        text-align: center;
      }
      .Published {
        color: ${e.colors.palette.success[100]};
        background: ${e.colors.palette.success[800]};
      }
      .Changed {
        color: ${e.colors.palette.danger[100]};
        background: ${e.colors.palette.danger[800]};
      }
      .item-list-con {
        & {
          height:${s.polished.rem(44)};
          background: ${e.colors.palette.light[500]};
          border: 2px solid ${e.colors.palette.light[300]};;
          transition: all ease .3s;
        }
        &:hover {
          border: 2px solid ${e.colors.palette.primary[700]};
        }
        .item-list-name-con {
          padding-left:${s.polished.rem(76)};
          font-size:${1}rem;
          color:${e.colors.palette.dark[800]};
          flex-grow: 1;
          max-width: 36%;
        }
        .item-list-owner {
          width: ${s.polished.rem(160)};
          box-sizing: border-box;
        }
        .item-list-time {
          width: ${s.polished.rem(99)};
        }
        .app-list-views {
          width: ${s.polished.rem(80)};
        }
        .item-list-icon-con {
          padding-right:0;
          width: ${s.polished.rem(167)};
        }

        .item-list-icon-con>div {
          height: ${s.polished.rem(24)};
        }
        .item-list-name-con-dev {
          max-width: 46%;
        }
        .item-list-name-con-default {
          max-width: 83%;
        }
        .app-list-h3 {
          color:${e.colors.palette.dark[600]};
        }
        .item-list-border-l {
          border-left: 1px solid ${e.colors.palette.secondary[800]};
          box-sizing:border-box;
          padding-left:${s.polished.rem(16)};
          height:${s.polished.rem(24)};
          margin-top:${s.polished.rem(8)};
          box-sizing: border-box;
        }

      }
      @media only screen and (min-width: 1280px) {
        .widget-builder-app-list-screen {
          width:1100px;
        }
        .app-list-filterbar .search-con {
            width:${s.polished.rem(400)};
        }
        .app-list-filterbar .filterbar-input {
          width: ${s.polished.rem(170)};
          margin-right:${s.polished.rem(20)};
        }
        .item-list-con {
          .item-list-name-con {
            max-width: 53%;
          }
          .item-list-name-con-dev {
            max-width: 60%;
          }
          .item-list-name-con-default {
            max-width: 88%;
          }
        }
      }
      @media only screen and (min-width: 1400px) {
        .widget-builder-app-list-screen {
            width:1372px;
        }
        .app-list-filterbar .filterbar-input {
          width: ${s.polished.rem(200)};
        }
        .item-list-con {
          .item-list-name-con{
            max-width: 48%;
          }
          .item-list-owner {
            width: ${s.polished.rem(260)};
          }
          .item-list-time {
            width: ${s.polished.rem(159)};
          }
          .app-list-views {
            width: ${s.polished.rem(106)};
          }
          .item-list-name-con-dev {
            max-width: 59%;
          }
          .item-list-name-con-default {
            max-width: 90%;
          }
        }
      }

      @media only screen and (min-width: 1680px) {
        .widget-builder-app-list-screen {
            width:1654px;
        }
        .item-list-con {
          .item-list-name-con{
            max-width: 57.5%;
          }
          .item-list-name-con-dev {
            max-width: 64%;
          }
          .item-list-name-con-default {
            max-width: 90%;
          }
        }
      }
    }
  `}class D extends s.React.PureComponent{constructor(e){super(e),this.getEmptyText=()=>{const{isTemplateList:e,accessType:t}=this.props;let{emptyTextTop:i,emptyTextBottom:s}=this.state;switch(t){case a.Me:case a.Anyone:e?(i=this.nls("noItemsYet"),s=this.nls("templateEmptyText")):i=this.nls("createExperience");break;case a.NotMe:i=this.nls("sharedEmptyText");break;case a.MyFavorites:i=this.nls("noItemsYet"),s=this.nls("favoritesEmptyText");break;case a.Public:i=this.nls("noPublicItems");break;case a.Default:i=this.nls("noItemsYet")}this.setState({emptyTextTop:i,emptyTextBottom:s})},this.nls=e=>this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:g[e]}):e,this.state={emptyTextTop:"",emptyTextBottom:""}}componentDidMount(){this.getEmptyText()}getStyle(){const e=this.props.theme,t=e.colors&&e.colors.palette?e.colors.palette.dark[400]:"#a8a8a8",i=e.colors&&e.colors.palette?e.colors.palette.dark[600]:"#c5c5c5",a=this.props.folderUrl+"./dist/runtime/assets/empty.png",o=this.props.folderUrl+"./dist/runtime/assets/no_item.png";return s.css`
      & {
        width: 100%;
        margin-top: ${s.polished.rem(120)};
      }
      div {
        text-align: center;
      }
      .empty-con {
        width: 100%;
        top: 50%;
      }
      .icon-con {
        width: ${s.polished.rem(458)};
        height: ${s.polished.rem(303)};
        background: url(${a}) no-repeat left top;
        background-size: contain;
        margin: 0 auto;
        opacity: 0.4;
      }
      .search-empty {
        background-image: url(${o});
        height: ${s.polished.rem(458/1.32)};
      }
      .create-experience {
        color: ${i};
        font-size: ${s.polished.rem(16)};
        line-height: ${s.polished.rem(16)};
        margin-top: ${s.polished.rem(30)};
        font-weight: 500;
      }
      .remind-to-click {
        color: ${t};
        font-size: ${s.polished.rem(14)};
        line-height: ${s.polished.rem(14)};
        margin-top: ${s.polished.rem(20)};
      }
      .remind-to-click span {
        color: ${i};
        font-weight: 500;
      }
      @media only screen and (max-width: 1600px) {
        & {
          margin-top: ${s.polished.rem(80)};
        }
      }
      @media only screen and (max-width: 1360px) {
        & {
          width: 100%;
          margin-top: ${s.polished.rem(0)};
        }
        .icon-con {
          width: ${s.polished.rem(200)};
          height: ${s.polished.rem(132)};
        }
        .search-empty {
          height: ${s.polished.rem(200/1.32)};
        }
        .create-experience {
          margin-top: ${s.polished.rem(20)};
        }
        .remind-to-click {
          margin-top: ${s.polished.rem(10)};
        }
      }
      @media only screen and (max-width: 1176px) {
        & {
          margin-top: ${s.polished.rem(20)};
        }
      }
    `}render(){const{accessType:e,isTemplateList:t,searchText:i}=this.props,{emptyTextTop:o,emptyTextBottom:l}=this.state,r=this.props.intl.formatMessage({id:"toCreate",defaultMessage:g.toCreate},{createNewElement:Object(s.jsx)("span",{key:"toCreate"},"+ ",this.nls("newApp"))});return Object(s.jsx)("div",{css:this.getStyle(),className:"app-list-empty-con"},0==i.length&&Object(s.jsx)("div",{className:"empty-con"},Object(s.jsx)("div",{className:"icon-con"}),o&&Object(s.jsx)("div",{className:"create-experience"},o),l&&Object(s.jsx)("div",{className:"create-experience"},l),!t&&(e==a.Me||e==a.Anyone)&&Object(s.jsx)("div",{className:"remind-to-click"},r)),i.length>0&&Object(s.jsx)("div",{className:"empty-con"},Object(s.jsx)("div",{className:"icon-con search-empty"}),Object(s.jsx)("div",{className:"create-experience"},t?this.nls("noTemplates"):this.nls("noSearchResult"))))}}const L=s.themeUtils.withTheme(D),M=i(22),A=i(23);class P extends s.React.PureComponent{constructor(e){super(e),this.getTextAndIndexById=(e,t)=>{let{text:i}=this.state;return e.forEach((e,s)=>{t==e.value&&(i=e.text)}),i},this.toggleDropdown=()=>{const{dropdownOpen:e}=this.state;this.setState({dropdownOpen:!e})},this.optionClick=(e,t,i)=>{const{onChange:s,onOptionClick:a,value:o}=this.props;this.setState({text:t}),this.toggleDropdown(),o!=i&&s&&s(i),a&&a(i)},this.state={dropdownOpen:!1,text:""}}componentDidMount(){}getStyle(){const{colors:e}=this.props.theme;return s.css`
      .dropdown button,
      .dropdown button:not(:disabled):not(.disabled):active {
        background: ${e.palette.light[200]};
        padding-right: 0;
      }
      .dropdown button {
      }
      .dropdown span {
        position: relative;
        text-align: left;
        font-size: ${s.polished.rem(14)};
        color: ${e.black};
        text-align: left;
        width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        padding-right: ${s.polished.rem(24)};
        height: ${s.polished.rem(32)};
      }
      .dropdown span svg {
        position: absolute;
        right: ${s.polished.rem(6)};
        top: ${s.polished.rem(7)};
      }
    `}getDropdownStyle(){const{colors:e}=this.props.theme;return s.css`
      & {
        background: ${e.palette.secondary[400]};
        border: 1px solid ${e.palette.secondary[600]};
        border-radius: 2px;
        font-size: ${s.polished.rem(14)};
        padding: 0;
      }
      .dropdown-menu--inner {
        max-height: ${s.polished.rem(200)};
      }
      .dropdown-menu--inner .active {
        background: ${e.palette.primary[500]};
      }
      .icon-con {
        width: ${s.polished.rem(12)};
        height: ${s.polished.rem(12)};
        display: inline-block;
        vertical-align: middle;
        margin-right: ${s.polished.rem(8)};
      }
      .icon-con svg {
        display: block;
      }
    `}render(){const{dropdownOpen:e}=this.state,{dropDownData:t,isShowSelectIcon:i,className:a,value:o}=this.props,l=this.getTextAndIndexById(t,o);return Object(s.jsx)("div",{className:Object(s.classNames)("d-inline-block align-middle",a),css:this.getStyle()},Object(s.jsx)(h.Dropdown,{size:"sm",toggle:this.toggleDropdown,isOpen:e,className:"h-100"},Object(s.jsx)(h.DropdownToggle,{size:"sm",type:"tertiary",className:"dropdown d-flex filterbar-input",title:l},l,Object(s.jsx)(h.Icon,{icon:M,className:"toollist-item-icon",width:8,height:18})),Object(s.jsx)(h.DropdownMenu,{css:this.getDropdownStyle()},t.map((e,t)=>Object(s.jsx)(h.DropdownItem,{key:t,onClick:t=>{this.optionClick(t,e.text,e.value)},className:Object(s.classNames)({active:o==e.value})},i&&Object(s.jsx)("span",{className:"icon-con"},o==e.value&&Object(s.jsx)(h.Icon,{icon:A,width:12,height:12})),e.text)))))}}const R=s.themeUtils.withTheme(P);var F=function(e,t,i,s){return new(i||(i=Promise))((function(a,o){function l(e){try{n(s.next(e))}catch(e){o(e)}}function r(e){try{n(s.throw(e))}catch(e){o(e)}}function n(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,r)}n((s=s.apply(e,t||[])).next())}))};const z=i(24),U=i(25),B=i(4),V=i(26),H=i(27);class G extends s.React.PureComponent{constructor(e){super(e),this.searchPromise=null,this.isLoadModuleForBuilder=!0,this.scrollPosition=0,this.isHasPreload=!1,this.nextStart=null,this.appListTotal=null,this.isHadSearchList=!1,this.preloadData=()=>{if(!Object(s.getAppStore)().getState().portalSelf)return!1;this.getRole(),this.checkUserPrivilege(),this.getFoldersAndGroup(),this.getParamsAndRefresh(),this.initDropdownData(),this.contentNode&&(this.contentNode.addEventListener("scroll",this.onScrollHandle.bind(this)),this.contentNode.scrollTop=G.scrollTop),this.isHasPreload=!0},this.preloadModule=()=>{if(!this.isLoadModuleForBuilder)return!1;const e=[s.moduleLoader.loadModule("jimu-arcgis"),s.moduleLoader.loadModule("jimu-for-builder"),s.moduleLoader.loadModule("jimu-layouts/layout-runtime.js"),s.moduleLoader.loadModule("jimu-for-builder/service.js"),s.moduleLoader.loadModule("jimu-layouts/layout-builder.js"),s.moduleLoader.loadModule("jimu-ui/advanced/style-setting-components.js"),s.moduleLoader.loadModule("jimu-ui/basic/color-picker.js"),s.moduleLoader.loadModule("jimu-ui/advanced/setting-components.js"),s.moduleLoader.loadModule("jimu-ui/advanced/theme-components.js"),s.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector.js"),s.moduleLoader.loadModule("jimu-ui/basic/item-selector.js"),s.moduleLoader.loadModule("jimu-ui/advanced/resource-selector.js"),s.moduleLoader.loadModule("jimu-core/data-source.js"),s.moduleLoader.loadModule("jimu-ui/basic/imagecrop.js"),s.moduleLoader.loadModule("jimu-core/react-dom/server.js")];Promise.all(e).then(e=>{this.isLoadModuleForBuilder=!1})},this.getRole=()=>{var e,t;let{userRole:i}=this.state;switch(null===(t=null===(e=this.props)||void 0===e?void 0:e.user)||void 0===t?void 0:t.role){case c.OrgAdmin:i=c.OrgAdmin;break;case c.OrgPublisher:i=c.OrgPublisher;break;case c.OrgUser:i=c.OrgUser;break;default:i=c.CustomRoles}this.setState({userRole:i})},this.initDropdownData=()=>{const{sortDropdownData:e,classifyDropdownData:t}=this.state;window.jimuConfig.isDevEdition||(e.push({value:"numViews",text:this.nls("applistViews")}),t.push({value:a.MyFavorites,text:this.nls("myFavorites")}),t.push({value:a.NotMe,text:this.nls("sharedWithMe")})),this.setState({sortDropdownData:e,classifyDropdownData:t})},this.getGroupList=()=>{var e;if(window.jimuConfig.isDevEdition)return!1;const t=(null===(e=this.props.user)||void 0===e?void 0:e.groups)||Object(s.Immutable)([]),i=[{value:l.AllGroup,text:this.nls("allApp")},{value:l.Org,text:this.nls("myOrganization",!0)}],{updateGroupIdData:a}=this.state;t.forEach(e=>{const t={value:e.id,text:e.title};e.capabilities.indexOf("updateitemcontrol")>-1&&a.push(e.id),i.push(t)}),this.setState({groupListData:i,updateGroupIdData:a})},this.getFolderList=()=>!window.jimuConfig.isDevEdition&&v.appServices.getFolders({num:1}).then(e=>{const t=e||[];this.initFolderListData(t)},e=>Promise.reject(e)),this.initFolderListData=e=>{const{user:t}=this.props,i=(null==t?void 0:t.username)||"",s=[{value:o.AllFolder,text:this.nls("allApp")}];i&&s.push({value:"root",text:i}),e.forEach(e=>{const t={value:e.id,text:e.title};s.push(t)}),this.setState({folderListData:s})},this.nls=(e,t=!1)=>t?this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:h.defaultMessages[e]}):e:this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:g[e]}):e,this.getRequestOption=(e,t=!1,i=p.My)=>{let a=Object(s.Immutable)({});a=a.merge({q:this.getSharedRequestOptionAttrQ(i)}),e&&(a="title"===e?a.merge({sortField:e,sortOrder:"asc"}):a.merge({sortField:e,sortOrder:"desc"})),window.jimuConfig.isDevEdition&&(a=a.merge({portalUrl:this.props.portalUrl}));const o=this.getPageNumAndStartNum(t,i);return a=a.merge({num:o.num,start:o.start}),a},this.getPageNumAndStartNum=(e,t=p.Group)=>{const i={num:30,start:1},{exbAdminTemplate:s,myTemplate:a}=this.state;if(e)switch(t){case p.ExbAdmin:i.start=s.length+1;break;default:i.start=a.length+1}return i},this.getSharedRequestOptionAttrQ=(e=p.Group)=>{const{groupId:t,folderId:i,userRole:a,searchTextForRequest:o}=this.state,l=s.SessionManager.getInstance().getMainSession(),r=this.props.user,n=this.getExperienceType(),{isTemplateList:d}=this.props.config,h=(null==r?void 0:r.favGroupId)||"",m=(null==l?void 0:l.username)||"",u=o?`(${o})`:"";if(!l||!r)return`type: ${n} ${u}`;const g=(null==r?void 0:r.groups.map(e=>e.id))||[],v="type: "+this.getExperienceType(),f=g.length>0?g.join(" OR "):"",b=f?"OR "+f:"",w="NOT owner:"+m,x="(access:shared OR access:public OR access:org)",j=a==c.OrgAdmin?"(access:org OR access:private)":"access:org",y=a==c.OrgAdmin?"(access:org OR access:private)":"(access:org)",I=d?y:j,S=f?`((orgid:${null==r?void 0:r.orgId} ${j}) OR (group: (${f}) ${x}))`:`(orgid:${null==r?void 0:r.orgId} ${j})`,O=`(orgid:${null==r?void 0:r.orgId} ${I}) OR (group: (${h} ${b}))`;switch(e){case p.Group:return`group:(${t}) type: ${n} ${x} NOT owner:${m} ${u}`;case p.Org:return`orgid:${null==r?void 0:r.orgId} ${v} ${j} NOT owner:${m} ${u}`;case p.OrgAndGroupNotMe:return`${S} ${v} ${w} ${u}`;case p.All:return window.jimuConfig.isDevEdition?`type: ${n} ${u}`:`${v} (${O} OR (owner:${m} AND NOT owner:ExB_team)) ${u}`;case p.ExbAdmin:return'type: "Web Experience Template" AND owner:ExB_team '+u;case p.My:return`type: ${n} orgid:${null==r?void 0:r.orgId} AND owner:${m} ${u}`;case p.Folder:return`type: ${n} ownerfolder: ${i} AND owner:${m} ${u}`;case p.Favorites:case p.AllFavorites:return`group: "${h}" type: ${n} ${u}`;case p.PubLic:return`type: ${n} access:public NOT owner:${m} AND NOT owner:ExB_team ${u}`}},this.refresh=(e,t=!1)=>{e&&!this.isRefuseSearchRequest()&&(this.searchPromise=null,this.searchPromise=this.appServiceSearchApp(e),this.searchPromise.then(e=>{const i=e.results;this.searchPromise?(this.refreshSetState(i,t),this.nextStart=e.nextStart,this.appListTotal=e.total,this.setState({isLoadSkeleton:!1})):this.setState({isLoadSkeleton:!1})},()=>{this.setState({isLoadSkeleton:!1})}))},this.refreshSetState=(e,t=!1)=>{const i=t?this.state.apps.asMutable({deep:!0}):[],a=t?this.state.myTemplate.asMutable({deep:!0}):[];let o=[];o=t?a.concat(e):e,e=this.initAppInfo(e),this.setState({myTemplate:Object(s.Immutable)(o),apps:Object(s.Immutable)(i.concat(e))},()=>{this.getItemsGroups(Object(s.Immutable)(e),!1,t),this.getItemsGroups(Object(s.Immutable)(e),!0,t),this.isHadSearchList=!0}),clearTimeout(this.preloadModulesTimeout),this.preloadModulesTimeout=setTimeout(()=>{this.preloadModule()},1e3)},this.initAppInfo=e=>{const{userRole:t}=this.state;return e.map(e=>{var i;return e.isLocalApp=window.jimuConfig.isDevEdition,e.portalUrl=null===(i=null==this?void 0:this.props)||void 0===i?void 0:i.portalUrl,e.userRole=t,e})},this.isRefuseSearchRequest=()=>{const{accessType:e}=this.state,{isTemplateList:t}=this.props.config;return!(!window.jimuConfig.isDevEdition||!t||e!=a.NotMe)},this.getItemsGroups=(e,t=!1,i=!1)=>{if(window.jimuConfig.isDevEdition)return!1;const o=this.props.user,l=null==o?void 0:o.favGroupId,{updateGroupIdData:r,accessType:n}=this.state,p=i?this.state.allFavoritesIdData.asMutable({deep:!0}):[],c=i?this.state.updateGroupItemId.asMutable({deep:!0}):[];if(n==a.Me&&t||0==e.length||t&&0==r.length)return!1;let d=t?c:p;const h={items:e.map(e=>e.id).join(","),groups:t?r.join(","):l};v.appServices.getAppGroups(h).then(e=>{var i,a;for(const t in e)null===(a=null===(i=e[t])||void 0===i?void 0:i.items)||void 0===a||a.forEach(e=>{d=d.concat([e.itemId])});t?this.setState({updateGroupItemId:Object(s.Immutable)(d)}):this.setState({allFavoritesIdData:Object(s.Immutable)(d)})})},this.appServiceSearchApp=e=>F(this,void 0,void 0,(function*(){return yield v.appServices.searchApp(e,v.SearchType.Other)})),this.newApp=()=>{let e=window.jimuConfig.mountPath+"builder/";const t=this.getFolderIdForCreateApp();window.jimuConfig.useStructuralUrl?e+="page/template":e+="?page=template";const i=this.getQueryString("locale");i&&(e=s.urlUtils.appendQueryParam(e,"locale",i)),t&&(e=s.urlUtils.appendQueryParam(e,"folderId",t)),e=s.urlUtils.appendQueryParam(e,"redirect","homePage"),window.location.assign(e)},this.deleteApp=e=>{this.setState({loading:!0}),v.appServices.deleteApp(e).then(()=>{this.setState({loading:!1}),this.removeItem(e)},e=>{const t="CONT_0048"==(null==e?void 0:e.code)?this.nls("unableDelete"):this.nls("deleteError");this.setState({loading:!1,isShowAlertPopup:!0,alertPopupMessage:t})})},this.refreshList=(e=!0)=>{const t=this;this.setState({filterTitle:this.props.config.isTemplateList?this.nls("templateLabelByModified"):this.nls("labelByModified")}),e&&this.setState({searchText:""}),setTimeout(()=>{t.getParamsAndRefresh()},1e3)},this.getFilterTitle=()=>{},this.duplicateAppItem=e=>{this.setState({loading:!0});const t=this.getFolderIdForCreateApp();v.appServices.duplicateApp(e,t).then(e=>{this.setState({loading:!1}),e&&this.refreshList(!1)},e=>{const t=e&&e.indexOf("Resource does not exist")>-1?this.nls("noResource"):this.nls("duplicateError");this.setState({loading:!1,isShowAlertPopup:!0,alertPopupMessage:t})})},this.createApp=e=>{let t=this.getQueryString("locale");t=t?"&locale="+t:"",this.setState({loading:!0});const i=this.getFolderIdForCreateApp();v.appServices.createAppByItemTemplate(e,i).then(e=>{if(e){const i=window.jimuConfig.mountPath+"builder/?id="+e+t;window.location.href=i}this.setState({loading:!1})},e=>{const t=e&&e.indexOf("Resource does not exist")>-1?this.nls("noResource"):this.nls("createError");this.setState({loading:!1,isShowAlertPopup:!0,alertPopupMessage:t})})},this.switchListView=e=>{this.setState({isDetailContent:e})},this.accessChange=e=>{let{subclassification:t}=this.state;e==a.Me?t=o.AllFolder:e==a.NotMe&&(t=l.AllGroup),this.setState({accessType:e,subclassification:t,subclassificationValue:t},()=>{this.getParamsAndRefresh()})},this.sharedAccessChange=e=>{const t=e.target.value;if(t==r.Default){const e=this.props.config.isTemplateList?this.nls("templateLabelByTitle"):this.nls("labelByTitle");this.setState({filterField:"title",filterTitle:e})}this.setState({sharedAccesstype:t},()=>{this.getParamsAndRefresh()})},this.filterFieldChange=e=>{let t="";const{isTemplateList:i}=this.props.config;e==n.Title?t=i?this.nls("templateLabelByTitle"):this.nls("labelByTitle"):e==n.NumViews?t=i?this.nls("templateLabelByView"):this.nls("labelByView"):e==n.Modified&&(t=i?this.nls("templateLabelByModified"):this.nls("labelByModified")),this.setState({filterField:e,filterTitle:t},()=>{0!=this.state.apps.length&&this.getParamsAndRefresh()})},this.handleKeydown=e=>{const t=e.target.value;13===e.keyCode&&t&&this.setState({searchTextForRequest:t},()=>{clearTimeout(this.onSearchTextInputed),this.getParamsAndRefresh()})},this.searchTextChange=e=>{const t=e.target.value,i=t.length<3&&t.length>0;let{searchTextForRequest:s}=this.state;s=i?s:t,this.setState({searchText:t,searchTextForRequest:s},()=>{if(i)return!1;clearTimeout(this.onSearchTextInputed),this.onSearchTextInputed=setTimeout(()=>{this.getParamsAndRefresh()},500)})},this.clearSearchText=()=>{const{searchTextForRequest:e}=this.state;clearTimeout(this.onSearchTextInputed),this.setState({searchText:"",searchTextForRequest:""},()=>{e&&this.getParamsAndRefresh()})},this._matchearchText=e=>{const{searchText:t}=this.state;return!t||!e||e.toLowerCase().indexOf(t.toLowerCase())>-1},this.getSubclassification=e=>{let{folderId:t,groupId:i,subclassification:s}=this.state;const{accessType:r}=this.state;switch(r){case a.Me:e==o.AllFolder?(s=o.AllFolder,t=""):(s=o.OtherFolder,t=e);break;case a.NotMe:e==l.AllGroup||e==l.Org?(s=e,i=""):(s=l.OtherGroup,i=e)}this.setState({folderId:t,groupId:i,subclassification:s,subclassificationValue:e},()=>{this.getParamsAndRefresh()})},this.favoriteTogle=(e,t)=>F(this,void 0,void 0,(function*(){const i=this.props.user,s={everyone:!1,org:!1,groups:null==i?void 0:i.favGroupId,items:t};return this.setState({loading:!0}),e?yield this.removeFromFavorites(s):yield this.addToFavorite(s)})),this.addToFavorite=e=>F(this,void 0,void 0,(function*(){const t=this.state.allFavoritesIdData.asMutable();return yield v.appServices.addToFavorites(e).then(i=>F(this,void 0,void 0,(function*(){return t.push(e.items),this.setState({allFavoritesIdData:Object(s.Immutable)(t),loading:!1}),yield Promise.resolve(i)})),e=>F(this,void 0,void 0,(function*(){return this.setState({loading:!1}),yield Promise.reject(e)})))})),this.removeFromFavorites=e=>F(this,void 0,void 0,(function*(){const{accessType:t,allFavoritesIdData:i}=this.state,o=i.filter(t=>t!=e.items);return v.appServices.removeFromFavorites(e).then(i=>F(this,void 0,void 0,(function*(){return this.setState({loading:!1,allFavoritesIdData:Object(s.Immutable)(o)}),t==a.MyFavorites&&this.removeItem(e.items),yield Promise.resolve(i)})),e=>F(this,void 0,void 0,(function*(){return this.setState({loading:!1}),yield Promise.reject(e)})))})),this.removeItem=e=>{const t=this.state.apps.asMutable({deep:!0}),i=this.state.myTemplate.asMutable({deep:!0}),a=t.filter(t=>t.id!=e),o=i.filter(t=>t.id!=e);this.setState({apps:Object(s.Immutable)(a),myTemplate:Object(s.Immutable)(o)})},this.getSubclassificationData=e=>{const{folderListData:t,groupListData:i}=this.state;let s=[];return e==a.Me&&(s=t),e==a.NotMe&&(s=i),s},this.isShowClassifyDropdown=()=>{const e=!!s.SessionManager.getInstance().getMainSession(),t=window.jimuConfig.isDevEdition,{accessType:i}=this.state;return e&&(i==a.Me||i==a.NotMe)&&!t},this.checkUserPrivilege=()=>F(this,void 0,void 0,(function*(){const{CheckTarget:e}=s.privilegeUtils,{capabilities:t}=this.state;return yield s.privilegeUtils.checkExbAccess(e.AppList).then(e=>{this.setState({valid:null==e?void 0:e.valid,invalidMessage:null==e?void 0:e.invalidMessage,capabilities:(null==e?void 0:e.capabilities)||t,isPrivilegeCheckEnd:!0})})})),this.toggleAlertPopup=()=>{this.setState({isShowAlertPopup:!this.state.isShowAlertPopup,alertPopupMessage:""})},this.filterUserFolder=()=>this.state.folderListData.map(e=>e.value.includes("root")?{value:"/",text:e.text}:e).filter(e=>!e.value.includes("AllFolder")),this.updateAppList=(e,t)=>{if(!e)return;const i=this.state.apps.asMutable({deep:!0});i[t]=e,this.setState({apps:Object(s.Immutable)(i)})},this.isShowAccessTypeDropdown=()=>{const{userRole:e}=this.state;return!!s.SessionManager.getInstance().getMainSession()&&(!window.jimuConfig.isDevEdition||!(!window.jimuConfig.isDevEdition||e!=c.OrgAdmin))},this.getItemRowNumber=()=>{var e;const t=null===(e=this.appListContainer)||void 0===e?void 0:e.clientWidth;return Math.floor(t/244)},this.getSearchInputSuffixElement=e=>e.length>0&&Object(s.jsx)("div",{onClick:this.clearSearchText},Object(s.jsx)(h.Icon,{width:14,height:14,icon:U,className:"app-list-clear "})),this.getSearchInputprefixElement=()=>Object(s.jsx)("div",{onClick:()=>{this.getParamsAndRefresh()}},Object(s.jsx)(h.Icon,{width:16,height:16,icon:z,className:"app-list-searchIconFill"})),this.state={apps:Object(s.Immutable)([]),exbAdminTemplate:Object(s.Immutable)([]),myTemplate:Object(s.Immutable)([]),isDetailContent:!0,accessType:a.Me,filterTitle:this.props.config.isTemplateList?this.nls("templateLabelByModified"):this.nls("labelByModified"),filterField:n.Modified,searchText:"",searchTextForRequest:"",loading:!1,isLoadSkeleton:!1,experienceType:v.AppType.ExperienceType,sharedAccesstype:r.Default,isRoleViewer:!0,folderId:"",groupId:"",subclassification:o.AllFolder,subclassificationValue:o.AllFolder,folderListData:[],groupListData:[],allFavoritesIdData:Object(s.Immutable)([]),updateGroupIdData:[],updateGroupItemId:Object(s.Immutable)([]),userRole:c.CustomRoles,valid:!0,invalidMessage:"",isShowAlertPopup:!1,alertPopupMessage:"",isPrivilegeCheckEnd:!1,capabilities:{canCreateExperience:!1,canDeleteExperience:!1,canShareExperience:!1,canUpdateExperience:!1,canViewExperience:!1},classifyDropdownData:[{value:a.Anyone,text:this.nls("allApp")},{value:a.Me,text:this.nls("ownByMe")}],sortDropdownData:[{value:"modified",text:this.nls("orderByModified")},{value:"title",text:this.nls("orderByTitle")}]},this.onScrollHandle=this.onScrollHandle.bind(this)}componentDidMount(){this.props.isTest&&this.preloadData()}componentDidUpdate(e){const{config:t,queryObject:i,portalUrl:s}=this.props,a=t.isTemplateList||!1,o="templatelist"==(null==i?void 0:i.views),l=(null==e?void 0:e.portalUrl)!==s,r=o==a&&!this.isHasPreload;(l||r)&&this.preloadData(),(null==e?void 0:e.user)!==this.props.user&&this.isHasPreload&&this.getParamsAndRefresh(),(null==e?void 0:e.user)!==this.props.user&&this.getRole()}getFoldersAndGroup(){this.getFolderList(),this.getGroupList()}onScrollHandle(e){const t=e.target.clientHeight,i=e.target.scrollHeight-2,s=e.target.scrollTop;if(s>this.scrollPosition){const e=t+s>=i;!this.state.isLoadSkeleton&&e&&0!=this.state.apps.length&&this.getParamsAndRefresh(!0)}this.scrollPosition=s}componentWillUnmount(){this.contentNode&&(this.contentNode.removeEventListener("scroll",this.onScrollHandle.bind(this)),G.scrollTop=this.contentNode.scrollTop)}getExperienceType(){let e=v.AppType.ExperienceType;return this.props.config.isTemplateList&&(e=v.AppType.TemplateType),this.setState({experienceType:e}),`"${e}"`}getQueryString(e){return s.queryString.parse(window.location.search)[e]||""}getParamsAndRefresh(e=!1){const t=this.nextStart,i=this.appListTotal,r=t&&i&&(t>i||t<0)&&e;if(!this.props.user||r)return;e?this.isHadSearchList=!1:(this.nextStart=null,this.appListTotal=null,this.setState({apps:Object(s.Immutable)([])})),this.setState({isLoadSkeleton:!0});const{accessType:n,subclassification:c}=this.state;if(n==a.Default)return this.setState({isLoadSkeleton:!1}),!1;let d=p.My;switch(n){case a.Me:d=c==o.AllFolder?p.My:p.Folder;break;case a.Anyone:d=p.All;break;case a.NotMe:d=c==l.AllGroup?p.OrgAndGroupNotMe:c==l.Org?p.Org:p.Group;break;case a.MyFavorites:d=p.Favorites;break;case a.Public:d=p.PubLic}const h=this.getRequestOption(this.state.filterField,e,d);this.refresh(h,e)}experiencesRefresh(e=!1){const t=this.getRequestOption(this.state.filterField,e);this.setState({isLoadSkeleton:!0}),this.refresh(t,e)}getFolderIdForCreateApp(){const{folderId:e}=this.state,t=!e.includes("root");return e&&!window.jimuConfig.isDevEdition&&t?e:null}render(){const{isDetailContent:e,loading:t,accessType:i,classifyDropdownData:a,sortDropdownData:o,subclassificationValue:l,allFavoritesIdData:r,capabilities:n,updateGroupItemId:p,valid:c,invalidMessage:d,apps:m,isShowAlertPopup:g,alertPopupMessage:v,searchText:f,isPrivilegeCheckEnd:b,isLoadSkeleton:w}=this.state,x=this.props.config.isTemplateList||!1,j=this.getSubclassificationData(i),y=this.getItemRowNumber(),I={deleteApp:this.deleteApp,refreshList:this.refreshList,duplicateAppItem:this.duplicateAppItem,createApp:this.createApp,favoriteTogle:this.favoriteTogle,getFolderList:this.getFolderList,isLoadSkeleton:w,theme:this.props.theme,skeletonNum:y};return c||this.props.isTest?Object(s.jsx)(u.Provider,{value:I},Object(s.jsx)("div",{css:C(this.props.theme),className:"h-100","data-testid":"app-list"},Object(s.jsx)("div",{className:"widget-builder-app-list bg-light-300 h-100"},Object(s.jsx)("div",{className:"banner-con bg-light-300"},Object(s.jsx)("div",{className:"widget-builder-app-list-screen"},Object(s.jsx)("div",{style:{overflow:"hidden"},className:"app-list-search-container"},Object(s.jsx)("div",{className:"app-list-banner d-flex justify-content-between",style:{position:"relative"}},Object(s.jsx)("h2",{className:" list-title"},this.state.filterTitle),!x&&n.canCreateExperience&&Object(s.jsx)(h.Button,{className:"float-left btn-lg pt-0 pb-0 app-list-newapp",size:"lg",type:"primary",onClick:this.newApp},Object(s.jsx)(h.Icon,{className:"app-list-newapp-icon",width:16,height:16,icon:B}),this.nls("newApp"))))),Object(s.jsx)("div",{className:"app-list-filterbar "},Object(s.jsx)("div",{className:"d-flex justify-content-between align-items-center app-list-filterbar-title widget-builder-app-list-screen"},Object(s.jsx)("div",{className:"search-con d-flex position-relative"},Object(s.jsx)(h.TextInput,{className:"float-left app-list-searchbox app-list-h1 flex-sm-fill",placeholder:this.nls("homePageSearch"),onChange:this.searchTextChange,value:f,prefix:this.getSearchInputprefixElement(),suffix:this.getSearchInputSuffixElement(f),ref:e=>{this.searchInput=e},onKeyDown:e=>{this.handleKeydown(e)}})),Object(s.jsx)("div",{className:"text-right align-middle"},this.isShowAccessTypeDropdown()&&Object(s.jsx)(R,{onChange:this.accessChange,value:i,isShowSelectIcon:!0,dropDownData:a}),this.isShowClassifyDropdown()&&j.length>0&&Object(s.jsx)(R,{onChange:this.getSubclassification,value:l,isShowSelectIcon:!0,dropDownData:j}),Object(s.jsx)(R,{onChange:this.filterFieldChange,value:this.state.filterField,isShowSelectIcon:!0,dropDownData:o}),Object(s.jsx)("div",{className:"app-list-switchview-con","data-testid":"icon-view-con"},Object(s.jsx)(h.Button,{icon:!0,type:e?"primary":void 0,title:this.nls("cardView"),className:" app-list-switchview ",onClick:()=>this.switchListView(!0),"data-testid":"icon-view-card"},Object(s.jsx)(h.Icon,{icon:H,width:14,height:14,className:"app-list-iconfill app-list-iconmargin"})),Object(s.jsx)(h.Button,{icon:!0,"data-testid":"icon-view-list",type:e?void 0:"primary",title:this.nls("listView"),className:" app-list-switchview app-list-switchview-btton app-list-switchview-right",onClick:()=>this.switchListView(!1)},Object(s.jsx)(h.Icon,{icon:V,width:14,height:14,className:"app-list-iconfill app-list-iconmargin"}))))))),Object(s.jsx)("div",{className:"app-list-item-scroll-con",ref:e=>this.contentNode=e},Object(s.jsx)("div",{className:"widget-builder-app-list-screen",ref:e=>{this.appListContainer=e}},Object(s.jsx)("div",{className:"app-list-content",id:"itemContent"},Object(s.jsx)(N,{isDetailContent:this.state.isDetailContent,portalUrl:this.props.portalUrl,intl:this.props.intl,folderUrl:this.props.context.folderUrl,apps:m,switchListView:this.switchListView,isTemplateList:x,allFavoritesIdData:r,capabilities:n,updateGroupItemId:p,folderListData:this.filterUserFolder(),isPrivilegeCheckEnd:b,updateAppList:this.updateAppList}))),m.length<1&&!t&&!w&&this.isHadSearchList&&Object(s.jsx)(L,{searchText:f,isTemplateList:x,accessType:i,intl:this.props.intl,portalUrl:this.props.portalUrl,folderUrl:this.props.context.folderUrl}))),this.state.loading&&Object(s.jsx)("div",{className:"loading-con"},Object(s.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-primary-loading"})),Object(s.jsx)(h.AlertPopup,{isOpen:g,title:this.nls("popUpTitle"),hideCancel:!0,toggle:this.toggleAlertPopup},Object(s.jsx)("div",{style:{fontSize:"1rem"}},v)))):Object(s.jsx)("div",{css:C(this.props.theme),className:"invalid-message position-absolute"},d)}}G.scrollTop=0,G.mapExtraStateProps=(e,t)=>({queryObject:e.queryObject})}]))}}}));