System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-arcgis","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/style-setting-components","jimu-ui/basic/color-picker"],(function(e){var t,s,o,i,a,n,r;return{setters:[function(e){t=e},function(e){s=e},function(e){o=e},function(e){i=e},function(e){a=e},function(e){n=e},function(e){r=e}],execute:function(){e(function(e){var t={};function s(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(o,i,function(t){return e[t]}.bind(null,i));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=504)}({0:function(e,s){e.exports=t},1:function(e,t){e.exports=s},14:function(e,t){e.exports=a},17:function(e,t){e.exports=n},2:function(e,t){e.exports=o},28:function(e,t){e.exports=r},4:function(e,t){e.exports=i},504:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return C}));var o=s(0),i=s(1),a=s(28),n=s(2),r=s(14),p=s(58),c="Source",u="Details options",l="Content",d="Media",h="Attachments",g="Last edit info",f="No data message",m="No data found.",j="Text size",S="Respect the source";var b=s(17),x=s(4),y=function(e,t,s,o){return new(s||(s=Promise))((function(i,a){function n(e){try{p(o.next(e))}catch(e){a(e)}}function r(e){try{p(o.throw(e))}catch(e){a(e)}}function p(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,r)}p((o=o.apply(e,t||[])).next())}))};class C extends o.React.PureComponent{constructor(e){super(e),this.supportedDsTypes=Object(o.Immutable)([r.AllDataSourceTypes.FeatureLayer,r.AllDataSourceTypes.SceneLayer]),this.getPortUrl=()=>Object(o.getAppStore)().getState().portalUrl,this.onRadioChange=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("useMapWidget",e)}),this.setState({useMapWidget:e})},this.onPropertyChange=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set(e,t)})},this.onOptionsChanged=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set(t,e)})},this.onToggleUseDataEnabled=e=>{this.props.onSettingChange({id:this.props.id,useDataSourcesEnabled:e})},this.onStyleTypeChanged=e=>{const t=e.target.value;this.props.onSettingChange({id:this.props.id,config:this.props.config.set("styleType",t)})},this.onStyleChanged=(e,t)=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["style",e],t)})},this.onSelectAutoFontSizeType=()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["style","fontSizeType"],p.a.auto)})},this.onSelectCustomFontSizeType=()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["style","fontSizeType"],p.a.custom)})},this.onFontSizeChanged=e=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.setIn(["style","fontSize"],e)})},this.onFilterChange=(e,t)=>{const s=this.props.useDataSources;s&&s[0]&&s[0].dataSourceId===t&&this.props.onSettingChange({id:this.props.id,useDataSources:[s[0].setIn(["query","where"],e).asMutable({deep:!0})]})},this.onSortChange=(e,t)=>{const{useDataSources:s}=this.props;s&&s[0]&&s[0].dataSourceId===t&&this.props.onSettingChange({id:this.props.id,useDataSources:[s[0].setIn(["query","orderBy"],e).asMutable({deep:!0})]})},this.onDataSourceChange=e=>{e&&this.props.onSettingChange({id:this.props.id,useDataSources:e})},this.onDataSourceCreated=e=>{this.dataSource=e,function(e){return y(this,void 0,void 0,(function*(){return yield Object(x.loadArcGISJSAPIModules)(["esri/layers/FeatureLayer"]).then(t=>{const[s]=t;let o;return o=e.layer?e.layer:e.itemId?new s({portalItem:{id:e.itemId,portal:{url:e.portalUrl}}}):new s({url:e.url}),o.load().then(()=>y(this,void 0,void 0,(function*(){return yield Promise.resolve(o)})))}).catch(e=>(console.warn(e),null))}))}(e).then(e=>{var t,s,o,i,a;const n=null===(t=null==e?void 0:e.popupTemplate)||void 0===t?void 0:t.content;let r=!1,c=!1,u=!1,l=!!(null===(s=null==e?void 0:e.popupTemplate)||void 0===s?void 0:s.title),d=null===(o=null==e?void 0:e.popupTemplate)||void 0===o?void 0:o.lastEditInfoEnabled;n&&n.length?n.forEach(e=>{switch(e.type){case"text":r=!0;break;case"media":c=!0;break;case"attachments":u=!0}}):(r=!0,l=!0,c=!1,u=!1,d=!1),r||this.props.onSettingChange({id:this.props.id,config:this.props.config.set("styleType",p.b.custom)});const h=null===(a=null===(i=null==e?void 0:e.capabilities)||void 0===i?void 0:i.data)||void 0===a?void 0:a.supportsAttachment,g=!(!(null==e?void 0:e.editingInfo)||!(null==e?void 0:e.editFieldsInfo));this.setState({popupHasTextContent:r,popupHasMediaContent:c,popupHasAttachmentsContent:u,popupHasTitle:l,popupHasChangeTracking:d,layerHasAttachment:h,layerHasChangeTracking:g})})},this.onDataSourceRemoved=()=>{this.props.onSettingChange({id:this.props.id,useDataSources:[]})},this.onMapWidgetSelected=e=>{this.props.onSettingChange({id:this.props.id,useMapWidgetIds:e})},this.state={useMapWidget:this.props.config.useMapWidget||!1,popupHasTextContent:!0,popupHasMediaContent:!1,popupHasAttachmentsContent:!1,popupHasTitle:!1,popupHasChangeTracking:!1,layerHasAttachment:!1,layerHasChangeTracking:!1}}getStyleConfig(){return this.props.config.style?this.props.config.style:{textColor:"",fontSize:{distance:0,unit:i.UnitTypes.PIXEL},backgroundColor:""}}getCapabilities(){return{supportsTitle:this.state.popupHasTitle,supportsMedia:this.state.popupHasMediaContent,supportsAttachment:this.state.popupHasAttachmentsContent&&this.state.layerHasAttachment,supportsChangeTracking:this.state.popupHasChangeTracking&&this.state.layerHasChangeTracking}}render(){const e=[];if(this.props.useDataSources)for(let t=0;t<this.props.useDataSources.length;t++)e.push(this.props.useDataSources[t].dataSourceId);const t=this.props.useDataSources&&this.props.useDataSources[0];let s=null,x=null,y=null,C=null;let O,M,v;return t&&t.dataSourceId&&(y=Object(o.jsx)(o.DataSourceComponent,{useDataSource:t,onDataSourceCreated:this.onDataSourceCreated,query:null})),x=Object(o.jsx)(n.SettingSection,{title:this.props.intl.formatMessage({id:"sourceLabel",defaultMessage:c})},Object(o.jsx)(n.SettingRow,null,Object(o.jsx)(r.DataSourceSelector,{types:this.supportedDsTypes,useDataSourcesEnabled:!0,mustUseDataSource:!0,useDataSources:this.props.useDataSources,onChange:this.onDataSourceChange,widgetId:this.props.id}),y)),C=Object(o.jsx)(n.SettingSection,{className:"map-selector-section",title:this.props.intl.formatMessage({id:"sourceDescript",defaultMessage:"map widget **"})},Object(o.jsx)(n.SettingRow,null,Object(o.jsx)("div",{className:"map-selector-descript"},this.props.intl.formatMessage({id:"sourceDescript",defaultMessage:"set an interactive map **"}))),Object(o.jsx)(n.SettingRow,null,Object(o.jsx)(n.JimuMapViewSelector,{onSelect:this.onMapWidgetSelected,useMapWidgetIds:this.props.useMapWidgetIds}))),s=this.state.useMapWidget?C:x,this.state.popupHasTextContent&&(M=Object(o.jsx)(i.Select,{size:"sm",value:this.props.config&&this.props.config.styleType,onChange:this.onStyleTypeChanged,className:""},Object(o.jsx)("option",{key:2,value:p.b.usePopupDefined},Object(o.jsx)(o.FormattedMessage,{id:"respectTheSource",defaultMessage:S})),Object(o.jsx)("option",{key:3,value:p.b.custom},Object(o.jsx)(o.FormattedMessage,{id:"custom",defaultMessage:"abc"})))),"custom"===this.props.config.styleType&&(v=this.props.config.style.fontSizeType===p.a.custom?Object(o.jsx)(b.InputUnit,{style:{width:"6.5rem"},units:[i.UnitTypes.PIXEL,i.UnitTypes.PERCENTAGE],className:"item",min:1,value:this.getStyleConfig().fontSize,onChange:this.onFontSizeChanged}):Object(o.jsx)(i.Button,{style:{width:"6.5rem"},disabled:!0,size:"sm"},Object(o.jsx)(o.FormattedMessage,{id:"auto",defaultMessage:"Auto"})),O=Object(o.jsx)("div",null,Object(o.jsx)(n.SettingRow,{className:"mt-3",label:Object(o.jsx)(o.FormattedMessage,{id:"textSize",defaultMessage:j})},Object(o.jsx)(i.ButtonGroup,null,Object(o.jsx)(i.Dropdown,{activeIcon:!0,className:"dropdown"},Object(o.jsx)(i.DropdownButton,{size:"sm",style:{width:"auto"},icon:!0}),Object(o.jsx)(i.DropdownMenu,{className:"dropdown-menu",zIndex:"55",alignment:"start"},Object(o.jsx)(i.DropdownItem,{key:1,active:this.props.config.style.fontSizeType===p.a.auto,onClick:this.onSelectAutoFontSizeType},Object(o.jsx)(o.FormattedMessage,{id:"auto",defaultMessage:"Auto"})),Object(o.jsx)(i.DropdownItem,{key:2,active:this.props.config.style.fontSizeType===p.a.custom,onClick:this.onSelectCustomFontSizeType},Object(o.jsx)(o.FormattedMessage,{id:"custom",defaultMessage:"Custom"})))),v)),Object(o.jsx)(n.SettingRow,{label:Object(o.jsx)(o.FormattedMessage,{id:"textColor",defaultMessage:"Text color"})},Object(o.jsx)(a.ThemeColorPicker,{specificTheme:this.props.appTheme,value:this.getStyleConfig().textColor,onChange:e=>this.onStyleChanged("textColor",e)})))),Object(o.jsx)("div",{css:(T=this.props.theme,o.css`
    .widget-setting-featureInfo{
      font-weight: lighter;
      font-size: 13px;

      .second-header {
        color: ${T.colors.palette.dark[600]};	
      }

      .webmap-thumbnail{
        cursor: auto;
        width: 100%;
        height: 120px;
        overflow: hidden;
        padding: 1px;
        border: ${o.polished.rem(2)} solid initial;
        img, div{
          width: 100%;
          height: 100%;
        }
      }

      .featureInfo-options-part{
        background-color: ${T.colors.palette.light[200]};
        padding: 0.5rem;
      }

      .featureInfo-options{
        .featureInfo-options-item{
          display: flex;
          justify-content: space-between;
          /* margin-bottom: 8px; */
        }
      }
    }
  `)},Object(o.jsx)("div",{className:"widget-setting-featureInfo"},s,Object(o.jsx)(n.SettingSection,{title:this.props.intl.formatMessage({id:"detailOptions",defaultMessage:u})},Object(o.jsx)("div",{className:"featureInfo-options-part"},Object(o.jsx)(n.SettingRow,{label:Object(o.jsx)(o.FormattedMessage,{id:"title",defaultMessage:"Title"})},Object(o.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsTitle,checked:this.props.config&&this.props.config.title,"data-key":"title",onChange:e=>{this.onOptionsChanged(e.target.checked,"title")}})),Object(o.jsx)(n.SettingRow,{label:Object(o.jsx)(o.FormattedMessage,{id:"content",defaultMessage:l})},Object(o.jsx)(i.Checkbox,{className:"can-x-switch",checked:this.props.config&&this.props.config.fields,"data-key":"content",onChange:e=>{this.onOptionsChanged(e.target.checked,"fields")}})),Object(o.jsx)(n.SettingRow,{label:Object(o.jsx)(o.FormattedMessage,{id:"media",defaultMessage:d})},Object(o.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsMedia,checked:this.props.config&&this.props.config.media,"data-key":"media",onChange:e=>{this.onOptionsChanged(e.target.checked,"media")}})),Object(o.jsx)(n.SettingRow,{label:Object(o.jsx)(o.FormattedMessage,{id:"attachments",defaultMessage:h})},Object(o.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsAttachment,checked:this.props.config&&this.props.config.attachments,"data-key":"attachments",onChange:e=>{this.onOptionsChanged(e.target.checked,"attachments")}})),Object(o.jsx)(n.SettingRow,{label:Object(o.jsx)(o.FormattedMessage,{id:"lastEditInfo",defaultMessage:g})},Object(o.jsx)(i.Checkbox,{className:"can-x-switch",disabled:!this.getCapabilities().supportsChangeTracking,checked:this.props.config&&this.props.config.lastEditInfo,"data-key":"lastEditInfo",onChange:e=>{this.onOptionsChanged(e.target.checked,"lastEditInfo")}})))),Object(o.jsx)(n.SettingSection,{title:this.props.intl.formatMessage({id:"style",defaultMessage:"Style"})},M,O),Object(o.jsx)(n.SettingSection,{title:this.props.intl.formatMessage({id:"general",defaultMessage:"General"})},Object(o.jsx)("label",{className:"second-header"},Object(o.jsx)(o.FormattedMessage,{id:"noDataMessage",defaultMessage:f})),Object(o.jsx)(i.TextArea,{className:"w-100",name:"text",id:"noDeataMessageDefaultText",value:this.props.config.noDataMessage||this.props.intl.formatMessage({id:"noDeataMessageDefaultText",defaultMessage:m}),onBlur:e=>{this.onPropertyChange("noDataMessage",e.target.value)}})),null));var T}}C.mapExtraStateProps=e=>({dsJsons:e.appStateInBuilder.appConfig.dataSources,appTheme:e&&e.appStateInBuilder&&e.appStateInBuilder.theme})},58:function(e,t,s){"use strict";var o,i;s.d(t,"b",(function(){return o})),s.d(t,"a",(function(){return i})),function(e){e.syncWithTheme="syncWithTheme",e.usePopupDefined="usePopupDefined",e.custom="custom"}(o||(o={})),function(e){e.auto="auto",e.custom="custom"}(i||(i={}))}}))}}}));