System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-for-builder","jimu-ui/advanced/data-source-selector"],(function(e){var t,s,i,a,n;return{setters:[function(e){t=e},function(e){s=e},function(e){i=e},function(e){a=e},function(e){n=e}],execute:function(){e(function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=514)}({0:function(e,s){e.exports=t},1:function(e,t){e.exports=s},10:function(e,t){e.exports=a},100:function(e,t,s){"use strict";var i,a=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},n=function(){var e={};return function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}e[t]=s}return e[t]}}(),r=[];function o(e){for(var t=-1,s=0;s<r.length;s++)if(r[s].identifier===e){t=s;break}return t}function l(e,t){for(var s={},i=[],a=0;a<e.length;a++){var n=e[a],l=t.base?n[0]+t.base:n[0],c=s[l]||0,d="".concat(l," ").concat(c);s[l]=c+1;var m=o(d),g={css:n[1],media:n[2],sourceMap:n[3]};-1!==m?(r[m].references++,r[m].updater(g)):r.push({identifier:d,updater:p(g,t),references:1}),i.push(d)}return i}function c(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var a=s.nc;a&&(i.nonce=a)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var r=n(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var d,m=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function g(e,t,s,i){var a=s?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=m(t,a);else{var n=document.createTextNode(a),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(n,r[t]):e.appendChild(n)}}function u(e,t,s){var i=s.css,a=s.media,n=s.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var h=null,f=0;function p(e,t){var s,i,a;if(t.singleton){var n=f++;s=h||(h=c(t)),i=g.bind(null,s,n,!1),a=g.bind(null,s,n,!0)}else s=c(t),i=u.bind(null,s,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(s)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=a());var s=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<s.length;i++){var a=o(s[i]);r[a].references--}for(var n=l(e,t),c=0;c<s.length;c++){var d=o(s[c]);0===r[d].references&&(r[d].updater(),r.splice(d,1))}s=n}}}},101:function(e,t,s){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s=e(t);return t[2]?"@media ".concat(t[2]," {").concat(s,"}"):s})).join("")},t.i=function(e,s,i){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(i)for(var n=0;n<this.length;n++){var r=this[n][0];null!=r&&(a[r]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);i&&a[l[0]]||(s&&(l[2]?l[2]="".concat(s," and ").concat(l[2]):l[2]=s),t.push(l))}},t}},102:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s(0),a=function(e,t,s,i){return new(s||(s=Promise))((function(a,n){function r(e){try{l(i.next(e))}catch(e){n(e)}}function o(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))};class n{constructor(){this.defaultVersion="sde.DEFAULT",this.isOrgUser=!1,this.uniqueURLs=[]}static getInstance(){return n.instance||(n.instance=new n),n.instance}getUniqueVMSURL(e){return new Promise((t,s)=>{const n=i.DataSourceManager.getInstance().getDataSources(),r=[],o=[];for(const t in n)if(e){if(t.indexOf(e)>-1&&n[t].type==i.DataSourceTypes.FeatureLayer){const e=n[t].getDataSourceJson();if(e.url.indexOf("FeatureServer")>=0){const t=e.url.substring(0,e.url.indexOf("FeatureServer"));-1==r.indexOf(t)&&r.push(t)}}}else if(n[t].type==i.DataSourceTypes.FeatureLayer){const e=n[t].getDataSourceJson();if(e.url.indexOf("FeatureServer")>=0){const t=e.url.substring(0,e.url.indexOf("FeatureServer"));-1==r.indexOf(t)&&r.push(t)}}if(r.length>0){const e=r.map((e,t)=>a(this,void 0,void 0,(function*(){let t=!1;if(t=yield this.checkValidVMS(e),t){const t=yield this.serviceNameLookup(e);o.push({url:e,name:t})}})));Promise.all(e).then(e=>a(this,void 0,void 0,(function*(){this.uniqueURLs=o,t(o)})))}else this.uniqueURLs=o,t(o)})}checkValidVMS(e,t){return a(this,void 0,void 0,(function*(){let s=!1,i=e;i.indexOf("FeatureServer")>=0&&(i=i.substring(0,i.indexOf("FeatureServer"))),i.indexOf("MapServer")>=0&&(i=i.substring(0,i.indexOf("MapServer")));const a=i+"VersionManagementServer";let n=null;return n=t?{f:"json",token:t}:{f:"json"},s=yield this.requestService({method:"POST",url:a,params:n}).then(e=>!!e.hasOwnProperty("name")&&"Version Management Server"===e.name).catch(e=>!1),s}))}getVersions(e,t,s){return new Promise((i,a)=>{if(t){let e=t;e.indexOf("FeatureServer")>=0&&(e=e.substring(0,e.indexOf("FeatureServer"))),e.indexOf("MapServer")>=0&&(e=e.substring(0,e.indexOf("MapServer"))),i(s?this.requestVersions(e,s):this.requestVersions(e))}else if(0==this.uniqueURLs.length)this.getUniqueVMSURL().then(t=>{let a=t[0];e&&(a=t.filter(t=>t.name===e));const n=a[0].url;i(s?this.requestVersions(n,s):this.requestVersions(n))});else{let t=this.uniqueURLs[0];e&&(t=this.uniqueURLs.filter(t=>t.name===e));const a=t[0].url;i(s?this.requestVersions(a,s):this.requestVersions(a))}})}changeGDBVersion(e,t){let s=!1;for(const a in t)if(t[a].type==i.DataSourceTypes.FeatureLayer){this.getLayerObject(t[a]).changeGDBVersion(e),s=!0}return s}createGDBVersion(e,t,s,i,a,n){return new Promise((r,o)=>{const l={};let c=null;if(this.isOrgUser){const o=this.checkValidVersionName(e.versionName);if(o.success){if(a)c=a,c.indexOf("FeatureServer")>=0?(c=c.substring(0,c.indexOf("FeatureServer")),c+="VersionManagementServer/create"):c.indexOf("MapServer")>=0?(c=c.substring(0,c.indexOf("MapServer")),c+="VersionManagementServer/create"):c+="VersionManagementServer/create";else{let e=this.uniqueURLs[0];i&&(e=this.uniqueURLs.filter(e=>e.name===i));c=e[0].url+"VersionManagementServer/create"}this.requestService({method:"POST",url:c,params:{f:"json",versionName:e.versionName,description:e.versionDescription,accessPermission:e.versionScope,token:t}}).then(e=>{n&&e.hasOwnProperty("versionInfo")&&this.changeGDBVersion(e.versionInfo.versionName,s),r(e)}).catch(e=>{r(e)})}else r(o)}else r(l)})}deleteGDBVersion(e,t,s,a,n){return new Promise((r,o)=>{if("sde.default"!==e.toLowerCase()){const o={};let l=null;if(this.isOrgUser){if(n)l=n,l.indexOf("FeatureServer")>=0?(l=l.substring(0,l.indexOf("FeatureServer")),l+="VersionManagementServer/delete"):l.indexOf("MapServer")>=0?(l=l.substring(0,l.indexOf("MapServer")),l+="VersionManagementServer/delete"):l+="VersionManagementServer/delete";else{let e=this.uniqueURLs[0];a&&(e=this.uniqueURLs.filter(e=>e.name===a));l=e[0].url+"VersionManagementServer/delete"}this.requestService({method:"POST",url:l,params:{f:"json",versionName:e,sessionId:t,token:t}}).then(t=>{const a=[];for(const t in s)if(s[t].type==i.DataSourceTypes.FeatureLayer){this.getLayerObject(s[t]).getGDBVersion()===e&&(a[t]=s[t])}this.changeGDBVersion(this.defaultVersion,a),t.version=this.defaultVersion,r(t)}).catch(e=>{r(e)})}else r(o)}else r({error:{message:"Cannot delete Default version"}})})}alterGDBVersion(e,t,s,i,a,n){return new Promise((r,o)=>{const l={};let c=null;if(this.isOrgUser){const o=this.checkValidVersionName(e.versionName);if(o.success){let o=e.versionGuid.replace("{","");if(o=o.replace("}",""),a)c=a,c.indexOf("FeatureServer")>=0?(c=c.substring(0,c.indexOf("FeatureServer")),c=c+"VersionManagementServer/versions/"+o+"/alter"):c.indexOf("MapServer")>=0?(c=c.substring(0,c.indexOf("MapServer")),c=c+"VersionManagementServer/versions/"+o+"/alter"):c=c+"VersionManagementServer/versions/"+o+"/alter";else{let e=this.uniqueURLs[0];i&&(e=this.uniqueURLs.filter(e=>e.name===i));c=e[0].url+"VersionManagementServer/versions/"+o+"/alter"}this.requestService({method:"POST",url:c,params:{f:"json",versionName:e.versionName,description:e.versionDescription,accessPermission:e.versionScope,ownerName:e.versionOwner,token:t}}).then(t=>{n&&this.changeGDBVersion(e.versionOwner+"."+e.versionName,s),r(t)}).catch(e=>{r(e)})}else r(o)}else r(l)})}getVersionState(e,t,s,i){return new Promise((a,n)=>{let r=null,o=e.versionGuid.replace("{","");if(o=o.replace("}",""),i)r=i,r.indexOf("FeatureServer")>=0?(r=r.substring(0,r.indexOf("FeatureServer")),r=r+"VersionManagementServer/versions/"+o):r.indexOf("MapServer")>=0?(r=r.substring(0,r.indexOf("MapServer")),r=r+"VersionManagementServer/versions/"+o):r=r+"VersionManagementServer/versions/"+o;else{let e=this.uniqueURLs[0];s&&(e=this.uniqueURLs.filter(e=>e.name===s));r=e[0].url+"VersionManagementServer/versions/"+o}this.requestService({method:"POST",url:r,params:{f:"json",token:t}}).then(e=>{a(e)}).catch(e=>{a(e)})})}checkValidVersionName(e){const t={success:!0,error:{message:"Version is valid"}};return e.length<=62?" "===e.substring(0,1)?(t.success=!1,t.error.message="Version name can not start with a space"):e.match(/(?=.*[.;'"])/)&&(t.success=!1,t.error.message="Version name can not have a period, semicolon, and single or double quotes"):(t.success=!1,t.error.message="Exceeded 62 characters for version name"),t}requestVersions(e,t){return new Promise((s,i)=>{let n=e,r={};t?(n+="VersionManagementServer/versionInfos",r={f:"json",includeHidden:!0,token:t},this.isOrgUser=!0):(n+="VersionManagementServer/versions",r={f:"json",includeHidden:!0},this.isOrgUser=!1),this.requestService({method:"POST",url:n,params:r}).then(i=>a(this,void 0,void 0,(function*(){i.hasOwnProperty("error")?t?e?(console.log("second pass, service url"),this.getVersions(e).then(e=>{e.canManage=!1,s(e)})):(console.log("second pass, no service url"),this.getVersions().then(e=>{e.canManage=!1,s(e)})):(i.canManage=!1,s(i)):(i.canManage=!0,s(i))}))).catch(e=>{s(e)})})}getLayerObject(e){return e.type,i.DataSourceTypes.FeatureLayer,e}serviceNameLookup(e){return new Promise((t,s)=>{const i=e+"FeatureServer";this.requestService({method:"POST",url:i,params:{f:"json"}}).then(e=>{e.hasOwnProperty("documentInfo")?t(e.documentInfo.Title):t("")}).catch(e=>{t(e)})})}versionRead(e){return new Promise((t,s)=>{let i=this.uniqueURLs[0];var a=e.versionGuid.replace("{","");i=i+"VersionManagementServer/versions/"+(a=a.replace("}",""))+"/"+e.action+"Reading/",this.requestService({method:"POST",url:i,params:{f:"json",sessionId:e.versionGuid,token:e.token}}).then(e=>{t(e)})})}searchPortalUsers(e,t,s){return new Promise((i,a)=>{const n=e+"/sharing/rest/community/users";this.requestService({method:"POST",url:n,params:{f:"json",q:t,token:s}}).then(e=>{i(e)}).catch(e=>{i(e)})})}requestService(e){return new Promise((function(t,s){const a={params:e.params,httpMethod:e.method};i.esri.restRequest.request(e.url,a).then(e=>{t(e)}).catch(e=>{t(e)})}))}}},121:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 2c.291 0 .527.231.527.516v9.508L12.1 8.527a.535.535 0 01.746 0 .508.508 0 010 .73L8 14 3.154 9.257a.508.508 0 010-.73.535.535 0 01.746 0l3.573 3.497V2.516C7.473 2.231 7.709 2 8 2z" fill="#000" fill-rule="nonzero"></path></svg>'},14:function(e,t){e.exports=n},154:function(e,t,s){"use strict";var i=s(101),a=s.n(i)()((function(e){return e[1]}));a.push([e.i,".css-rygcro th,.css-rygcro td{padding:0.5rem 0.5rem !important}\n",""]),t.a=a},2:function(e,t){e.exports=i},236:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 14a.522.522 0 01-.527-.516V3.976L3.9 7.473a.535.535 0 01-.746 0 .508.508 0 010-.73L8 2l4.846 4.743a.508.508 0 010 .73.535.535 0 01-.746 0L8.527 3.976v9.508A.522.522 0 018 14z" fill="#000" fill-rule="nonzero"></path></svg>'},237:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.173 0a.5.5 0 01.5.5v14.7a.8.8 0 01-1.407.52L.12 10.712a.5.5 0 01.76-.652l3.793 4.598V.5a.5.5 0 01.5-.5zm5.654 16a.5.5 0 01-.5-.5V.8a.8.8 0 011.407-.52l4.146 5.008a.5.5 0 01-.76.652l-3.793-4.598V15.5a.5.5 0 01-.5.5z" fill="#000" fill-rule="nonzero"></path></svg>'},238:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M16 32C7.163 32 0 24.837 0 16S7.163 0 16 0s16 7.163 16 16-7.163 16-16 16zm0-4c6.627 0 12-5.373 12-12S22.627 4 16 4 4 9.373 4 16s5.373 12 12 12zm0-17.333a2 2 0 11-.001-3.999A2 2 0 0116 10.667zm0 2.666a2 2 0 012 2v8a2 2 0 11-4 0v-8a2 2 0 012-2z"></path></svg>'},239:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 0c4.4 0 8 3.6 8 8s-3.6 8-8 8-8-3.6-8-8 3.6-8 8-8zm0 12a1 1 0 100 2 1 1 0 000-2zM7.938 2C6.387 2 5.058 3.06 4.57 4.465c-.07.174-.07.342-.07.342a.74.74 0 00.765.793l.114-.007c.458-.053.775-.314.947-.742.09-.189.123-.238.14-.262a1.778 1.778 0 011.47-.789c.98 0 1.782.81 1.782 1.8 0 .54-.178.99-.535 1.26L8.116 8.03c-.578.51-.921 1.198-1.03 1.968a.701.701 0 00-.006.073v.133a.855.855 0 00.858.796l.104-.006c.45-.049.817-.409.849-.845l.037-.185c.151-.652.474-1.046.969-1.484.495-.438.801-.81.801-.81.446-.54.802-1.26.802-2.07C11.5 3.62 9.897 2 7.938 2z" fill="#000" fill-rule="evenodd"></path></svg>'},240:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgdmlld0JveD0iMCAwIDEwOCAxMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cmVjdCB4PSIxNiIgeT0iMzYiIHdpZHRoPSI3NiIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSIxNiIgeT0iNDQiIHdpZHRoPSI5IiBoZWlnaHQ9IjkiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTEgNDVIMjhWNTJIOTFWNDVaTTI3IDQ0VjUzSDkyVjQ0SDI3WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik01MCAzMEg4VjEwMEgxMDBWMzBINThMNTQgMjZMNTAgMzBaTTU0IDI3LjQxNDJMNTAuNDE0MiAzMUg5Vjk5SDk5VjMxSDU3LjU4NThMNTQgMjcuNDE0MloiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGQ9Ik04IDhMMTAwIDhWMjRIOFY4WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iMTIiIHk9IjEzIiB3aWR0aD0iNzQiIGhlaWdodD0iNiIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZD0iTTk2IDE4TDkwIDE4TDkzIDE1TDk2IDE4WiIgZmlsbD0iIzZBNkE2QSIvPg0KPHJlY3QgeD0iMjciIHk9IjU4IiB3aWR0aD0iNjUiIGhlaWdodD0iNCIgZmlsbD0iIzZBNkE2QSIvPg0KPGNpcmNsZSBjeD0iMjAiIGN5PSI2MCIgcj0iMyIgZmlsbD0iIzk5OTk5OSIvPg0KPHJlY3QgeD0iMjciIHk9IjY4IiB3aWR0aD0iNjUiIGhlaWdodD0iNCIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yMCA3MkMyMS4xMDQ2IDcyIDIyIDcxLjEwNDYgMjIgNzBDMjIgNjguODk1NCAyMS4xMDQ2IDY4IDIwIDY4QzE4Ljg5NTQgNjggMTggNjguODk1NCAxOCA3MEMxOCA3MS4xMDQ2IDE4Ljg5NTQgNzIgMjAgNzJaTTIwIDczQzIxLjY1NjkgNzMgMjMgNzEuNjU2OSAyMyA3MEMyMyA2OC4zNDMxIDIxLjY1NjkgNjcgMjAgNjdDMTguMzQzMSA2NyAxNyA2OC4zNDMxIDE3IDcwQzE3IDcxLjY1NjkgMTguMzQzMSA3MyAyMCA3M1oiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjI3IiB5PSI3OCIgd2lkdGg9IjY1IiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjAgODJDMjEuMTA0NiA4MiAyMiA4MS4xMDQ2IDIyIDgwQzIyIDc4Ljg5NTQgMjEuMTA0NiA3OCAyMCA3OEMxOC44OTU0IDc4IDE4IDc4Ljg5NTQgMTggODBDMTggODEuMTA0NiAxOC44OTU0IDgyIDIwIDgyWk0yMCA4M0MyMS42NTY5IDgzIDIzIDgxLjY1NjkgMjMgODBDMjMgNzguMzQzMSAyMS42NTY5IDc3IDIwIDc3QzE4LjM0MzEgNzcgMTcgNzguMzQzMSAxNyA4MEMxNyA4MS42NTY5IDE4LjM0MzEgODMgMjAgODNaIiBmaWxsPSIjMzYzNjM2Ii8+DQo8cGF0aCBkPSJNMjQuOTE0NyA5NUwyNS41OTA1IDk1LjczNzJMMjguNzE5OCA5Mi44Njg2TDI1LjU5MDUgOTBMMjQuOTE0NyA5MC43MzcyTDI3LjIzOTkgOTIuODY4NkwyNC45MTQ3IDk1WiIgZmlsbD0iIzZBNkE2QSIvPg0KPHBhdGggZD0iTTE5LjgwNTEgOTAuNzM3MkwxOS4xMjk0IDkwLjAwMDFMMTYgOTIuODY4N0wxOS4xMjk0IDk1LjczNzJMMTkuODA1MSA5NS4wMDAxTDE3LjQ3OTkgOTIuODY4N0wxOS44MDUxIDkwLjczNzJaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTkyIDg3TDE2IDg3TDE2IDg2TDkyIDg2TDkyIDg3WiIgZmlsbD0iIzM2MzYzNiIvPg0KPC9zdmc+DQo="},241:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgdmlld0JveD0iMCAwIDEwOCAxMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cmVjdCB4PSI4IiB5PSI4IiB3aWR0aD0iOTIiIGhlaWdodD0iMTYiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjEzIiB5PSIxMyIgd2lkdGg9IjczIiBoZWlnaHQ9IjYiIGZpbGw9IiM2QTZBNkEiLz4NCjxwYXRoIGQ9Ik04IDg2SDEwMFY4N0g4Vjg2WiIgZmlsbD0iIzM2MzYzNiIvPg0KPHBhdGggZD0iTTE2LjkxNDcgOTVMMTcuNTkwNSA5NS43MzcyTDIwLjcxOTggOTIuODY4NkwxNy41OTA1IDkwTDE2LjkxNDcgOTAuNzM3MkwxOS4yMzk5IDkyLjg2ODZMMTYuOTE0NyA5NVoiIGZpbGw9IiM2QTZBNkEiLz4NCjxwYXRoIGQ9Ik0xMS44MDUxIDkwLjczNzJMMTEuMTI5NCA5MC4wMDAxTDggOTIuODY4N0wxMS4xMjk0IDk1LjczNzJMMTEuODA1MSA5NS4wMDAxTDkuNDc5ODkgOTIuODY4N0wxMS44MDUxIDkwLjczNzJaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cGF0aCBkPSJNOTYgMThMOTAgMThMOTMgMTVMOTYgMThaIiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI4IiB5PSIyNyIgd2lkdGg9IjUwIiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjgwIiB5PSI5MiIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNOTkgMzVIMjBWNDJIOTlWMzVaTTE5IDM0VjQzSDEwMFYzNEgxOVoiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjgiIHk9IjM0IiB3aWR0aD0iOSIgaGVpZ2h0PSI5IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSIxOSIgeT0iNTgiIHdpZHRoPSIyMSIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI0NSIgeT0iNTgiIHdpZHRoPSIyMiIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8cmVjdCB4PSI3MyIgeT0iNTgiIHdpZHRoPSIyNyIgaGVpZ2h0PSI0IiBmaWxsPSIjNkE2QTZBIi8+DQo8Y2lyY2xlIGN4PSIxMiIgY3k9IjYwIiByPSIzIiBmaWxsPSIjOTk5OTk5Ii8+DQo8cmVjdCB4PSIxOSIgeT0iNjciIHdpZHRoPSIyMSIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSI0NSIgeT0iNjciIHdpZHRoPSIyMiIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSI3MyIgeT0iNjciIHdpZHRoPSIyNyIgaGVpZ2h0PSI0IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyIDcxQzEzLjEwNDYgNzEgMTQgNzAuMTA0NiAxNCA2OUMxNCA2Ny44OTU0IDEzLjEwNDYgNjcgMTIgNjdDMTAuODk1NCA2NyAxMCA2Ny44OTU0IDEwIDY5QzEwIDcwLjEwNDYgMTAuODk1NCA3MSAxMiA3MVpNMTIgNzJDMTMuNjU2OSA3MiAxNSA3MC42NTY5IDE1IDY5QzE1IDY3LjM0MzEgMTMuNjU2OSA2NiAxMiA2NkMxMC4zNDMxIDY2IDkgNjcuMzQzMSA5IDY5QzkgNzAuNjU2OSAxMC4zNDMxIDcyIDEyIDcyWiIgZmlsbD0iIzM2MzYzNiIvPg0KPHJlY3QgeD0iOCIgeT0iNDYiIHdpZHRoPSI5MiIgaGVpZ2h0PSI4IiBmaWxsPSIjMzYzNjM2Ii8+DQo8cmVjdCB4PSIxMCIgeT0iNDgiIHdpZHRoPSI0IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjE5IiB5PSI0OCIgd2lkdGg9IjE2IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjQ1IiB5PSI0OCIgd2lkdGg9IjE3IiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjczIiB5PSI0OCIgd2lkdGg9IjIzIiBoZWlnaHQ9IjQiIGZpbGw9IiM2QTZBNkEiLz4NCjxyZWN0IHg9IjE5IiB5PSI3OCIgd2lkdGg9IjIxIiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjQ1IiB5PSI3OCIgd2lkdGg9IjIyIiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxyZWN0IHg9IjczIiB5PSI3OCIgd2lkdGg9IjI3IiBoZWlnaHQ9IjQiIGZpbGw9IiMzNjM2MzYiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTIgODJDMTMuMTA0NiA4MiAxNCA4MS4xMDQ2IDE0IDgwQzE0IDc4Ljg5NTQgMTMuMTA0NiA3OCAxMiA3OEMxMC44OTU0IDc4IDEwIDc4Ljg5NTQgMTAgODBDMTAgODEuMTA0NiAxMC44OTU0IDgyIDEyIDgyWk0xMiA4M0MxMy42NTY5IDgzIDE1IDgxLjY1NjkgMTUgODBDMTUgNzguMzQzMSAxMy42NTY5IDc3IDEyIDc3QzEwLjM0MzEgNzcgOSA3OC4zNDMxIDkgODBDOSA4MS42NTY5IDEwLjM0MzEgODMgMTIgODNaIiBmaWxsPSIjMzYzNjM2Ii8+DQo8L3N2Zz4NCg=="},514:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return y}));var i=s(0),a=s(10),n={alertMessagesAlreadyAdded:"Service already added",alertMessagesErrorAlert:"An error has occurred",alertMessagesNotValid:"Not a valid versioned service",allowancesAutoRefreshList:"Automatically refresh version list",allowancesChangeOwner:"Change owner",allowancesChangePrivileges:"Change access privileges",allowancesCreateNew:"Create new",allowancesDeleteExisting:"Delete existing",allowancesPosting:"Post changes",allowancesSwitch:"Switch versions",allowancesUpdateName:"Update name",allowancesUpdateDescription:"Update description",fieldColumnsAccess:"Access",fieldColumnsColumnAvailable:"Available",fieldColumnsColumnShow:"Show",fieldColumnsCommonAncestorDate:"Common Ancestor Date",fieldColumnsCreationDate:"Creation Date",fieldColumnsDescription:"Description",fieldColumnsEvaluationDate:"Evaluation Date",fieldColumnsModifiedDate:"Modified Date",fieldColumnsPreviousAncestorDate:"Previous Ancestor Date",fieldColumnsReconcileDate:"Reconcile Date",fieldColumnsVersionGuid:"Version GUID",fieldColumnsVersionId:"Version ID",fieldColumnsVersionName:"Name",fieldColumnsVersionOwner:"Owner",layoutStyleTitle:"Arrangement style",layoutStyleBasic:"Basic",layoutStyleAdvanced:"Advanced",settingsSectionsAllowAll:"All",settingsSectionsAllowCapability:"Allow",settingsSectionsExpandBasic:"Expand versions list",settingsSectionsGeneralSettings:"General settings",settingsSectionsMinutes:"Minute(s)",settingsSectionsRecordsPage:"Number of records per page",settingsSectionsSearchName:"Search version name",settingsSectionsSelectVersion:"Select version to load on start",settingsSectionsTooltipNumber:"Enter a number from 1 to 999",settingsSectionsVersionCapability:"Management capability",settingsSectionsVersionCapabilityTooltip:"Version Management capability is based on a combination of the active portal user's privileges and the access permission of the version. End users lacking the required privileges will not have access to version management operations.",settingsSectionsVersionInfo:"Version information",settingsSectionsVersionInfoTooltip:"Version information is based on a combination of the active portal user's privileges and the access permission of the version. End users lacking the required privileges will not see all version information.",settingsSectionsVersionService:"Version management services",settingsSectionsVersionServiceHelp:"Help"},r=s(1),o=s(2),l=s(14),c=s(102),d=s(100),m=s.n(d),g=s(154),u={insert:"head",singleton:!1},h=(m()(g.a,u),g.a.locals,function(e,t,s,i){return new(s||(s=Promise))((function(a,n){function r(e){try{l(i.next(e))}catch(e){n(e)}}function o(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))});const f=s(66),p=s(236),I=s(121),v=s(237),S=s(238),M=s(239);class y extends a.BaseWidgetSetting{constructor(e){super(e),this.sidePopperTrigger=i.React.createRef(),this.defaultVersion="sde.DEFAULT",this.vms=c.a.getInstance(),this.formatMessage=(e,t)=>{const s=Object.assign({},n,r.defaultMessages,i.defaultMessages);return this.props.intl.formatMessage({id:e,defaultMessage:s[e]},t)},this.fieldColumns=[{field:"access",alias:this.formatMessage("fieldColumnsAccess"),show:!0,sort:"desc",order:2,available:!0},{field:"commonAncestorDate",alias:this.formatMessage("fieldColumnsCommonAncestorDate"),show:!1,sort:"desc",order:5,available:!0},{field:"creationDate",alias:this.formatMessage("fieldColumnsCreationDate"),show:!1,sort:"desc",order:3,available:!0},{field:"description",alias:this.formatMessage("fieldColumnsDescription"),show:!1,sort:"desc",order:4,available:!0},{field:"evaluationDate",alias:this.formatMessage("fieldColumnsEvaluationDate"),show:!1,sort:"desc",order:6,available:!0},{field:"modifiedDate",alias:this.formatMessage("fieldColumnsModifiedDate"),show:!0,sort:"desc",order:7,available:!0},{field:"previousAncestorDate",alias:this.formatMessage("fieldColumnsPreviousAncestorDate"),show:!1,sort:"desc",order:8,available:!0},{field:"reconcileDate",alias:this.formatMessage("fieldColumnsReconcileDate"),show:!1,sort:"desc",order:9,available:!0},{field:"versionGuid",alias:this.formatMessage("fieldColumnsVersionGuid"),show:!1,sort:"desc",order:10,available:!0},{field:"versionId",alias:this.formatMessage("fieldColumnsVersionId"),show:!1,sort:"desc",order:11,available:!0},{field:"versionName",alias:this.formatMessage("fieldColumnsVersionName"),show:!0,sort:"desc",order:0,available:!0},{field:"versionOwner",alias:this.formatMessage("fieldColumnsVersionOwner"),show:!0,sort:"desc",order:1,available:!0}],this.allowance=[{label:this.formatMessage("allowancesSwitch"),key:"Switch",enabled:!0},{label:this.formatMessage("allowancesCreateNew"),key:"CreateNew",enabled:!0},{label:this.formatMessage("allowancesDeleteExisting"),key:"DeleteExisting",enabled:!1},{label:this.formatMessage("allowancesUpdateName"),key:"UpdateName",enabled:!0},{label:this.formatMessage("allowancesUpdateDescription"),key:"UpdateDescription",enabled:!0},{label:this.formatMessage("allowancesChangeOwner"),key:"ChangeOwner",enabled:!1},{label:this.formatMessage("allowancesChangePrivileges"),key:"ChangePrivileges",enabled:!1},{label:this.formatMessage("allowancesAutoRefreshList"),key:"AutoRefreshList",enabled:!0,refreshInterval:1}],this._updateServicesToConfig=e=>{const t=Object(i.Immutable)(this.state.configObject),s=i.Immutable.asMutable(t,{deep:!0});s.services=i.Immutable.asMutable(Object(i.Immutable)(this.state.vmsServices),{deep:!0}),this.setState({configObject:s},()=>{e?this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",s),useDataSources:e}):this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",s)})})},this.updateConfigItem=(e,t)=>{const s=Object(i.Immutable)(this.state.vmsServices),a=i.Immutable.asMutable(s,{deep:!0});a.map(s=>{s.name===this.state.selectedService.name&&(s.configuredSettings[t]=e.hasOwnProperty("currentTarget")?e.currentTarget.value:e)}),this.setState({vmsServices:a},()=>{this._updateServicesToConfig()})},this.updateGeneralItem=(e,t)=>{const s=Object.assign({},this.state.configObject);s[t]=e,"expandMode"===t?this.setState({configObject:s,expandMode:e},()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",s)})}):this.setState({configObject:s},()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",s)})})},this.updateArrangementItem=e=>{const t=Object.assign({},this.state.configObject);t.arrangement=e,this.setState({configObject:t,arrangementStyle:e},()=>{this.props.onSettingChange({id:this.props.id,config:this.props.config.set("versionConfig",t)})})},this.onToggleUseDataEnabled=e=>{this.props.onSettingChange({id:this.props.id,useDataSourcesEnabled:e})},this._checkDSInfo=e=>{const t=i.DataSourceManager.getInstance().getDataSources();for(const e in t)t[e].type},this.arrangementHandler=e=>{this.updateArrangementItem(e)},this.renderFieldOrderList=()=>{const e=[];let t=[];if(Object.keys(this.state.selectedService).length>0){const s=Object(i.Immutable)(this.state.vmsServices),a=i.Immutable.asMutable(s,{deep:!0});if(""!==this.state.selectedService){const e=a.filter(e=>e.name===this.state.selectedService.name);e.length>0&&(t=e[0].configuredSettings.displayInfo)}t.sort(this._compare("order","desc")),t.map(e=>{for(const t in n)t.toLowerCase()===("fieldColumns"+e.field).toLowerCase()&&(e.alias=this.formatMessage(t))}),t.map((s,a)=>{s.available&&e.push(i.React.createElement("tr",{key:s.field},i.React.createElement("td",{style:{fontSize:"smaller"}},s.alias),i.React.createElement("td",null,i.React.createElement("div",{style:{display:"flex",flexDirection:"row"}},a>0?i.React.createElement(r.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeFieldOrder("up",a)}},i.React.createElement(r.Icon,{icon:p,size:"12",color:"#fff"})):i.React.createElement(r.Button,{icon:!0,type:"tertiary",size:"sm"}),a<t.length-1?i.React.createElement(r.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeFieldOrder("down",a)}},i.React.createElement(r.Icon,{icon:I,size:"12",color:"#fff"})):i.React.createElement(r.Button,{icon:!0,type:"tertiary",size:"sm"})))))})}return i.React.createElement(r.Table,{style:{height:"100%"}},i.React.createElement("thead",null,i.React.createElement("tr",null,i.React.createElement("th",{style:{fontSize:"smaller"}},this.formatMessage("field")),i.React.createElement("th",{style:{fontSize:"smaller"}}))),i.React.createElement("tbody",null,e))},this.renderConfigSlideout=()=>{var e;const{theme:t}=this.props;let s=!0;return s=this._checkAllowAllState(),i.React.createElement(o.SidePopper,{isOpen:this.state.showSidePanel,position:"right",toggle:()=>{this.setState({showSidePanel:!this.state.showSidePanel})},trigger:null===(e=this.sidePopperTrigger)||void 0===e?void 0:e.current},i.React.createElement("div",{style:{height:"100%",overflow:"auto"}},i.React.createElement("div",{style:{textAlign:"right",width:"100%"}},i.React.createElement(r.Button,{size:"sm",icon:!0,type:"tertiary",className:"ml-2",onClick:()=>{this.setState({showSidePanel:!1})}},i.React.createElement(r.Icon,{icon:f,size:"16"}))),this.state.selectedService.hasOwnProperty("name")&&this.renderVersionSelector(),"simple"!==this.state.arrangementStyle?this.state.selectedService.hasOwnProperty("name")&&this.renderVersionInformation():"","simple"!==this.state.arrangementStyle?this.state.selectedService.hasOwnProperty("name")&&i.React.createElement(o.SettingSection,{className:"map-selector-section",title:i.React.createElement(i.React.Fragment,null,i.React.createElement("div",{style:{display:"flex",flexDirection:"row"}},i.React.createElement("div",{style:{display:"flex",flex:1}},this.formatMessage("settingsSectionsVersionCapability")),i.React.createElement(r.Tooltip,{title:this.formatMessage("settingsSectionsVersionCapabilityTooltip"),placement:"bottom"},i.React.createElement("div",null,i.React.createElement(r.Icon,{icon:S,size:"16",color:t.colors.palette.dark[100]})))))},i.React.createElement(o.SettingRow,null,i.React.createElement("div",{style:{display:"flex",flexDirection:"column",flex:1}},i.React.createElement("div",{style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1}},i.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:4,justifyContent:"flex-end"}}),i.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end"}},this.formatMessage("settingsSectionsAllowCapability"))),i.React.createElement("div",{style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1}},i.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:4,justifyContent:"flex-end",paddingLeft:5,paddingRight:5,paddingBottom:5}},this.formatMessage("settingsSectionsAllowAll")),i.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end",borderBottom:"1px solid #ccc",paddingBottom:5}},i.React.createElement(r.Switch,{checked:s,onChange:e=>{this.updateAllowanceAction(null,e.currentTarget.checked,!0)}}))),this.renderAllowances()))):""))},this._checkAllowAllState=()=>{let e=!0;const t=Object(i.Immutable)(this.state.vmsServices);if(""!==this.state.selectedService){const s=t.filter(e=>e.name===this.state.selectedService.name);if(s.length>0){e=!s[0].configuredSettings.allowance.some(e=>!1===e.enabled)}}return e},this.renderAllowances=()=>{const e=[];let t=[];const s=Object(i.Immutable)(this.state.vmsServices),a=i.Immutable.asMutable(s,{deep:!0});if(""!==this.state.selectedService){const e=a.filter(e=>e.name===this.state.selectedService.name);e.length>0&&(t=e[0].configuredSettings.allowance)}return t.map(e=>{for(const t in n)t.toLowerCase()===("allowances"+e.key).toLowerCase()&&(e.label=this.formatMessage(t))}),t.map(t=>{e.push(i.React.createElement("div",{key:t.label,style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1}},i.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:4}},t.label),i.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,justifyContent:"flex-end"}},i.React.createElement(r.Switch,{checked:t.enabled,onChange:e=>{this.updateAllowanceAction(t.key,e.currentTarget.checked,!1)}})))),"AutoRefreshList"===t.key&&t.enabled&&e.push(i.React.createElement("div",{key:"refreshInterval",style:{paddingBottom:"5px",display:"flex",flexDirection:"row",flex:1}},i.React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:4}}),i.React.createElement("div",{style:{textAlign:"right"}},i.React.createElement(r.Tooltip,{title:this.formatMessage("settingsSectionsTooltipNumber"),placement:"bottom"},i.React.createElement(r.TextInput,{size:"sm",style:{width:40},type:"text",placeholder:"000",value:this.state.intervalNumber,checkValidityOnChange:e=>{const s=+e;let i=!0;if(e.length<=3)isNaN(s)?(this.setState({invalidInterval:!0}),i=!1):s<=0?(this.setState({invalidInterval:!0,intervalNumber:s}),i=!1):e.indexOf(".")>-1?this.setState({intervalNumber:+e.replace(".","")}):this.setState({invalidInterval:!1,intervalNumber:s},()=>{this.updateAllowanceInterval(t.key,s)});else if(isNaN(s))this.setState({invalidInterval:!0}),i=!1;else{let e=s;"number"!=typeof s&&(e=parseInt(s.substring(0,3))),this.setState({intervalNumber:e})}return{valid:i}}})),i.React.createElement("br",null),this.formatMessage("settingsSectionsMinutes"))))}),e},this.updateAllowanceInterval=(e,t)=>{if(""!==this.state.selectedService){let s=[];const a=Object(i.Immutable)(this.state.vmsServices),n=i.Immutable.asMutable(a,{deep:!0});n.map(i=>{i.name===this.state.selectedService.name&&(s=i.configuredSettings.allowance,s.map(s=>{s.key===e&&(s.refreshInterval=t)}))}),this.setState({vmsServices:n},()=>{this._updateServicesToConfig()})}},this.updateAllowanceAction=(e,t,s)=>{if(""!==this.state.selectedService){let a=[];const n=Object(i.Immutable)(this.state.vmsServices),r=i.Immutable.asMutable(n,{deep:!0});r.map(i=>{i.name===this.state.selectedService.name&&(a=i.configuredSettings.allowance,a.map(i=>{(s||i.key===e)&&(i.enabled=t)}))}),this.setState({vmsServices:r},()=>{this._updateServicesToConfig()})}},this.renderServiceSelector=()=>{const{theme:e}=this.props,t=[];return this.state.vmsServices.length>0&&this.state.vmsServices.map((e,s)=>{const a=i.React.createElement("tr",{key:e.name,style:{borderLeft:e.name===this.state.selectedService.name?"solid #00aabb":""}},this.state.vmsServices.length>1&&i.React.createElement("td",null,s>0?i.React.createElement(r.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeServiceOrder("up",s)}},i.React.createElement(r.Icon,{icon:p,size:"12",color:"#fff"})):"",s<this.state.vmsServices.length-1?i.React.createElement(r.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{this.changeServiceOrder("down",s)}},i.React.createElement(r.Icon,{icon:I,size:"12",color:"#fff"})):""),i.React.createElement("td",{role:"button",style:{fontSize:"smaller",width:"100%"},onClick:()=>{this.serviceSelectorAction(e)}},e.name),i.React.createElement("td",{role:"button",style:{fontSize:"smaller"},onClick:()=>{this.serviceRemoveAction(e)}},i.React.createElement(r.Icon,{icon:f,size:"12"})));t.push(a)}),i.React.createElement(o.SettingSection,{className:"map-selector-section",title:i.React.createElement(i.React.Fragment,null,i.React.createElement("div",{style:{display:"flex",flexDirection:"row"}},i.React.createElement("div",{style:{width:"100%",paddingRight:20,overflow:"hidden",textOverflow:"ellipsis"}},this.formatMessage("settingsSectionsVersionService")),i.React.createElement(r.Tooltip,{title:this.formatMessage("settingsSectionsVersionServiceHelp"),placement:"bottom"},i.React.createElement("div",{onClick:()=>{window.open("https://pro.arcgis.com/en/pro-app/latest/help/data/geodatabases/overview/register-a-dataset-as-branch-versioned.htm","_blank")},style:{cursor:"pointer"}},i.React.createElement(r.Icon,{icon:M,size:"16",color:e.colors.palette.dark[100]})))))},i.React.createElement(o.SettingRow,null,i.React.createElement(l.DataSourceSelector,{types:Object(i.Immutable)([l.AllDataSourceTypes.FeatureService,l.AllDataSourceTypes.MapService]),mustUseDataSource:!0,isMultiple:!0,useDataSourcesEnabled:this.props.useDataSourcesEnabled,onToggleUseDataEnabled:this.onToggleUseDataEnabled,onChange:this.validateVMSExist,widgetId:this.props.id,closeDataSourceListOnChange:!0})),i.React.createElement(o.SettingRow,null,i.React.createElement(r.Alert,{form:"basic",type:"warning",open:this.state.showAlert,closable:!0,text:this.state.alertMessage,onClose:()=>{this.setState({showAlert:!this.state.showAlert})}})),i.React.createElement(o.SettingRow,null,i.React.createElement("div",{className:"w-100"},i.React.createElement("div",{className:"component-map-selector",style:{maxHeight:300,overflow:"auto"},ref:this.sidePopperTrigger},i.React.createElement(r.Table,{size:"sm",hover:!0,style:{fontSize:"medium"}},i.React.createElement("tbody",null,t))))))},this.validateVMSExist=e=>h(this,void 0,void 0,(function*(){const t=i.DataSourceManager.getInstance().getDataSources();let s=!1,a=!1;for(const n in t)if(n===e[0].dataSourceId){const r=t[n].getDataSourceJson();let o=r.url;if(r.url.indexOf("FeatureServer")>=0&&(o=r.url.substring(0,r.url.indexOf("FeatureServer"))),r.url.indexOf("MapServer")>=0&&(o=r.url.substring(0,r.url.indexOf("MapServer"))),this.state.vmsServices.length>0){this.state.vmsServices.filter(e=>e.name===t[n].getLabel()||e.url===o).length>0&&(a=!0)}if(!1===a){const a=this.getServiceToken(o);let r=!1;if(r=null!==a?yield this.vms.checkValidVMS(o,a):yield this.vms.checkValidVMS(o),r){s=!0;const a={},r=Object(i.Immutable)(this.state.vmsServices),l=i.Immutable.asMutable(r,{deep:!0});a.name=t[n].getLabel(),a.url=o,a.datasource=n,a.configuredSettings={startupVersion:this.defaultVersion,startOnLoad:!1,allowance:i.Immutable.asMutable(Object(i.Immutable)(this.allowance),{deep:!0}),displayInfo:i.Immutable.asMutable(Object(i.Immutable)(this.fieldColumns),{deep:!0})},l.push(a),this.setState({vmsServices:l,showAlert:!1,alertMessage:"",selectedService:a,showSidePanel:!0},()=>{this._updateServicesToConfig(e),this.pullVersions(this.state.selectedService)})}}}a?this.setState({showAlert:!0,alertMessage:this.formatMessage("alertMessagesAlreadyAdded")}):!1===s&&this.setState({showAlert:!0,alertMessage:this.formatMessage("alertMessagesNotValid")})})),this.serviceSelectorAction=e=>{if(""!==e){const t=this.state.vmsServices.filter(t=>t.name===e.name);t.length>0&&this.setState({selectedService:t[0],showSidePanel:!0,intervalNumber:t[0].configuredSettings.allowance[7].refreshInterval,searchVersionText:"",showAlert:!1},()=>{this.pullVersions(this.state.selectedService)})}else this.setState({selectedService:"",showSidePanel:!1,intervalNumber:1,invalidInterval:!1,searchVersionText:""})},this.serviceRemoveAction=e=>{if(e){let t=-1,s=!1;const a=Object(i.Immutable)(this.state.vmsServices),n=i.Immutable.asMutable(a,{deep:!0});n.map((i,a)=>{i.name===e.name&&(t=a,""!==this.state.selectedService&&i.name===this.state.selectedService.name&&(s=!0))}),-1!==t&&(n.splice(t,1),s?this.setState({vmsServices:n,selectedService:"",showSidePanel:!1,searchVersionText:""},()=>{this._updateServicesToConfig()}):this.setState({vmsServices:n},()=>{this._updateServicesToConfig()}))}},this.renderVersionSelector=()=>{let e=this.defaultVersion,t=null;const s=[];let a=!1;const n=this.state.vmsServices.filter(e=>{if(""!==this.state.selectedService&&e.name===this.state.selectedService.name)return e});return n.length>0&&(e=n[0].configuredSettings.startupVersion),""!==this.state.searchVersionText&&this.state.filteredVersionList.length>0&&(e=this.state.filteredVersionList[0].versionGuid),this.state.filteredVersionList.map(n=>{n.versionName===this.defaultVersion&&(t=n.versionGuid),e===n.versionGuid&&(a=!0),this.state.searchVersionText===n.versionName&&(a=!0,e=n.versionGuid),s.push(i.React.createElement("option",{key:n.versionGuid,value:n.versionGuid},n.versionName))}),!1===a&&(e=null!==t?t:this.defaultVersion),i.React.createElement(o.SettingSection,{className:"map-selector-section",title:this.formatMessage("settingsSectionsSelectVersion")},i.React.createElement(o.SettingRow,null,i.React.createElement(r.TextInput,{type:"text",onChange:this.searchVersions,value:this.state.searchVersionText,placeholder:this.formatMessage("settingsSectionsSearchName"),style:{width:"100%"}})),i.React.createElement(o.SettingRow,null,i.React.createElement(r.Select,{onChange:e=>{this.updateVersionSelected(e.currentTarget)},defaultValue:e,value:e},s)))},this.updateVersionSelected=e=>{const t=Object(i.Immutable)(this.state.vmsServices),s=i.Immutable.asMutable(t,{deep:!0});s.map((t,s)=>{""!==this.state.selectedService&&t.name===this.state.selectedService.name&&(t.configuredSettings.startupVersion=e.value)}),""!==this.state.searchVersionText?this.setState({vmsServices:s,searchVersionText:e.textContent},()=>{this._updateServicesToConfig()}):this.setState({vmsServices:s},()=>{this._updateServicesToConfig()})},this.renderGeneralSection=()=>{let e=10;const t=Object.assign({},this.state.configObject);t.hasOwnProperty("pageCounter")&&(e=t.pageCounter);const s=[i.React.createElement("option",{key:"5",value:5},"5"),i.React.createElement("option",{key:"10",value:10},"10"),i.React.createElement("option",{key:"25",value:25},"25"),i.React.createElement("option",{key:"50",value:50},"50")];return i.React.createElement(i.React.Fragment,null,i.React.createElement(o.SettingSection,{className:"map-selector-section",title:this.formatMessage("settingsSectionsGeneralSettings")},i.React.createElement(o.SettingRow,null,this.formatMessage("settingsSectionsRecordsPage")),i.React.createElement(o.SettingRow,null,i.React.createElement(r.Select,{onChange:e=>{this.updateGeneralItem(e.currentTarget.value,"pageCounter")},defaultValue:e},s))),i.React.createElement(o.SettingSection,{className:"map-selector-section",title:""},i.React.createElement(o.SettingRow,null,this.formatMessage("settingsSectionsExpandBasic")),i.React.createElement(o.SettingRow,null,i.React.createElement(r.Switch,{checked:this.state.expandMode,onChange:e=>{this.updateGeneralItem(e.currentTarget.checked,"expandMode")}}))))},this.pullVersions=e=>{let t=e.url;e.url.indexOf("FeatureServer")>=0&&(t=e.url.substring(0,e.url.indexOf("FeatureServer"))),e.url.indexOf("MapServer")>=0&&(t=e.url.substring(0,e.url.indexOf("MapServer")));let s=this.getServiceToken(t);null===s&&(s=void 0),this.vms.getVersions(e.name,t,s).then(e=>{e.hasOwnProperty("success")?e.success&&e.hasOwnProperty("versions")&&this.setState({filteredVersionList:e.versions,allVersionList:e.versions}):e.hasOwnProperty("error")&&this.setState({filteredVersionList:[],allVersionList:[]})})},this.searchVersions=e=>{const t=[...this.state.allVersionList].filter(t=>t.versionName.toLowerCase().indexOf(e.currentTarget.value.toLowerCase())>=0);this.setState({filteredVersionList:t,searchVersionText:e.currentTarget.value},()=>{this.state.filteredVersionList.length>0&&this.updateConfigItem(this.state.filteredVersionList[0].versionGuid,"startupVersion")})},this.renderVersionInformation=()=>{const{theme:e}=this.props,t=[];let s=[];const a=Object(i.Immutable)(this.state.vmsServices),l=i.Immutable.asMutable(a,{deep:!0});if(""!==this.state.selectedService){const e=l.filter(e=>e.name===this.state.selectedService.name);if(e.length>0&&(s=e[0].configuredSettings.displayInfo),s.length>0){const e=(()=>{let e=!1;return s.filter(e=>!0===e.show).length<=1&&(e=!0),e})();s.sort(this._compare("order","desc")),s.map(e=>{for(const t in n)t.toLowerCase()===("fieldColumns"+e.field).toLowerCase()&&(e.alias=this.formatMessage(t))}),s.map(s=>{t.push(i.React.createElement("tr",{key:s.field},i.React.createElement("td",{style:{fontSize:12,textAlign:"left"}},s.alias),i.React.createElement("td",null,i.React.createElement(r.Checkbox,{className:"mr-2 font-13",checked:s.available,onChange:e=>{this.changeFieldVisiblity(e.currentTarget.value,"available",e.currentTarget.checked)},value:s.field})),i.React.createElement("td",null,i.React.createElement(r.Checkbox,{className:"mr-2 font-13",checked:s.show,disabled:!!s.show&&e,onChange:e=>{this.changeFieldVisiblity(e.currentTarget.value,"show",e.currentTarget.checked)},value:s.field}))))})}}return i.React.createElement(o.SettingSection,{className:"map-selector-section",title:i.React.createElement(i.React.Fragment,null,i.React.createElement("div",{style:{display:"flex",flexDirection:"row"}},i.React.createElement("div",{style:{display:"flex",flex:1}},this.formatMessage("settingsSectionsVersionInfo")),i.React.createElement(r.Tooltip,{title:this.formatMessage("settingsSectionsVersionInfoTooltip"),placement:"bottom"},i.React.createElement("div",null,i.React.createElement(r.Icon,{icon:S,size:"16",color:e.colors.palette.dark[100]})))))},i.React.createElement(o.SettingRow,null,i.React.createElement("div",{className:"w-100"},i.React.createElement("div",{className:"component-map-selector",style:{maxHeight:250,overflow:"auto"}},i.React.createElement(r.Table,{size:"sm",hover:!0,width:"90%",style:{textAlign:"center"}},i.React.createElement("thead",null,i.React.createElement("tr",null,i.React.createElement("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:"smaller",whiteSpace:"nowrap",alignItems:"top",zIndex:9999}},i.React.createElement(r.Button,{type:"tertiary",onClick:e=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},id:"btnFieldMgmt"},i.React.createElement(r.Icon,{icon:v,size:"14",color:"#fff"}))),i.React.createElement("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:13,whiteSpace:"nowrap",alignItems:"center",zIndex:9999}},this.formatMessage("fieldColumnsColumnAvailable")),i.React.createElement("th",{style:{position:"sticky",top:0,backgroundColor:"#000",border:"#000",fontSize:13,whiteSpace:"nowrap",alignItems:"center",zIndex:9999}},this.formatMessage("fieldColumnsColumnShow")))),i.React.createElement("tbody",null,t))))),i.React.createElement(r.Popper,{open:this.state.showFieldMgmt,floating:!0,reference:"btnFieldMgmt",placement:"left",showArrow:!1,onHeaderClose:()=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},toggle:()=>{this.toggleDialogAction("fieldMgmt","showFieldMgmt")},defaultSize:{width:250,height:600}},i.React.createElement("div",{style:{width:250,height:"100%",overflow:"auto"}},this.renderFieldOrderList())))},this.changeFieldOrder=(e,t)=>{if(""!==this.state.selectedService){let s=[];const a=Object(i.Immutable)(this.state.vmsServices),n=i.Immutable.asMutable(a,{deep:!0});n.map(i=>{if(i.name===this.state.selectedService.name){s=i.configuredSettings.displayInfo,s.sort(this._compare("order","desc"));let a=t;"up"===e?(a-=1,s[t].order=a,s[t-1].order=t):(a+=1,s[t].order=a,s[t+1].order=t)}}),this.setState({vmsServices:n},()=>{this._updateServicesToConfig()})}},this.changeServiceOrder=(e,t)=>{const s=Object(i.Immutable)(this.state.vmsServices),a=i.Immutable.asMutable(s,{deep:!0}),n=a.splice(t,1)[0];"up"===e?a.splice(t-1,0,n):a.splice(t+1,0,n),this.setState({vmsServices:a},()=>{this._updateServicesToConfig()})},this.changeFieldVisiblity=(e,t,s)=>{if(""!==this.state.selectedService){let a=[];const n=Object(i.Immutable)(this.state.vmsServices),r=i.Immutable.asMutable(n,{deep:!0});r.map(i=>{i.name===this.state.selectedService.name&&(a=i.configuredSettings.displayInfo,a.map(i=>{i.field===e&&(i[t]=s)}))}),this.setState({vmsServices:r},()=>{this._updateServicesToConfig()})}},this._compare=(e,t)=>function(s,i){let a=0;return"desc"===t?s[e]>i[e]?a=1:s[e]<i[e]&&(a=-1):s[e]<i[e]?a=1:s[e]>i[e]&&(a=-1),a},this.updateVMSInfo=(e,t)=>new Promise((s,i)=>{const a=Object.assign({},this.state.selectedService);"configured"===e?a[e]=t:a.configuredSettings[e]=t,this.setState({selectedService:a},()=>{const e=[...this.state.vmsServices];e.map(e=>{e.name===this.state.selectedService.name&&(e=this.state.selectedService)}),this.setState({vmsServices:e},()=>{s(!0)})})}),this.getServiceToken=e=>{const t=i.urlUtils.getUrlHost(e.toLowerCase()),s=i.SessionManager.getInstance().getSessions().filter(e=>e.portal.toLowerCase().indexOf(t)>-1);let a=null;return this.props.portalUrl.toLowerCase().indexOf(t)>-1&&(a=this.props.token),s.length>0&&(a=s[0].token),a},this.toggleDialogAction=(e,t)=>{this.setState({showFieldMgmt:!this.state.showFieldMgmt})},this.getStyle=e=>i.css`
      .simple-view-header{
        background: ${e.colors.secondary};
      }

    `,this.state={allVersionList:[],filteredVersionList:[],selectedVersion:{},selectedService:{},selectedWebMap:"",vmsServices:this.props.config.versionConfig&&this.props.config.versionConfig.hasOwnProperty("services")?this.props.config.versionConfig.services:[],showServiceSelector:!1,showSidePanel:!1,showWebMapSelector:!1,showFieldMgmt:!1,showAlert:!1,alertMessage:this.formatMessage("alertMessagesErrorAlert"),searchVersionText:"",intervalNumber:1,invalidInterval:!1,expandMode:!this.props.config.versionConfig||(!this.props.config.versionConfig.hasOwnProperty("expandMode")||this.props.config.versionConfig.expandMode),arrangementStyle:this.props.config.versionConfig&&this.props.config.versionConfig.hasOwnProperty("arrangement")?this.props.config.versionConfig.arrangement:"simple",configObject:i.Immutable.asMutable(Object(i.Immutable)(this.props.config.versionConfig),{deep:!0})}}componentDidMount(){}render(){return i.React.createElement("div",{className:"widget-setting-demo"},i.React.createElement(o.SettingSection,{className:"map-selector-section",title:this.formatMessage("layoutStyleTitle")},i.React.createElement(o.SettingRow,null,i.React.createElement(r.Tooltip,{title:this.formatMessage("layoutStyleBasic"),placement:"bottom"},i.React.createElement("div",null,i.React.createElement(r.Button,{onClick:()=>{this.arrangementHandler("simple")},icon:!0,size:"sm",type:"tertiary",active:"simple"===this.state.arrangementStyle,style:{border:"simple"===this.state.arrangementStyle?"solid #00aabb":""}},i.React.createElement(r.Icon,{width:100,height:100,icon:s(240)})),i.React.createElement("div",{style:{display:"flex",justifyContent:"center"}},this.formatMessage("layoutStyleBasic")))),i.React.createElement(r.Tooltip,{title:this.formatMessage("layoutStyleAdvanced"),placement:"bottom"},i.React.createElement("div",null,i.React.createElement(r.Button,{onClick:()=>{this.arrangementHandler("management")},icon:!0,size:"sm",type:"tertiary",active:"management"===this.state.arrangementStyle,style:{border:"management"===this.state.arrangementStyle?"solid #00aabb":""}},i.React.createElement(r.Icon,{width:100,height:100,icon:s(241)})),i.React.createElement("div",{style:{display:"flex",justifyContent:"center"}},this.formatMessage("layoutStyleAdvanced")))))),this.renderServiceSelector(),this.renderGeneralSection(),this.state.showSidePanel&&this.renderConfigSlideout())}}},66:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19.637 15.866L30.951 27.18a2.667 2.667 0 01-3.771 3.771L15.866 19.637 4.552 30.951A2.667 2.667 0 01.781 27.18l11.314-11.314L.781 4.552A2.667 2.667 0 014.552.781l11.314 11.314L27.18.781a2.667 2.667 0 013.771 3.771L19.637 15.866z"></path></svg>'}}))}}}));